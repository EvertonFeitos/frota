"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7657],{7657:(S,P,e)=>{e.r(P),e.d(P,{PeoplePage:()=>L});var f=e(467);const m=(0,e(5083).F3)("Toast",{web:()=>e.e(2771).then(e.bind(e,2771)).then(i=>new i.ToastWeb)});var a=e(4742),n=e(4438);let C=(()=>{var i;class h{transform(o,t){return o?t?o.filter(r=>r.name.toLowerCase().includes(t.toLowerCase())).sort((r,c)=>r.name>c.name?1:-1):o.sort((r,c)=>r.name>c.name?1:-1):[]}}return(i=h).\u0275fac=function(o){return new(o||i)},i.\u0275pipe=n.EJ8({name:"peopleFilter",type:i,pure:!0,standalone:!0}),h})();var p=e(177),l=e(4341),v=e(2902),O=e(5784),d=e(5079),u=e(5873),E=e(132),g=e(4412),F=e(4572),b=e(6354),T=e(4843),$=e(2705),j=e(9769);let A=(()=>{var i;class h{constructor(o,t){this.funcionarioService=o,this.identificacaoFuncionarioService=t,this.pessoas=new g.t(null),this.identificacoes=new g.t(null),this.loading=new g.t(!1),this.identificacoes$=this.identificacoes.asObservable(),this.pessoas$=this.pessoas.asObservable(),this.loading$=this.loading.asObservable(),this.data$=(0,F.z)([this.identificacoes$,this.pessoas$]).pipe((0,b.T)(([r,c])=>c&&r?c.reduce((y,I)=>{const G=r.filter(x=>{var D;return(null==x||null===(D=x.funcionario)||void 0===D?void 0:D.id)===(null==I?void 0:I.id)});return y.push({...I,ids:G}),y},[]):[]))}loadData(o=!1){var t=this;return(0,f.A)(function*(){const r=t.pessoas.value;if(!(!o&&r&&r.length>0)){t.loading.next(!0);try{yield t.loadPessoas(),yield t.loadIds(),t.loading.next(!1)}catch{m.show({text:"Erro carregando informa\xe7\xf5es.",duration:"long",position:"bottom"}),t.loading.next(!1)}}})()}loadPessoas(){var o=this;return(0,f.A)(function*(){const t=yield(0,T._)(o.funcionarioService.getAll());o.pessoas.next(t)})()}loadIds(){var o=this;return(0,f.A)(function*(){const t=yield(0,T._)(o.identificacaoFuncionarioService.getAll());o.identificacoes.next(t)})()}}return(i=h).\u0275fac=function(o){return new(o||i)(n.KVO($.r),n.KVO(j._))},i.\u0275prov=n.jDH({token:i,factory:i.\u0275fac,providedIn:"root"}),h})();const R=()=>[];function B(i,h){1&i&&(n.j41(0,"div",13),n.nrm(1,"ion-spinner",14),n.k0s()),2&i&&(n.R7$(),n.Y8G("name","crescent"))}function U(i,h){if(1&i){const s=n.RV6();n.j41(0,"ion-item",15),n.bIt("click",function(){const t=n.eBV(s).$implicit,r=n.XpG();return n.Njj(r.addPhoto(t))}),n.j41(1,"ion-label")(2,"h2"),n.EFF(3),n.k0s(),n.j41(4,"p")(5,"strong"),n.EFF(6,"Nascido em:"),n.k0s(),n.EFF(7),n.nI1(8,"date"),n.k0s()(),n.j41(9,"ion-note",5),n.EFF(10,"IDs:"),n.k0s(),n.j41(11,"ion-badge",16),n.EFF(12),n.k0s()()}if(2&i){const s=h.$implicit;n.R7$(3),n.JRh(null==s?null:s.name),n.R7$(4),n.SpI(" ",n.i5U(8,4,null==s?null:s.nascimento,"dd/MM/yyyy"),""),n.R7$(4),n.Y8G("color",s.ids.length>0?"success":"danger"),n.R7$(),n.SpI(" ",s.ids.length," ")}}let L=(()=>{var i;class h{constructor(o,t,r){this.fotos=o,this.alertCtrl=t,this.people=r,this.appRoutes=O.S,this.ids={},this.loading=!0,(0,d.a)({refreshOutline:u.mVv,arrowBack:u.$$C}),this.data$=this.people.data$,this.loading$=this.people.loading$}ngOnInit(){this.people.loadData()}loadData(){var o=this;return(0,f.A)(function*(){o.people.loadData(!0)})()}addPhoto(o){var t=this;return(0,f.A)(function*(){var c;yield(yield t.alertCtrl.create({header:"Atualizar foto",message:`Voc\xea vai atualizar a foto de ${o.name}.`,buttons:["Cancelar",{text:"Bater foto",handler:(c=(0,f.A)(function*(){(yield t.fotos.takePhoto(o))?(t.loadData(),m.show({text:"Foto cadastrada!",duration:"long",position:"bottom"})):m.show({text:"Erro cadastrando foto.",duration:"long",position:"bottom"})}),function(){return c.apply(this,arguments)})}]})).present()})()}trackById(o,t){return null==t?void 0:t.id}}return(i=h).\u0275fac=function(o){return new(o||i)(n.rXU(E.r),n.rXU(a.hG),n.rXU(A))},i.\u0275cmp=n.VBU({type:i,selectors:[["app-people"]],standalone:!0,features:[n.aNF],decls:19,vars:15,consts:[[3,"translucent"],["color","primary"],["slot","start"],[3,"routerLink"],["slot","icon-only","name","arrow-back","color","light"],["slot","end"],["class","ion-text-center ",4,"ngIf"],[3,"click"],["slot","icon-only","name","refresh-outline"],[3,"ngModelChange","ngModel","placeholder"],["id","cameraPreview"],["lines","full"],["button","",3,"click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"ion-text-center"],[3,"name"],["button","",3,"click"],["slot","end",3,"color"]],template:function(o,t){if(1&o&&(n.j41(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-buttons",2)(3,"ion-button",3),n.nrm(4,"ion-icon",4),n.k0s()(),n.j41(5,"ion-title"),n.EFF(6,"Cadastrar leitura facial"),n.k0s(),n.j41(7,"ion-buttons",5),n.DNE(8,B,2,1,"div",6),n.nI1(9,"async"),n.j41(10,"ion-button",7),n.bIt("click",function(){return t.loadData()}),n.nrm(11,"ion-icon",8),n.k0s()()()(),n.j41(12,"ion-content")(13,"ion-searchbar",9),n.mxI("ngModelChange",function(c){return n.DH7(t.searchTerm,c)||(t.searchTerm=c),c}),n.k0s(),n.nrm(14,"div",10),n.j41(15,"ion-list",11),n.DNE(16,U,13,7,"ion-item",12),n.nI1(17,"async"),n.nI1(18,"peopleFilter"),n.k0s()()),2&o){let r;n.Y8G("translucent",!0),n.R7$(3),n.FS9("routerLink",t.appRoutes.home.path),n.R7$(5),n.Y8G("ngIf",n.bMT(9,7,t.loading$)),n.R7$(5),n.R50("ngModel",t.searchTerm),n.Y8G("placeholder","Digite o nome"),n.R7$(3),n.Y8G("ngForOf",n.i5U(18,11,null!==(r=n.bMT(17,9,t.data$))&&void 0!==r?r:n.lJ4(14,R),t.searchTerm))("ngForTrackBy",t.trackById)}},dependencies:[a.bv,a.In,a.Jm,a.QW,a.W9,a.eU,a.iq,a.uz,a.he,a.nf,a.JI,a.S1,a.w2,a.BC,a.ai,a.Gw,a.N7,p.MD,p.Sq,p.bT,p.Jj,p.vh,l.YN,l.BC,l.vS,v.iI,v.Wk,C],styles:["[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]{--background: var(--ion-color-light)}[_nghost-%COMP%]   ion-list[_ngcontent-%COMP%]{margin:20px auto;padding:0;max-width:800px}[_nghost-%COMP%]   ion-badge[_ngcontent-%COMP%]{padding:10px;font-size:22px;border-radius:30px}@media (min-width: 800px){[_nghost-%COMP%]   ion-item[_ngcontent-%COMP%]{min-height:60px}[_nghost-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:28px;line-height:60px}[_nghost-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-note[_ngcontent-%COMP%]{font-size:18px;line-height:60px}[_nghost-%COMP%]   ion-searchbar[_ngcontent-%COMP%]{margin:20px auto;max-width:800px}}"]}),h})()},2705:(S,P,e)=>{e.d(P,{r:()=>p});var f=e(4412),M=e(7673),m=e(1985),a=e(8141),n=e(4438),C=e(9684);let p=(()=>{var l;class v{constructor(d){this.baseApiService=d,this.endpoint="api/Funcionario",this.funcionariosSubject=new f.t(null),this.funcionarios$=this.funcionariosSubject.asObservable()}getAll(){const d=this.getCachedFuncionarios();return d?(0,M.of)(d):this.baseApiService.get(`${this.endpoint}/GetAll`).pipe((0,a.M)(u=>{this.funcionariosSubject.next(u)}))}getCachedFuncionarios(){return this.funcionariosSubject.value}clearCache(){this.funcionariosSubject.next(null)}getById(d){return new m.c(u=>{const E=this.getCachedFuncionarios();if(E){const g=E.find(F=>F.id===d);if(g)return u.next(g),void u.complete()}this.getAll().subscribe({next:g=>{const F=g.find(b=>b.id===d);F?u.next(F):u.error(new Error(`Funcion\xe1rio com ID ${d} n\xe3o encontrado.`)),u.complete()},error:g=>{u.error(g)}})})}}return(l=v).\u0275fac=function(d){return new(d||l)(n.KVO(C.v))},l.\u0275prov=n.jDH({token:l,factory:l.\u0275fac,providedIn:"root"}),v})()},4843:(S,P,e)=>{e.d(P,{_:()=>m});var f=e(9350),M=e(7707);function m(a,n){const C="object"==typeof n;return new Promise((p,l)=>{const v=new M.Ms({next:O=>{p(O),v.unsubscribe()},error:l,complete:()=>{C?p(n.defaultValue):l(new f.G)}});a.subscribe(v)})}}}]);