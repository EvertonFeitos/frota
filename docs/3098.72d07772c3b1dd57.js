"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3098],{5083:(Et,et,C)=>{C.d(et,{E_:()=>Q,F3:()=>$,I9:()=>G});var d=C(467);typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"&&global;var j=function(m){return m.Unimplemented="UNIMPLEMENTED",m.Unavailable="UNAVAILABLE",m}(j||{});class G extends Error{constructor(c,u,_){super(c),this.message=c,this.code=u,this.data=_}}const gt=m=>{var c,u,_,g,p;const A=m.CapacitorCustomPlatform||null,v=m.Capacitor||{},P=v.Plugins=v.Plugins||{},R=m.CapacitorPlatforms,q=(null===(c=null==R?void 0:R.currentPlatform)||void 0===c?void 0:c.getPlatform)||(()=>null!==A?A.name:(m=>{var c,u;return null!=m&&m.androidBridge?"android":null!==(u=null===(c=null==m?void 0:m.webkit)||void 0===c?void 0:c.messageHandlers)&&void 0!==u&&u.bridge?"ios":"web"})(m)),Ft=(null===(u=null==R?void 0:R.currentPlatform)||void 0===u?void 0:u.isNativePlatform)||(()=>"web"!==q()),At=(null===(_=null==R?void 0:R.currentPlatform)||void 0===_?void 0:_.isPluginAvailable)||(S=>{const k=ct.get(S);return!!(null!=k&&k.platforms.has(q())||pt(S))}),pt=(null===(g=null==R?void 0:R.currentPlatform)||void 0===g?void 0:g.getPluginHeader)||(S=>{var k;return null===(k=v.PluginHeaders)||void 0===k?void 0:k.find(J=>J.name===S)}),ct=new Map,Mt=(null===(p=null==R?void 0:R.currentPlatform)||void 0===p?void 0:p.registerPlugin)||((S,k={})=>{const J=ct.get(S);if(J)return console.warn(`Capacitor plugin "${S}" already registered. Cannot register plugins twice.`),J.proxy;const V=q(),L=pt(S);let x;const lt=function(){var M=(0,d.A)(function*(){return!x&&V in k?x=x="function"==typeof k[V]?yield k[V]():k[V]:null!==A&&!x&&"web"in k&&(x=x="function"==typeof k.web?yield k.web():k.web),x});return function(){return M.apply(this,arguments)}}(),nt=M=>{let E;const D=(...U)=>{const X=lt().then(T=>{const Y=((M,E)=>{var D,U;if(!L){if(M)return null===(U=M[E])||void 0===U?void 0:U.bind(M);throw new G(`"${S}" plugin is not implemented on ${V}`,j.Unimplemented)}{const X=null==L?void 0:L.methods.find(T=>E===T.name);if(X)return"promise"===X.rtype?T=>v.nativePromise(S,E.toString(),T):(T,Y)=>v.nativeCallback(S,E.toString(),T,Y);if(M)return null===(D=M[E])||void 0===D?void 0:D.bind(M)}})(T,M);if(Y){const at=Y(...U);return E=null==at?void 0:at.remove,at}throw new G(`"${S}.${M}()" is not implemented on ${V}`,j.Unimplemented)});return"addListener"===M&&(X.remove=(0,d.A)(function*(){return E()})),X};return D.toString=()=>`${M.toString()}() { [capacitor code] }`,Object.defineProperty(D,"name",{value:M,writable:!1,configurable:!1}),D},_t=nt("addListener"),ht=nt("removeListener"),Pt=(M,E)=>{const D=_t({eventName:M},E),U=function(){var T=(0,d.A)(function*(){const Y=yield D;ht({eventName:M,callbackId:Y},E)});return function(){return T.apply(this,arguments)}}(),X=new Promise(T=>D.then(()=>T({remove:U})));return X.remove=(0,d.A)(function*(){console.warn("Using addListener() without 'await' is deprecated."),yield U()}),X},ut=new Proxy({},{get(M,E){switch(E){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return L?Pt:_t;case"removeListener":return ht;default:return nt(E)}}});return P[S]=ut,ct.set(S,{name:S,proxy:ut,platforms:new Set([...Object.keys(k),...L?[V]:[]])}),ut});return v.convertFileSrc||(v.convertFileSrc=S=>S),v.getPlatform=q,v.handleError=S=>m.console.error(S),v.isNativePlatform=Ft,v.isPluginAvailable=At,v.pluginMethodNoop=(S,k,J)=>Promise.reject(`${J} does not have an implementation of "${k}".`),v.registerPlugin=Mt,v.Exception=G,v.DEBUG=!!v.DEBUG,v.isLoggingEnabled=!!v.isLoggingEnabled,v.platform=v.getPlatform(),v.isNative=v.isNativePlatform(),v},W=(m=>m.Capacitor=gt(m))(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),$=W.registerPlugin;class Q{constructor(c){this.listeners={},this.retainedEventArguments={},this.windowListeners={},c&&(console.warn(`Capacitor WebPlugin "${c.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=c)}addListener(c,u){var _=this;let g=!1;this.listeners[c]||(this.listeners[c]=[],g=!0),this.listeners[c].push(u);const A=this.windowListeners[c];A&&!A.registered&&this.addWindowListener(A),g&&this.sendRetainedArgumentsForEvent(c);const v=function(){var R=(0,d.A)(function*(){return _.removeListener(c,u)});return function(){return R.apply(this,arguments)}}();return Promise.resolve({remove:v})}removeAllListeners(){var c=this;return(0,d.A)(function*(){c.listeners={};for(const u in c.windowListeners)c.removeWindowListener(c.windowListeners[u]);c.windowListeners={}})()}notifyListeners(c,u,_){const g=this.listeners[c];if(g)g.forEach(p=>p(u));else if(_){let p=this.retainedEventArguments[c];p||(p=[]),p.push(u),this.retainedEventArguments[c]=p}}hasListeners(c){return!!this.listeners[c].length}registerWindowListener(c,u){this.windowListeners[u]={registered:!1,windowEventName:c,pluginEventName:u,handler:_=>{this.notifyListeners(u,_)}}}unimplemented(c="not implemented"){return new W.Exception(c,j.Unimplemented)}unavailable(c="not available"){return new W.Exception(c,j.Unavailable)}removeListener(c,u){var _=this;return(0,d.A)(function*(){const g=_.listeners[c];if(!g)return;const p=g.indexOf(u);_.listeners[c].splice(p,1),_.listeners[c].length||_.removeWindowListener(_.windowListeners[c])})()}addWindowListener(c){window.addEventListener(c.windowEventName,c.handler),c.registered=!0}removeWindowListener(c){c&&(window.removeEventListener(c.windowEventName,c.handler),c.registered=!1)}sendRetainedArgumentsForEvent(c){const u=this.retainedEventArguments[c];u&&(delete this.retainedEventArguments[c],u.forEach(_=>{this.notifyListeners(c,_)}))}}const H=m=>encodeURIComponent(m).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),ot=m=>m.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class dt extends Q{getCookies(){return(0,d.A)(function*(){const c=document.cookie,u={};return c.split(";").forEach(_=>{if(_.length<=0)return;let[g,p]=_.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");g=ot(g).trim(),p=ot(p).trim(),u[g]=p}),u})()}setCookie(c){return(0,d.A)(function*(){try{const u=H(c.key),_=H(c.value),g=`; expires=${(c.expires||"").replace("expires=","")}`,p=(c.path||"/").replace("path=",""),A=null!=c.url&&c.url.length>0?`domain=${c.url}`:"";document.cookie=`${u}=${_||""}${g}; path=${p}; ${A};`}catch(u){return Promise.reject(u)}})()}deleteCookie(c){return(0,d.A)(function*(){try{document.cookie=`${c.key}=; Max-Age=0`}catch(u){return Promise.reject(u)}})()}clearCookies(){return(0,d.A)(function*(){try{const c=document.cookie.split(";")||[];for(const u of c)document.cookie=u.replace(/^ +/,"").replace(/=.*/,`=;expires=${(new Date).toUTCString()};path=/`)}catch(c){return Promise.reject(c)}})()}clearAllCookies(){var c=this;return(0,d.A)(function*(){try{yield c.clearCookies()}catch(u){return Promise.reject(u)}})()}}$("CapacitorCookies",{web:()=>new dt});const it=function(){var m=(0,d.A)(function*(c){return new Promise((u,_)=>{const g=new FileReader;g.onload=()=>{const p=g.result;u(p.indexOf(",")>=0?p.split(",")[1]:p)},g.onerror=p=>_(p),g.readAsDataURL(c)})});return function(u){return m.apply(this,arguments)}}();class bt extends Q{request(c){return(0,d.A)(function*(){const u=((m,c={})=>{const u=Object.assign({method:m.method||"GET",headers:m.headers},c),g=((m={})=>{const c=Object.keys(m);return Object.keys(m).map(g=>g.toLocaleLowerCase()).reduce((g,p,A)=>(g[p]=m[c[A]],g),{})})(m.headers)["content-type"]||"";if("string"==typeof m.data)u.body=m.data;else if(g.includes("application/x-www-form-urlencoded")){const p=new URLSearchParams;for(const[A,v]of Object.entries(m.data||{}))p.set(A,v);u.body=p.toString()}else if(g.includes("multipart/form-data")||m.data instanceof FormData){const p=new FormData;if(m.data instanceof FormData)m.data.forEach((v,P)=>{p.append(P,v)});else for(const v of Object.keys(m.data))p.append(v,m.data[v]);u.body=p;const A=new Headers(u.headers);A.delete("content-type"),u.headers=A}else(g.includes("application/json")||"object"==typeof m.data)&&(u.body=JSON.stringify(m.data));return u})(c,c.webFetchExtra),_=((m,c=!0)=>m?Object.entries(m).reduce((_,g)=>{const[p,A]=g;let v,P;return Array.isArray(A)?(P="",A.forEach(R=>{v=c?encodeURIComponent(R):R,P+=`${p}=${v}&`}),P.slice(0,-1)):(v=c?encodeURIComponent(A):A,P=`${p}=${v}`),`${_}&${P}`},"").substr(1):null)(c.params,c.shouldEncodeUrlParams),g=_?`${c.url}?${_}`:c.url,p=yield fetch(g,u),A=p.headers.get("content-type")||"";let P,R,{responseType:v="text"}=p.ok?c:{};switch(A.includes("application/json")&&(v="json"),v){case"arraybuffer":case"blob":R=yield p.blob(),P=yield it(R);break;case"json":P=yield p.json();break;default:P=yield p.text()}const tt={};return p.headers.forEach((q,st)=>{tt[st]=q}),{data:P,headers:tt,status:p.status,url:p.url}})()}get(c){var u=this;return(0,d.A)(function*(){return u.request(Object.assign(Object.assign({},c),{method:"GET"}))})()}post(c){var u=this;return(0,d.A)(function*(){return u.request(Object.assign(Object.assign({},c),{method:"POST"}))})()}put(c){var u=this;return(0,d.A)(function*(){return u.request(Object.assign(Object.assign({},c),{method:"PUT"}))})()}patch(c){var u=this;return(0,d.A)(function*(){return u.request(Object.assign(Object.assign({},c),{method:"PATCH"}))})()}delete(c){var u=this;return(0,d.A)(function*(){return u.request(Object.assign(Object.assign({},c),{method:"DELETE"}))})()}}$("CapacitorHttp",{web:()=>new bt})},3098:(Et,et,C)=>{C.r(et),C.d(et,{FormPage:()=>oe});var d=C(467),F=C(177),h=C(4341),w=C(2902),s=C(4742),t=C(4438),O=C(4843),j=C(3469),G=C(5079),B=C(5873);function gt(n,i){if(1&n&&t.nrm(0,"ion-icon",3),2&n){const a=t.XpG();t.Y8G("name","primary"===a.color?"add-circle":"trash-outline")}}function jt(n,i){if(1&n&&(t.j41(0,"ion-label"),t.EFF(1),t.k0s()),2&n){const a=t.XpG();t.R7$(),t.JRh(a.text)}}let W=(()=>{var n;class i{constructor(){this.color="primary",this.text="",this.disabled=!1,this.slot="end",this.buttonClick=new t.bkB,(0,G.a)({addCircle:B.YH_,trashOutline:B.P1A})}onClick(){this.disabled||this.buttonClick.emit()}}return(n=i).\u0275fac=function(o){return new(o||n)},n.\u0275cmp=t.VBU({type:n,selectors:[["app-button-add-remove"]],inputs:{color:"color",text:"text",disabled:"disabled",slot:"slot"},outputs:{buttonClick:"buttonClick"},standalone:!0,features:[t.aNF],decls:3,vars:5,consts:[[3,"click","color","disabled","slot"],["slot","icon-only",3,"name",4,"ngIf"],[4,"ngIf"],["slot","icon-only",3,"name"]],template:function(o,e){1&o&&(t.j41(0,"ion-button",0),t.bIt("click",function(){return e.onClick()}),t.DNE(1,gt,1,1,"ion-icon",1)(2,jt,2,1,"ion-label",2),t.k0s()),2&o&&(t.Y8G("color",e.color)("disabled",e.disabled)("slot",e.slot),t.R7$(),t.Y8G("ngIf",!e.text),t.R7$(),t.Y8G("ngIf",e.text))},dependencies:[F.MD,F.bT,s.bv,s.Jm,s.iq,s.he]}),i})();var $=C(5083);const z=(0,$.F3)("CameraPreview",{web:()=>C.e(2606).then(C.bind(C,2606)).then(n=>new n.CameraPreviewWeb)});let Bt=(()=>{var n;class i{constructor(o){this.modalCtrl=o}ngOnInit(){}submit(){this.modalCtrl.dismiss(!0)}cancel(){this.modalCtrl.dismiss(!1)}}return(n=i).\u0275fac=function(o){return new(o||n)(t.rXU(s.W3))},n.\u0275cmp=t.VBU({type:n,selectors:[["app-alert"]],inputs:{title:"title",message:"message",cancelLabel:"cancelLabel",okLabel:"okLabel"},standalone:!0,features:[t.aNF],decls:20,vars:4,consts:[[1,"ion-padding","ion-text-center"],[1,"ion-no-padding"],["size","large","expand","full","color","danger",3,"click"],["size","large","expand","full","color","success",3,"click"]],template:function(o,e){1&o&&(t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),t.EFF(3),t.k0s()()(),t.j41(4,"ion-content",0),t.nrm(5,"br")(6,"br")(7,"br")(8,"br"),t.j41(9,"h2"),t.EFF(10),t.k0s()(),t.j41(11,"ion-footer")(12,"ion-grid",1)(13,"ion-row")(14,"ion-col")(15,"ion-button",2),t.bIt("click",function(){return e.cancel()}),t.EFF(16),t.k0s()(),t.j41(17,"ion-col")(18,"ion-button",3),t.bIt("click",function(){return e.submit()}),t.EFF(19),t.k0s()()()()()),2&o&&(t.R7$(3),t.JRh(e.title),t.R7$(7),t.JRh(e.message),t.R7$(6),t.SpI(" ",e.cancelLabel," "),t.R7$(3),t.SpI(" ",e.okLabel," "))},dependencies:[F.MD,s.bv,s.Jm,s.hU,s.W9,s.M0,s.lO,s.eU,s.ln,s.BC,s.ai],styles:["[_nghost-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:24px;font-weight:500}"]}),i})();var Q=C(9769),Z=function(n){return n.Prompt="PROMPT",n.Camera="CAMERA",n.Photos="PHOTOS",n}(Z||{}),H=function(n){return n.Rear="REAR",n.Front="FRONT",n}(H||{}),ot=function(n){return n.Uri="uri",n.Base64="base64",n.DataUrl="dataUrl",n}(ot||{});class dt extends $.E_{getPhoto(i){var a=this;return(0,d.A)(function*(){return new Promise(function(){var o=(0,d.A)(function*(e,r){if(i.webUseInput||i.source===Z.Photos)a.fileInputExperience(i,e,r);else if(i.source===Z.Prompt){let l=document.querySelector("pwa-action-sheet");l||(l=document.createElement("pwa-action-sheet"),document.body.appendChild(l)),l.header=i.promptLabelHeader||"Photo",l.cancelable=!1,l.options=[{title:i.promptLabelPhoto||"From Photos"},{title:i.promptLabelPicture||"Take Picture"}],l.addEventListener("onSelection",function(){var f=(0,d.A)(function*(b){0===b.detail?a.fileInputExperience(i,e,r):a.cameraExperience(i,e,r)});return function(b){return f.apply(this,arguments)}}())}else a.cameraExperience(i,e,r)});return function(e,r){return o.apply(this,arguments)}}())})()}pickImages(i){var a=this;return(0,d.A)(function*(){return new Promise(function(){var o=(0,d.A)(function*(e,r){a.multipleFileInputExperience(e,r)});return function(e,r){return o.apply(this,arguments)}}())})()}cameraExperience(i,a,o){var e=this;return(0,d.A)(function*(){if(customElements.get("pwa-camera-modal")){const r=document.createElement("pwa-camera-modal");r.facingMode=i.direction===H.Front?"user":"environment",document.body.appendChild(r);try{yield r.componentOnReady(),r.addEventListener("onPhoto",function(){var l=(0,d.A)(function*(f){const b=f.detail;null===b?o(new $.I9("User cancelled photos app")):b instanceof Error?o(b):a(yield e._getCameraPhoto(b,i)),r.dismiss(),document.body.removeChild(r)});return function(f){return l.apply(this,arguments)}}()),r.present()}catch{e.fileInputExperience(i,a,o)}}else console.error("Unable to load PWA Element 'pwa-camera-modal'. See the docs: https://capacitorjs.com/docs/web/pwa-elements."),e.fileInputExperience(i,a,o)})()}fileInputExperience(i,a,o){let e=document.querySelector("#_capacitor-camera-input");const r=()=>{var l;null===(l=e.parentNode)||void 0===l||l.removeChild(e)};e||(e=document.createElement("input"),e.id="_capacitor-camera-input",e.type="file",e.hidden=!0,document.body.appendChild(e),e.addEventListener("change",l=>{const f=e.files[0];let b="jpeg";if("image/png"===f.type?b="png":"image/gif"===f.type&&(b="gif"),"dataUrl"===i.resultType||"base64"===i.resultType){const y=new FileReader;y.addEventListener("load",()=>{if("dataUrl"===i.resultType)a({dataUrl:y.result,format:b});else if("base64"===i.resultType){const I=y.result.split(",")[1];a({base64String:I,format:b})}r()}),y.readAsDataURL(f)}else a({webPath:URL.createObjectURL(f),format:b}),r()}),e.addEventListener("cancel",l=>{o(new $.I9("User cancelled photos app")),r()})),e.accept="image/*",e.capture=!0,i.source===Z.Photos||i.source===Z.Prompt?e.removeAttribute("capture"):i.direction===H.Front?e.capture="user":i.direction===H.Rear&&(e.capture="environment"),e.click()}multipleFileInputExperience(i,a){let o=document.querySelector("#_capacitor-camera-input-multiple");const e=()=>{var r;null===(r=o.parentNode)||void 0===r||r.removeChild(o)};o||(o=document.createElement("input"),o.id="_capacitor-camera-input-multiple",o.type="file",o.hidden=!0,o.multiple=!0,document.body.appendChild(o),o.addEventListener("change",r=>{const l=[];for(let f=0;f<o.files.length;f++){const b=o.files[f];let y="jpeg";"image/png"===b.type?y="png":"image/gif"===b.type&&(y="gif"),l.push({webPath:URL.createObjectURL(b),format:y})}i({photos:l}),e()}),o.addEventListener("cancel",r=>{a(new $.I9("User cancelled photos app")),e()})),o.accept="image/*",o.click()}_getCameraPhoto(i,a){return new Promise((o,e)=>{const r=new FileReader,l=i.type.split("/")[1];"uri"===a.resultType?o({webPath:URL.createObjectURL(i),format:l,saved:!1}):(r.readAsDataURL(i),r.onloadend=()=>{const f=r.result;o("dataUrl"===a.resultType?{dataUrl:f,format:l,saved:!1}:{base64String:f.split(",")[1],format:l,saved:!1})},r.onerror=f=>{e(f)})})}checkPermissions(){var i=this;return(0,d.A)(function*(){if(typeof navigator>"u"||!navigator.permissions)throw i.unavailable("Permissions API not available in this browser");try{return{camera:(yield window.navigator.permissions.query({name:"camera"})).state,photos:"granted"}}catch{throw i.unavailable("Camera permissions are not available in this browser")}})()}requestPermissions(){var i=this;return(0,d.A)(function*(){throw i.unimplemented("Not implemented on web.")})()}pickLimitedLibraryPhotos(){var i=this;return(0,d.A)(function*(){throw i.unavailable("Not implemented on web.")})()}getLimitedLibraryPhotos(){var i=this;return(0,d.A)(function*(){throw i.unavailable("Not implemented on web.")})()}}new dt;const it=(0,$.F3)("Camera",{web:()=>new dt});var mt=C(8880);let vt=(()=>{var n;class i{constructor(o,e){this.navCtrl=o,this.alertCtrl=e}getCamera(o=!0,e=!1){var r=this;return(0,d.A)(function*(){if(typeof navigator<"u"&&navigator.permissions){const l=yield it.checkPermissions();(!l.camera||!l.photos)&&(yield it.requestPermissions({permissions:["photos","camera"]}))}try{return yield it.getPhoto({quality:70,allowEditing:!1,direction:H.Rear,source:Z.Camera,resultType:o?ot.DataUrl:ot.Uri,width:600,height:600,correctOrientation:!0})}catch(l){throw console.log({err:l}),e&&r.navCtrl.back({animated:!1}),new Error(l.message)}})()}getBlob(o){return new Promise((e,r)=>{const l=new XMLHttpRequest;l.onload=()=>{e(l.response)},l.onerror=()=>{r(new Error("uriToBlob failed"))},l.responseType="blob",l.open("GET",o,!0),l.send(null)})}}return(n=i).\u0275fac=function(o){return new(o||n)(t.KVO(mt.q9),t.KVO(s.hG))},n.\u0275prov=t.jDH({token:n,factory:n.\u0275fac,providedIn:"root"}),i})();var Ct=C(4401);let bt=(()=>{var n;class i{constructor(o,e,r,l,f){this.api=o,this.cameraService=e,this.alertCtrl=r,this.faceService=l,this.loadingCtrl=f,this.fotos=[]}hashEncode(o){return btoa(String.fromCharCode(...new Uint8Array(o.buffer)))}hashDecode(o){return new Float32Array(new Uint8Array([...atob(o)].map(e=>e.charCodeAt(0))).buffer)}takePhoto(o){var e=this;return(0,d.A)(function*(){const r=yield e.loadingCtrl.create();try{const l=yield e.cameraService.getCamera(!0);yield r.present();const f=yield e.faceService.getFaceCrop(l.dataUrl);if(yield r.dismiss(),f.face){console.log("TAKE FOTO",{face:f});const y={hash:e.hashEncode(f.descriptor),funcionario:o};console.log({identificacao:y});const I=yield(0,O._)(e.api.save(y));return console.log({result:I}),!0}return!1}catch(l){console.log({error:l}),yield r.dismiss()}return!1})()}previewCamera(o){var e=this;return new Promise(function(){var r=(0,d.A)(function*(l,f){try{let b;console.log("\u{1f535} Iniciando preview da c\xe2mera..."),b=o?{position:o,className:"camera-preview",parent:"content"}:{position:"front",className:"camera-preview",parent:"content"},console.log("\u{1f4f7} Configura\xe7\xf5es da c\xe2mera:",b),yield z.start(b),console.log("\u2705 C\xe2mera iniciada com sucesso!");const y=yield e.loadingCtrl.create({spinner:null,message:"Foto em: 3s",showBackdrop:!1,translucent:!0});console.log("\u23f3 Loader criado..."),yield y.present(),console.log("\u2705 Loader exibido"),setTimeout((0,d.A)(function*(){console.log("\u23f3 Mudando mensagem do loader: Foto em 2s"),y.message="Foto em: 2s"}),1e3),setTimeout((0,d.A)(function*(){console.log("\u23f3 Mudando mensagem do loader: Foto em 1s"),y.message="Foto em: 1s"}),2e3),setTimeout((0,d.A)(function*(){console.log("\u{1f534} Capturando imagem..."),yield y.dismiss(),console.log("\u2705 Loader fechado");try{const I=yield z.captureSample({});console.log("\u{1f4f8} Foto capturada com sucesso!",I),z.stop(),console.log("\u{1f6d1} C\xe2mera parada"),l(I.value)}catch(I){console.error("\u274c Erro ao capturar imagem:",I),f(I)}}),3e3)}catch(b){console.error("\u274c Erro ao iniciar preview da c\xe2mera:",b),z.stop(),f(b)}});return function(l,f){return r.apply(this,arguments)}}())}scan(o){var e=this;return(0,d.A)(function*(){const r=yield e.loadingCtrl.create();try{yield r.present();const l=yield e.previewCamera(o);if(console.log("Preview Camera Data:",l),!l)throw new Error("Falha ao capturar imagem da c\xe2mera");const f=yield e.faceService.getFaceCrop(`data:image/jpeg;base64,${l}`);if(console.log("Face Crop Result:",f),yield r.dismiss(),null==f||!f.face)return z.stop(),!1;const b=yield e.loadingCtrl.create();yield b.present();let y=null;const I=yield(0,O._)(e.api.getAll());console.log("IDs recuperados:",I);const rt=I.map(N=>{try{const K=e.hashDecode(null==N?void 0:N.hash);return K.length>0?{descriptor:K,funcionario:N.funcionario}:{descriptor:!1,funcionario:N.funcionario}}catch(K){return console.error("Erro ao decodificar hash:",K),{descriptor:!1,funcionario:N.funcionario}}});console.log("Quantidade de fotos:",null==rt?void 0:rt.length);for(const[N,K]of rt.entries()){if(!K.descriptor)continue;console.log("Verificando foto:",N);const Ot=yield e.faceService.matchDescriptors(K.descriptor,f.descriptor);if(console.log("Match Ratio:",Ot),Ot<.5){console.log("Match encontrado:",N),y=K.funcionario;break}}return yield b.dismiss(),!!y&&{funcionario:y,face:f.face}}catch(l){return console.error("Erro durante o scan:",l),!1}finally{yield r.dismiss()}})()}}return(n=i).\u0275fac=function(o){return new(o||n)(t.KVO(Q._),t.KVO(vt),t.KVO(s.hG),t.KVO(Ct.R),t.KVO(s.Xi))},n.\u0275prov=t.jDH({token:n,factory:n.\u0275fac,providedIn:"root"}),i})();function It(n,i){if(1&n){const a=t.RV6();t.qex(0),t.j41(1,"ion-row",3)(2,"ion-buttons",3)(3,"ion-button",4),t.bIt("click",function(){t.eBV(a);const e=t.XpG();return t.Njj(e.cancelBuscaFacial.emit())}),t.nrm(4,"ion-icon",5),t.k0s(),t.j41(5,"ion-button",4),t.bIt("click",function(){t.eBV(a);const e=t.XpG();return t.Njj(e.iniciarCamera())}),t.nrm(6,"ion-icon",6),t.k0s(),t.j41(7,"ion-button",4),t.bIt("click",function(){t.eBV(a);const e=t.XpG();return t.Njj(e.iniciarCamera("rear"))}),t.nrm(8,"ion-icon",7),t.k0s()()(),t.bVm()}}function m(n,i){if(1&n){const a=t.RV6();t.j41(0,"ion-card",11),t.bIt("click",function(){t.eBV(a);const e=t.XpG(2);return t.Njj(e.emitResult())}),t.nrm(1,"ion-img",12),t.j41(2,"ion-card-header")(3,"ion-card-title"),t.EFF(4),t.k0s()()()}if(2&n){const a=t.XpG(2);t.R7$(),t.Y8G("src",a.scanResult.face),t.R7$(3),t.SpI(" ",a.scanResult.funcionario.name||"Motorista n\xe3o identificado"," ")}}function c(n,i){if(1&n&&(t.j41(0,"ion-row",8)(1,"ion-col",9),t.DNE(2,m,5,2,"ion-card",10),t.k0s()()),2&n){const a=t.XpG();t.R7$(2),t.Y8G("ngIf",a.scanResult)}}let u=(()=>{var n;class i{constructor(o,e,r){this.modalCtrl=o,this.fotos=e,this.navCtrl=r,this.options={},this.loadingCamera=!0,this.getResultLeitorFacial=new t.bkB,this.cancelBuscaFacial=new t.bkB,(0,G.a)({keypadOutline:B.BSR,cameraOutline:B.GOB,cameraReverseOutline:B.O33})}ngOnInit(){}ngOnChanges(o){o.modoBuscaManualAtivo&&(this.modoBuscaManualAtivo||this.pararCamera())}iniciarCamera(o){var e=this;return(0,d.A)(function*(){yield e.scan(o)})()}pararCamera(){return(0,d.A)(function*(){yield z.stop()})()}scan(o){var e=this;return(0,d.A)(function*(){e.loadingCamera=!0;const r=yield e.fotos.scan(o);if(e.loadingCamera=!1,!r){e.scanResult=!1;const l=yield e.modalCtrl.create({component:Bt,componentProps:{title:"Erro",message:"N\xe3o conseguimos identificar a foto. Gostaria de tentar novamente?",okLabel:"Tentar novamente",cancelLabel:"Busca manual"}});return yield l.present(),(yield l.onDidDismiss()).data?e.scan():(e.pararCamera(),void e.cancelBuscaFacial.emit())}e.scanResult=r})()}recarregarCamera(){var o=this;return(0,d.A)(function*(){yield o.pararCamera(),o.scanResult=void 0,yield o.iniciarCamera()})()}emitResult(){this.getResultLeitorFacial.emit(this.scanResult),this.loadingCamera=!0,this.scanResult=!1}stopCamera(){var o=this;return(0,d.A)(function*(){yield o.pararCamera()})()}}return(n=i).\u0275fac=function(o){return new(o||n)(t.rXU(s.W3),t.rXU(bt),t.rXU(mt.q9))},n.\u0275cmp=t.VBU({type:n,selectors:[["app-leitor-facial"]],inputs:{modoBuscaManualAtivo:"modoBuscaManualAtivo"},outputs:{getResultLeitorFacial:"getResultLeitorFacial",cancelBuscaFacial:"cancelBuscaFacial"},standalone:!0,features:[t.OA$,t.aNF],decls:5,vars:2,consts:[["scanContent",""],["id","content",1,"ion-padding"],[4,"ngIf","ngIfElse"],[1,"ion-justify-content-center","ion-align-items-center"],["fill","clear",3,"click"],["name","keypad-outline"],["name","camera-outline","color","primary"],["name","camera-reverse-outline"],[1,"ion-justify-content-center"],["size","12",1,"ion-text-center"],["class","image-card",3,"click",4,"ngIf"],[1,"image-card",3,"click"],[3,"src"]],template:function(o,e){if(1&o&&(t.j41(0,"ion-content",1)(1,"ion-grid"),t.DNE(2,It,9,0,"ng-container",2)(3,c,3,1,"ng-template",null,0,t.C5r),t.k0s()()),2&o){const r=t.sdS(4);t.R7$(2),t.Y8G("ngIf",e.loadingCamera)("ngIfElse",r)}},dependencies:[F.MD,F.bT,s.bv,s.Jm,s.QW,s.b_,s.ME,s.tN,s.hU,s.W9,s.lO,s.iq,s.KW,s.ln]}),i})();var _=C(2705),g=C(3459);const p=n=>({"ion-hide":n});function A(n,i){1&n&&t.eu8(0)}function v(n,i){1&n&&t.eu8(0)}function P(n,i){if(1&n){const a=t.RV6();t.j41(0,"ion-button",14),t.bIt("click",function(){t.eBV(a);const e=t.XpG(2);return t.Njj(e.modoBuscaManual=!0)}),t.nrm(1,"ion-icon",15),t.k0s()}}function R(n,i){if(1&n){const a=t.RV6();t.j41(0,"ion-button",14),t.bIt("click",function(){t.eBV(a);const e=t.XpG(2);return t.Njj(e.modoBuscaManual=!1)}),t.nrm(1,"ion-icon",16),t.k0s()}}function tt(n,i){if(1&n){const a=t.RV6();t.j41(0,"div",17)(1,"app-leitor-facial",18),t.bIt("cancelBuscaFacial",function(){t.eBV(a);const e=t.XpG(2);return t.Njj(e.modoBuscaManual=!0)})("getResultLeitorFacial",function(e){t.eBV(a);const r=t.XpG(2);return t.Njj(r.resultLeitorFacial(e))}),t.k0s()()}if(2&n){const a=t.XpG(2);t.R7$(),t.Y8G("modoBuscaManualAtivo",a.modoBuscaManual)}}function q(n,i){if(1&n){const a=t.RV6();t.j41(0,"ion-item",8),t.bIt("click",function(){const e=t.eBV(a).$implicit,r=t.XpG(4);return t.Njj(r.adicionarAcompanhante(e))}),t.EFF(1),t.k0s()}if(2&n){const a=i.$implicit;t.R7$(),t.SpI(" ",a.name," ")}}function st(n,i){if(1&n&&(t.j41(0,"ion-list"),t.DNE(1,q,2,1,"ion-item",22),t.k0s()),2&n){const a=t.XpG(3);t.R7$(),t.Y8G("ngForOf",a.acompanhantesFiltrados)}}function Ft(n,i){if(1&n){const a=t.RV6();t.j41(0,"div",19)(1,"ion-item")(2,"ion-searchbar",20),t.mxI("ngModelChange",function(e){t.eBV(a);const r=t.XpG(2);return t.DH7(r.acompanhanteBusca,e)||(r.acompanhanteBusca=e),t.Njj(e)}),t.bIt("ionInput",function(){t.eBV(a);const e=t.XpG(2);return t.Njj(e.buscarAcompanhantes())}),t.k0s()(),t.DNE(3,st,2,1,"ion-list",21),t.k0s()}if(2&n){const a=t.XpG(2);t.R7$(2),t.R50("ngModel",a.acompanhanteBusca),t.R7$(),t.Y8G("ngIf",a.acompanhantesFiltrados.length>0&&a.acompanhanteBusca)}}function yt(n,i){1&n&&t.eu8(0)}function At(n,i){1&n&&t.eu8(0)}function Rt(n,i){if(1&n){const a=t.RV6();t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",7)(3,"ion-button",8),t.bIt("click",function(){t.eBV(a);const e=t.XpG();return t.Njj(e.isOpen=!1)}),t.EFF(4,"Voltar"),t.k0s()(),t.j41(5,"ion-buttons",9),t.DNE(6,P,2,0,"ion-button",10)(7,R,2,0,"ion-button",10),t.k0s()()(),t.j41(8,"ion-content",11),t.DNE(9,tt,2,1,"div",12)(10,Ft,4,2,"div",13)(11,yt,1,0,"ng-container",5)(12,At,1,0,"ng-container",5),t.k0s()}if(2&n){const a=t.XpG(),o=t.sdS(11),e=t.sdS(13);t.R7$(6),t.Y8G("ngIf",!a.modoBuscaManual),t.R7$(),t.Y8G("ngIf",a.modoBuscaManual),t.R7$(2),t.Y8G("ngIf",!a.modoBuscaManual),t.R7$(),t.Y8G("ngIf",a.modoBuscaManual),t.R7$(),t.Y8G("ngTemplateOutlet",o),t.R7$(),t.Y8G("ngTemplateOutlet",e)}}function pt(n,i){if(1&n){const a=t.RV6();t.j41(0,"ion-item")(1,"ion-avatar"),t.nrm(2,"img",24),t.k0s(),t.j41(3,"ion-label"),t.EFF(4),t.k0s(),t.nrm(5,"ion-input",3),t.j41(6,"app-button-add-remove",25),t.bIt("buttonClick",function(){const e=t.eBV(a).$implicit,r=t.XpG(2);return t.Njj(r.removerAcompanhante(e))}),t.k0s()()}if(2&n){const a=i.$implicit,o=t.XpG(2);t.R7$(2),t.Mz_("alt","Foto de acompanhante ",a.name,""),t.Y8G("src",o.fotosAcompanhantesSelecionados[a.id],t.B4B),t.R7$(2),t.JRh(a.name),t.R7$(),t.Y8G("disabled",!0),t.R7$(),t.Y8G("ngClass",t.eq3(6,p,o.isFinished))}}function kt(n,i){if(1&n&&(t.j41(0,"ion-list"),t.DNE(1,pt,7,8,"ion-item",23),t.k0s()),2&n){const a=t.XpG();t.R7$(),t.Y8G("ngForOf",a.acompanhantesSelecionados)}}function St(n,i){1&n&&(t.j41(0,"p",27)(1,"strong"),t.EFF(2,"Nenhum acompanhante selecionado."),t.k0s()())}function ct(n,i){if(1&n&&t.DNE(0,St,3,0,"p",26),2&n){const a=t.XpG();t.Y8G("ngIf",a.acompanhantesSelecionados.length<1)}}let ft=(()=>{var n;class i{constructor(o,e,r){this.funcionarioService=o,this.acompanhanteFrotaSrv=e,this.identificacaoFuncSrv=r,this.modoBuscaManual=!1,this.isOpen=!1,this.acompanhantes=[],this.acompanhanteBusca="",this.acompanhantesFiltrados=[],this.acompanhantesSelecionados=[],this.fotosAcompanhantesSelecionados={},this.tipoAcompanhanteRetorno=!1,this.isFinished=!1,this.statusSaveAcompanhanteFrota=new t.bkB,(0,G.a)({addCircle:B.YH_,keypadOutline:B.BSR,cameraOutline:B.GOB})}ngOnInit(){var o=this;return(0,d.A)(function*(){yield o.carregarAcompanhantes()})()}ngOnChanges(o){var e=this;return(0,d.A)(function*(){if(o.saveAcompanhanteFrota){const r=o.saveAcompanhanteFrota.currentValue;r&&(yield e.submitFrotaAcompanhante(r))}o.idFrota&&e.idFrota&&(yield e.carregarAcompanhantesSelecionados(e.idFrota)),o.tipoAcompanhanteRetorno&&e.idFrota&&(yield e.carregarAcompanhantesSelecionados(e.idFrota))})()}carregarAcompanhantesSelecionados(o){var e=this;return(0,d.A)(function*(){try{let l;l=e.isFinished&&e.tipoAcompanhanteRetorno?yield(0,O._)(e.acompanhanteFrotaSrv.getAll(o,j.E.Retorno)):yield(0,O._)(e.acompanhanteFrotaSrv.getAll(o,j.E.Saida)),yield e.carregarAcompanhantes();const f=e.acompanhantes;console.log(f),e.acompanhantesSelecionados=l.map(b=>f.find(y=>y.id===b.funcCod)).filter(b=>null!=b),e.acompanhantesSelecionados.length>0&&e.acompanhantesSelecionados.forEach(function(){var b=(0,d.A)(function*(y){e.fotosAcompanhantesSelecionados[y.id]=yield e.getPhotoAcompanhante(y.id)});return function(y){return b.apply(this,arguments)}}()),console.log(e.acompanhantesSelecionados)}catch(l){console.error("Erro ao carregar acompanhantes selecionados:",l)}})()}carregarAcompanhantes(){var o=this;return(0,d.A)(function*(){const e=o.funcionarioService.getCachedFuncionarios();if(e&&0!==e.length)o.acompanhantes=e;else{const r=yield(0,O._)(o.funcionarioService.getAll());o.acompanhantes=r}})()}buscarAcompanhantes(){const o=this.acompanhanteBusca.toLowerCase();this.acompanhantesFiltrados=this.acompanhantes.filter(e=>e.name.toLowerCase().includes(o)&&!this.acompanhantesSelecionados.some(r=>r.id===e.id))}adicionarAcompanhante(o){var e=this;return(0,d.A)(function*(){e.fotosAcompanhantesSelecionados[o.id]||(e.fotosAcompanhantesSelecionados[o.id]=yield e.getPhotoAcompanhante(o.id)),e.acompanhantesSelecionados.push(o),e.acompanhanteBusca="",e.acompanhantesFiltrados=[]})()}removerAcompanhante(o){this.acompanhantesSelecionados=this.acompanhantesSelecionados.filter(e=>e.id!==o.id)}submitFrotaAcompanhante(o){var e=this;return(0,d.A)(function*(){const r=e.tipoAcompanhanteRetorno?j.E.Retorno:j.E.Saida,l=e.acompanhantesSelecionados.map(f=>({frotaSeq:o,tipo:r,funcCod:f.id}));e.acompanhantesSelecionados.length>0&&(e.idFrota&&!e.tipoAcompanhanteRetorno?e.acompanhanteFrotaSrv.update(e.idFrota,j.E.Saida,l).subscribe({next:()=>{e.statusSaveAcompanhanteFrota.emit(!0)},error:f=>{e.statusSaveAcompanhanteFrota.emit(!1)}}):e.acompanhanteFrotaSrv.save(l).subscribe({next:()=>{e.statusSaveAcompanhanteFrota.emit(!0)},error:f=>{e.statusSaveAcompanhanteFrota.emit(!1)}}))})()}resultLeitorFacial(o){this.fotosAcompanhantesSelecionados[o.funcionario.id]=o.face,this.acompanhantesSelecionados.push(o.funcionario)}getPhotoAcompanhante(o){var e=this;return(0,d.A)(function*(){const r=yield e.identificacaoFuncSrv.getImage(o);return o&&r?r:"assets/user.png"})()}}return(n=i).\u0275fac=function(o){return new(o||n)(t.rXU(_.r),t.rXU(g.H),t.rXU(Q._))},n.\u0275cmp=t.VBU({type:n,selectors:[["app-frota-acompanhantes"]],inputs:{tipoAcompanhanteRetorno:"tipoAcompanhanteRetorno",saveAcompanhanteFrota:"saveAcompanhanteFrota",idFrota:"idFrota",isFinished:"isFinished"},outputs:{statusSaveAcompanhanteFrota:"statusSaveAcompanhanteFrota"},standalone:!0,features:[t.OA$,t.aNF],decls:14,vars:7,consts:[["listaAcompanhantesSelecionados",""],["mensagensAcompanhantes",""],[1,"ion-justify-content-center","ion-align-items-center"],[2,"width","0","height","0",3,"disabled"],["color","primary",3,"buttonClick","ngClass"],[4,"ngTemplateOutlet"],[3,"isOpen"],["slot","start"],[3,"click"],["slot","end"],["fill","clear",3,"click",4,"ngIf"],[1,"ion-padding"],["class","busca-facial",4,"ngIf"],["class","busca-manual",4,"ngIf"],["fill","clear",3,"click"],["name","keypad-outline"],["name","camera-outline","color","primary"],[1,"busca-facial"],[3,"cancelBuscaFacial","getResultLeitorFacial","modoBuscaManualAtivo"],[1,"busca-manual"],["placeholder","Buscar Acompanhante",3,"ngModelChange","ionInput","ngModel"],[4,"ngIf"],[3,"click",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[3,"src","alt"],["color","danger",3,"buttonClick","ngClass"],["class","ion-text-center",4,"ngIf"],[1,"ion-text-center"]],template:function(o,e){if(1&o){const r=t.RV6();t.j41(0,"ion-list")(1,"ion-item",2)(2,"ion-label"),t.EFF(3,"Acompanhante(s) selecionado(s)"),t.k0s(),t.nrm(4,"ion-input",3),t.j41(5,"app-button-add-remove",4),t.bIt("buttonClick",function(){return t.eBV(r),t.Njj(e.isOpen=!0)}),t.k0s()(),t.DNE(6,A,1,0,"ng-container",5)(7,v,1,0,"ng-container",5),t.k0s(),t.j41(8,"ion-modal",6),t.DNE(9,Rt,13,6,"ng-template"),t.k0s(),t.DNE(10,kt,2,1,"ng-template",null,0,t.C5r)(12,ct,1,1,"ng-template",null,1,t.C5r)}if(2&o){const r=t.sdS(11),l=t.sdS(13);t.R7$(4),t.Y8G("disabled",!0),t.R7$(),t.Y8G("ngClass",t.eq3(5,p,e.isFinished)),t.R7$(),t.Y8G("ngTemplateOutlet",r),t.R7$(),t.Y8G("ngTemplateOutlet",l),t.R7$(),t.Y8G("isOpen",e.isOpen)}},dependencies:[F.MD,F.YU,F.Sq,F.bT,F.T3,s.bv,s.mC,s.Jm,s.QW,s.W9,s.eU,s.iq,s.$w,s.uz,s.he,s.nf,s.S1,s.ai,s.Sb,s.Gw,w.iI,h.YN,h.BC,h.vS,W,u],styles:["ion-avatar[_ngcontent-%COMP%]{height:80px;width:80px;background-color:#fff;margin-top:1rem;border-radius:50%;margin-right:1rem}ion-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{object-fit:contain}app-leitor-facial[_ngcontent-%COMP%]{height:510px;display:block}.busca-facial[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{margin:auto}"]}),i})();function Mt(n,i){if(1&n&&(t.j41(0,"ion-select-option",5),t.EFF(1),t.k0s()),2&n){const a=i.$implicit,o=t.XpG();t.Y8G("value",a[o.idKey]),t.R7$(),t.SpI(" ",a[o.descricaoKey]||""," ")}}function S(n,i){if(1&n){const a=t.RV6();t.qex(0),t.j41(1,"ion-button",6),t.bIt("click",function(){t.eBV(a);const e=t.XpG();return t.Njj(e.add())}),t.nrm(2,"ion-icon",7),t.k0s(),t.bVm()}}let k=(()=>{var n;class i{constructor(){this.data=[],this.control=new h.MJ,this.placeholder="",this.label="Motivo",this.idKey="id",this.descricaoKey="descricao",this.showAddButton=!0,this.itemAdd=new t.bkB,(0,G.a)({addCircle:B.YH_})}add(){this.itemAdd.emit()}}return(n=i).\u0275fac=function(o){return new(o||n)},n.\u0275cmp=t.VBU({type:n,selectors:[["app-frota-select"]],inputs:{data:"data",control:"control",placeholder:"placeholder",label:"label",idKey:"idKey",descricaoKey:"descricaoKey",showAddButton:"showAddButton"},outputs:{itemAdd:"itemAdd"},standalone:!0,features:[t.aNF],decls:6,vars:5,consts:[[1,"ion-justify-content-center","ion-align-items-center"],["position","floating"],[3,"formControl","placeholder"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"value"],["slot","end","color","primary",3,"click"],["name","add-circle"]],template:function(o,e){1&o&&(t.j41(0,"ion-item",0)(1,"ion-label",1),t.EFF(2),t.k0s(),t.j41(3,"ion-select",2),t.DNE(4,Mt,2,2,"ion-select-option",3),t.k0s(),t.DNE(5,S,3,0,"ng-container",4),t.k0s()),2&o&&(t.R7$(2),t.JRh(e.label),t.R7$(),t.Y8G("formControl",e.control)("placeholder",e.placeholder),t.R7$(),t.Y8G("ngForOf",e.data),t.R7$(),t.Y8G("ngIf",e.showAddButton))},dependencies:[F.MD,F.Sq,F.bT,s.bv,s.Jm,s.iq,s.uz,s.he,s.Nm,s.Ip,s.Je,w.iI,h.X1,h.BC,h.l_]}),i})();function J(n,i){if(1&n){const a=t.RV6();t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",1)(3,"ion-button",2),t.bIt("click",function(){t.eBV(a);const e=t.XpG();return t.Njj(e.botaoCancelarModal())}),t.EFF(4,"Voltar"),t.k0s()(),t.j41(5,"ion-buttons",3)(6,"ion-button",4),t.bIt("click",function(){t.eBV(a);const e=t.XpG();return t.Njj(e.botaoConfirmar())}),t.EFF(7," Confirmar "),t.k0s()()()(),t.j41(8,"ion-content",5)(9,"ion-item")(10,"ion-row")(11,"ion-col",6),t.nrm(12,"ion-textarea",7),t.EFF(13),t.k0s()()()()}if(2&n){const a=t.XpG();t.R7$(6),t.Y8G("disabled",!a.descricaoControl.value)("strong",!0),t.R7$(6),t.Y8G("formControl",a.descricaoControl)("placeholder",a.placeholder),t.R7$(),t.SpI(" ",a.descricaoControl.value," ")}}let V=(()=>{var n;class i{constructor(){this.isOpen=!1,this.placeholder="Descri\xe7\xe3o",this.descricaoControl=new h.MJ(""),this.cancelar=new t.bkB,this.confirmar=new t.bkB}botaoCancelarModal(){this.cancelar.emit()}botaoConfirmar(){this.confirmar.emit()}}return(n=i).\u0275fac=function(o){return new(o||n)},n.\u0275cmp=t.VBU({type:n,selectors:[["app-frota-basic-modal"]],inputs:{isOpen:"isOpen",placeholder:"placeholder",descricaoControl:"descricaoControl"},outputs:{cancelar:"cancelar",confirmar:"confirmar"},standalone:!0,features:[t.aNF],decls:2,vars:1,consts:[[3,"isOpen"],["slot","start"],[3,"click"],["slot","end"],[3,"click","disabled","strong"],[1,"ion-padding"],["size","12"],["rows","3","fill","outline",3,"formControl","placeholder"]],template:function(o,e){1&o&&(t.j41(0,"ion-modal",0),t.DNE(1,J,14,5,"ng-template"),t.k0s()),2&o&&t.Y8G("isOpen",e.isOpen)},dependencies:[F.MD,s.bv,s.Jm,s.QW,s.hU,s.W9,s.eU,s.uz,s.ln,s.nc,s.ai,s.Sb,s.Gw,w.iI,h.X1,h.BC,h.l_]}),i})();var L=C(3207),x=C(8313);let lt=(()=>{var n;class i{constructor(o,e,r){this.service=o,this.loadingCtrl=e,this.alertCtrl=r,this.modalOpen=!1,this.control=new h.MJ(""),this.descricao=new h.MJ(""),this.data=[]}loadingData(){var o=this;return(0,d.A)(function*(){try{const e=yield(0,L.s)(o.service.getAll());o.data=e}catch(e){throw console.error("Erro ao carregar:",e.message),e}})()}addItem(){this.modalOpen=!0,console.log("Adicionar motivo clicado!")}onModalCancel(){this.modalOpen=!1}onModalConfirm(){var o=this;return(0,d.A)(function*(){var e;yield(0,x.h)(o.loadingCtrl,o.alertCtrl,{mainAction:(e=(0,d.A)(function*(){yield(0,L.s)(o.service.save({descricao:o.descricao.value})),yield o.loadingData(),o.modalOpen=!1}),function(){return e.apply(this,arguments)}),onError:e=>{console.error("Erro ao executar a\xe7\xe3o no modal:",e.message)}})})()}}return(n=i).\u0275fac=function(o){t.QTQ()},n.\u0275prov=t.jDH({token:n,factory:n.\u0275fac,providedIn:"any"}),i})();var wt=C(3103),nt=C(9795);let _t=(()=>{var n;class i extends lt{constructor(o,e,r){super(o,e,r)}ngOnInit(){var o=this;return(0,d.A)(function*(){yield o.loadingData()})()}}return(n=i).\u0275fac=function(o){return new(o||n)(t.rXU(wt.i),t.rXU(nt.Xi),t.rXU(s.hG))},n.\u0275cmp=t.VBU({type:n,selectors:[["app-frota-motivo"]],inputs:{control:"control"},standalone:!0,features:[t.Vt3,t.aNF],decls:2,vars:4,consts:[["label","Sele\xe7\xe3o de Motivo",3,"itemAdd","data","control"],["placeholder","Digite aqui o motivo",3,"cancelar","confirmar","isOpen","descricaoControl"]],template:function(o,e){1&o&&(t.j41(0,"app-frota-select",0),t.bIt("itemAdd",function(){return e.addItem()}),t.k0s(),t.j41(1,"app-frota-basic-modal",1),t.bIt("cancelar",function(){return e.onModalCancel()})("confirmar",function(){return e.onModalConfirm()}),t.k0s()),2&o&&(t.Y8G("data",e.data)("control",e.control),t.R7$(),t.Y8G("isOpen",e.modalOpen)("descricaoControl",e.descricao))},dependencies:[F.MD,s.bv,w.iI,h.X1,k,V]}),i})();var ht=C(2553);let Pt=(()=>{var n;class i extends lt{constructor(o,e,r){super(o,e,r)}ngOnInit(){var o=this;return(0,d.A)(function*(){yield o.loadingData()})()}}return(n=i).\u0275fac=function(o){return new(o||n)(t.rXU(ht.G),t.rXU(s.Xi),t.rXU(s.hG))},n.\u0275cmp=t.VBU({type:n,selectors:[["app-frota-destino"]],inputs:{control:"control"},standalone:!0,features:[t.Vt3,t.aNF],decls:2,vars:4,consts:[["label","Sele\xe7\xe3o de Destino",3,"itemAdd","data","control"],["placeholder","Digite aqui o destino",3,"cancelar","confirmar","isOpen","descricaoControl"]],template:function(o,e){1&o&&(t.j41(0,"app-frota-select",0),t.bIt("itemAdd",function(){return e.addItem()}),t.k0s(),t.j41(1,"app-frota-basic-modal",1),t.bIt("cancelar",function(){return e.onModalCancel()})("confirmar",function(){return e.onModalConfirm()}),t.k0s()),2&o&&(t.Y8G("data",e.data)("control",e.control),t.R7$(),t.Y8G("isOpen",e.modalOpen)("descricaoControl",e.descricao))},dependencies:[F.MD,s.bv,w.iI,h.X1,k,V]}),i})();var ut=C(7106);let M=(()=>{var n;class i extends lt{constructor(o,e,r){super(o,e,r),this.withoutRoutesOpen=!0}ngOnInit(){var o=this;return(0,d.A)(function*(){o.withoutRoutesOpen?yield o.loadingDataWithoutRoutesOpen():yield o.loadingData()})()}loadingDataWithoutRoutesOpen(){var o=this;return(0,d.A)(function*(){try{const e=yield(0,L.s)(o.service.getAllWithoutRoutesOpen());o.data=e}catch(e){throw console.error("Erro ao carregar veiculos:",e.message),e}})()}}return(n=i).\u0275fac=function(o){return new(o||n)(t.rXU(ut.T),t.rXU(s.Xi),t.rXU(nt.hG))},n.\u0275cmp=t.VBU({type:n,selectors:[["app-frota-veiculo"]],inputs:{control:"control",withoutRoutesOpen:"withoutRoutesOpen"},standalone:!0,features:[t.Vt3,t.aNF],decls:1,vars:3,consts:[["label","Sele\xe7\xe3o de ve\xedculo",3,"itemAdd","data","control","showAddButton"]],template:function(o,e){1&o&&(t.j41(0,"app-frota-select",0),t.bIt("itemAdd",function(){return e.addItem()}),t.k0s()),2&o&&t.Y8G("data",e.data)("control",e.control)("showAddButton",!1)},dependencies:[F.MD,s.bv,w.iI,h.X1,k]}),i})();var E=C(5964),D=C(5784);const U=n=>({"ion-hide":n});function X(n,i){if(1&n){const a=t.RV6();t.j41(0,"ion-item",3)(1,"ion-label"),t.EFF(2,"Selecionar motorista:"),t.k0s(),t.qex(3),t.j41(4,"app-button-add-remove",4),t.bIt("buttonClick",function(){t.eBV(a);const e=t.XpG();return t.Njj(e.isOpen=!0)}),t.k0s(),t.bVm(),t.k0s()}if(2&n){const a=t.XpG();t.R7$(4),t.Y8G("ngClass",t.eq3(1,U,a.isFinished))}}function T(n,i){if(1&n){const a=t.RV6();t.j41(0,"ion-item")(1,"div",5)(2,"ion-label",6),t.EFF(3,"Motorista:"),t.k0s(),t.j41(4,"ion-input",7),t.mxI("ngModelChange",function(e){t.eBV(a);const r=t.XpG();return t.DH7(r.motoristaSelecionado.name,e)||(r.motoristaSelecionado.name=e),t.Njj(e)}),t.k0s()(),t.j41(5,"app-button-add-remove",8),t.bIt("buttonClick",function(){t.eBV(a);const e=t.XpG();return t.Njj(e.removerMotorista())}),t.k0s()()}if(2&n){const a=t.XpG();t.R7$(4),t.Y8G("readonly",!0),t.R50("ngModel",a.motoristaSelecionado.name)}}function Y(n,i){if(1&n){const a=t.RV6();t.j41(0,"ion-button",16),t.bIt("click",function(){t.eBV(a);const e=t.XpG(2);return t.Njj(e.modoBuscaManual=!0)}),t.nrm(1,"ion-icon",17),t.k0s()}}function at(n,i){if(1&n){const a=t.RV6();t.j41(0,"ion-button",16),t.bIt("click",function(){t.eBV(a);const e=t.XpG(2);return t.Njj(e.modoBuscaManual=!1)}),t.nrm(1,"ion-icon",18),t.k0s()}}function Tt(n,i){if(1&n){const a=t.RV6();t.j41(0,"div",19)(1,"app-leitor-facial",20),t.bIt("cancelBuscaFacial",function(){t.eBV(a);const e=t.XpG(2);return t.Njj(e.modoBuscaManual=!0)})("getResultLeitorFacial",function(e){t.eBV(a);const r=t.XpG(2);return t.Njj(r.resultLeitorFacial(e))}),t.k0s()()}if(2&n){const a=t.XpG(2);t.R7$(),t.Y8G("modoBuscaManualAtivo",a.modoBuscaManual)}}function xt(n,i){if(1&n){const a=t.RV6();t.j41(0,"ion-item",10),t.bIt("click",function(){const e=t.eBV(a).$implicit,r=t.XpG(4);return t.Njj(r.selecionarMotorista(e))}),t.EFF(1),t.k0s()}if(2&n){const a=i.$implicit;t.R7$(),t.SpI(" ",a.name," ")}}function Dt(n,i){if(1&n&&(t.j41(0,"ion-list"),t.DNE(1,xt,2,1,"ion-item",23),t.k0s()),2&n){const a=t.XpG(3);t.R7$(),t.Y8G("ngForOf",a.motoristasFiltrados)}}function $t(n,i){1&n&&(t.j41(0,"ion-text"),t.EFF(1," Nenhum motorista encontrado. "),t.k0s())}function Vt(n,i){if(1&n){const a=t.RV6();t.j41(0,"div",21)(1,"ion-item")(2,"ion-searchbar",22),t.mxI("ngModelChange",function(e){t.eBV(a);const r=t.XpG(2);return t.DH7(r.funcionarioBusca,e)||(r.funcionarioBusca=e),t.Njj(e)}),t.bIt("ionInput",function(){t.eBV(a);const e=t.XpG(2);return t.Njj(e.buscarMotoristas())}),t.k0s()(),t.DNE(3,Dt,2,1,"ion-list",1)(4,$t,2,0,"ion-text",1),t.k0s()}if(2&n){const a=t.XpG(2);t.R7$(2),t.R50("ngModel",a.funcionarioBusca),t.R7$(),t.Y8G("ngIf",a.motoristasFiltrados.length>0&&a.funcionarioBusca),t.R7$(),t.Y8G("ngIf",0===a.motoristasFiltrados.length&&a.funcionarioBusca)}}function Lt(n,i){if(1&n){const a=t.RV6();t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",9)(3,"ion-button",10),t.bIt("click",function(){t.eBV(a);const e=t.XpG();return t.Njj(e.isOpen=!1)}),t.EFF(4,"Voltar"),t.k0s()(),t.j41(5,"ion-title"),t.EFF(6,"Selecionar Motorista"),t.k0s(),t.j41(7,"ion-buttons",11),t.DNE(8,Y,2,0,"ion-button",12)(9,at,2,0,"ion-button",12),t.k0s()()(),t.j41(10,"ion-content",13),t.DNE(11,Tt,2,1,"div",14)(12,Vt,5,3,"div",15),t.k0s()}if(2&n){const a=t.XpG();t.R7$(8),t.Y8G("ngIf",!a.modoBuscaManual),t.R7$(),t.Y8G("ngIf",a.modoBuscaManual),t.R7$(),t.Y8G("fullscreen",!0),t.R7$(),t.Y8G("ngIf",!a.modoBuscaManual),t.R7$(),t.Y8G("ngIf",a.modoBuscaManual)}}let Ut=(()=>{var n;class i{constructor(o){this.funcionarioService=o,this.modoBuscaManual=!1,this.isOpen=!1,this.funcionarios=[],this.funcionarioBusca="",this.motoristasFiltrados=[],this.motoristaSelecionado=null,this.isFinished=!1,(0,G.a)({trashOutline:B.P1A})}ngOnInit(){var o=this;return(0,d.A)(function*(){yield o.carregarMotoristas(),o.getMotoristaIdSubscription=o.control.valueChanges.subscribe(function(){var e=(0,d.A)(function*(r){r&&(yield o.carregarMotoristaSelecionado(r))});return function(r){return e.apply(this,arguments)}}())})()}carregarMotoristas(){var o=this;return(0,d.A)(function*(){const e=o.funcionarioService.getCachedFuncionarios();if(e&&0!==e.length)o.funcionarios=e;else{const r=yield(0,O._)(o.funcionarioService.getAll());o.funcionarios=r}})()}buscarMotoristas(){const o=this.funcionarioBusca.toLowerCase();this.motoristasFiltrados=this.funcionarios.filter(e=>{var r;return null===(r=e.name)||void 0===r?void 0:r.toLowerCase().includes(o)})}selecionarMotorista(o){this.motoristaSelecionado=o,this.control.setValue(o.id),this.isOpen=!1,this.funcionarioBusca="",this.motoristasFiltrados=[]}removerMotorista(){this.motoristaSelecionado=null,this.control.setValue(null)}ngOnChanges(o){var e=this;return(0,d.A)(function*(){if(o.control){const r=o.control.currentValue;r&&r.value&&(yield e.carregarMotoristaSelecionado(r.value))}})()}carregarMotoristaSelecionado(o){var e=this;return(0,d.A)(function*(){try{yield e.carregarMotoristas(),e.motoristaSelecionado=e.funcionarios.find(l=>l.id===o)}catch(r){console.error("Erro ao carregar motorista selecionado:",r)}})()}resultLeitorFacial(o){this.selecionarMotorista(o.funcionario)}ngOnDestroy(){this.getMotoristaIdSubscription.unsubscribe()}}return(n=i).\u0275fac=function(o){return new(o||n)(t.rXU(_.r))},n.\u0275cmp=t.VBU({type:n,selectors:[["app-frota-motorista"]],inputs:{control:"control",isFinished:"isFinished"},standalone:!0,features:[t.OA$,t.aNF],decls:5,vars:3,consts:[["class","ion-justify-content-center ion-align-items-center",4,"ngIf"],[4,"ngIf"],[3,"isOpen"],[1,"ion-justify-content-center","ion-align-items-center"],["color","primary",3,"buttonClick","ngClass"],[1,"item-content"],["position","floating"],[3,"ngModelChange","readonly","ngModel"],["color","danger","slot","end",3,"buttonClick"],["slot","start"],[3,"click"],["slot","end"],["fill","clear",3,"click",4,"ngIf"],[1,"ion-padding",3,"fullscreen"],["class","busca-facial",4,"ngIf"],["class","busca-manual",4,"ngIf"],["fill","clear",3,"click"],["name","keypad-outline"],["name","camera-outline","color","primary"],[1,"busca-facial"],[3,"cancelBuscaFacial","getResultLeitorFacial","modoBuscaManualAtivo"],[1,"busca-manual"],["placeholder","Buscar Motorista",3,"ngModelChange","ionInput","ngModel"],[3,"click",4,"ngFor","ngForOf"]],template:function(o,e){1&o&&(t.j41(0,"ion-list"),t.DNE(1,X,5,3,"ion-item",0)(2,T,6,2,"ion-item",1),t.k0s(),t.j41(3,"ion-modal",2),t.DNE(4,Lt,13,5,"ng-template"),t.k0s()),2&o&&(t.R7$(),t.Y8G("ngIf",!e.motoristaSelecionado),t.R7$(),t.Y8G("ngIf",e.motoristaSelecionado),t.R7$(),t.Y8G("isOpen",e.isOpen))},dependencies:[F.MD,F.YU,F.Sq,F.bT,s.bv,s.Jm,s.QW,s.W9,s.eU,s.iq,s.$w,s.uz,s.he,s.nf,s.S1,s.IO,s.BC,s.ai,s.Sb,s.Gw,w.iI,h.YN,h.BC,h.vS,W,u],styles:["ion-item[_ngcontent-%COMP%]{display:flex;align-items:center}ion-item[_ngcontent-%COMP%]   .item-content[_ngcontent-%COMP%]{flex-grow:1;display:flex;flex-direction:column;width:100%}app-leitor-facial[_ngcontent-%COMP%]{height:510px;display:block}"]}),i})();var Xt=C(8663);function Yt(n,i){1&n&&(t.j41(0,"span"),t.EFF(1,"Campo obrigat\xf3rio."),t.k0s())}function Nt(n,i){1&n&&(t.j41(0,"span"),t.EFF(1,"O valor m\xednimo permitido \xe9 o Km de sa\xedda."),t.k0s())}function Wt(n,i){if(1&n&&(t.j41(0,"ion-text",7),t.DNE(1,Yt,2,0,"span",8)(2,Nt,2,0,"span",8),t.k0s()),2&n){const a=t.XpG();t.R7$(),t.Y8G("ngIf",null==a.kmRetornoControl||null==a.kmRetornoControl.errors?null:a.kmRetornoControl.errors.required),t.R7$(),t.Y8G("ngIf",null==a.kmRetornoControl||null==a.kmRetornoControl.errors?null:a.kmRetornoControl.errors.min)}}function Ht(n,i){if(1&n){const a=t.RV6();t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),t.EFF(3,"Selecionar Data e Hora"),t.k0s(),t.j41(4,"ion-buttons",9)(5,"ion-button",10),t.bIt("click",function(){t.eBV(a);const e=t.XpG();return t.Njj(e.onCloseModal())}),t.EFF(6,"Voltar"),t.k0s()(),t.j41(7,"ion-buttons",11)(8,"ion-button",12),t.bIt("click",function(){t.eBV(a);const e=t.XpG();return t.Njj(e.onConfirmSelectDate())}),t.EFF(9,"Confirmar"),t.k0s()()()(),t.j41(10,"ion-content",13),t.nrm(11,"ion-datetime",14),t.k0s()}if(2&n){const a=t.XpG();t.R7$(8),t.Y8G("disabled",!a.dataRetornoControl.value)("strong",!0),t.R7$(3),t.Y8G("formControl",a.dataRetornoControl)}}let qt=(()=>{var n;class i{constructor(o){this.datePipe=o,this.openModal=!1}ngOnInit(){this.dataRetornoControl.valueChanges.subscribe(o=>{var e;console.log(o),o&&(this.showDataRetorno=null!==(e=this.datePipe.transform(o,"dd-MM-yyyy HH:mm","pt-BR"))&&void 0!==e?e:"")}),this.dataRetornoControl.setValue(new Date)}onOpenModal(){this.openModal=!0}onCloseModal(){this.openModal=!1}onConfirmSelectDate(){this.openModal=!0}}return(n=i).\u0275fac=function(o){return new(o||n)(t.rXU(F.vh))},n.\u0275cmp=t.VBU({type:n,selectors:[["app-frota-retorno"]],inputs:{dataCard:"dataCard",kmRetornoControl:"kmRetornoControl",dataRetornoControl:"dataRetornoControl",tipoAcompanhanteRetorno:"tipoAcompanhanteRetorno",saveAcompanhanteFrota:"saveAcompanhanteFrota"},standalone:!0,features:[t.Jv_([F.vh]),t.aNF],decls:16,vars:11,consts:[[3,"hideButtonActions","data"],["position","floating"],["type","number",3,"formControl"],["color","danger",4,"ngIf"],[3,"ngModelChange","click","readonly","ngModel"],[3,"tipoAcompanhanteRetorno","saveAcompanhanteFrota","idFrota"],[1,"modal-data-time",3,"isOpen","backdropDismiss"],["color","danger"],[4,"ngIf"],["slot","start"],[3,"click"],["slot","end"],[3,"click","disabled","strong"],[1,"ion-padding"],["presentation","date-time",3,"formControl"]],template:function(o,e){1&o&&(t.nrm(0,"app-card",0),t.j41(1,"ion-grid")(2,"ion-row")(3,"ion-col")(4,"ion-item")(5,"ion-label",1),t.EFF(6,"Km Retorno"),t.k0s(),t.nrm(7,"ion-input",2),t.DNE(8,Wt,3,2,"ion-text",3),t.k0s(),t.j41(9,"ion-item")(10,"ion-label",1),t.EFF(11,"Data e hora de retorno"),t.k0s(),t.j41(12,"ion-input",4),t.mxI("ngModelChange",function(l){return t.DH7(e.showDataRetorno,l)||(e.showDataRetorno=l),l}),t.bIt("click",function(){return e.onOpenModal()}),t.k0s()(),t.nrm(13,"app-frota-acompanhantes",5),t.j41(14,"ion-modal",6),t.DNE(15,Ht,12,3,"ng-template"),t.k0s()()()()),2&o&&(t.Y8G("hideButtonActions",!0)("data",e.dataCard),t.R7$(7),t.Y8G("formControl",e.kmRetornoControl),t.R7$(),t.Y8G("ngIf",(null==e.kmRetornoControl?null:e.kmRetornoControl.invalid)&&(null==e.kmRetornoControl?null:e.kmRetornoControl.touched)),t.R7$(4),t.Y8G("readonly",!0),t.R50("ngModel",e.showDataRetorno),t.R7$(),t.Y8G("tipoAcompanhanteRetorno",e.tipoAcompanhanteRetorno)("saveAcompanhanteFrota",e.saveAcompanhanteFrota)("idFrota",e.dataCard.id),t.R7$(),t.Y8G("isOpen",e.openModal)("backdropDismiss",!1))},dependencies:[s.bv,s.Jm,s.QW,s.hU,s.W9,s.A9,s.lO,s.eU,s.$w,s.uz,s.he,s.ln,s.IO,s.BC,s.ai,s.Sb,s.su,s.Je,s.Gw,F.MD,F.bT,Xt.i,h.X1,h.BC,h.l_,h.YN,h.vS,ft]}),i})();var Jt=C(9457),Kt=C(2177);let zt=(()=>{var n;class i{constructor(o){this.fb=o}createSaidaFrotaForm(){return this.fb.group({dataHoraSaida:[null,h.k0.required],imobilizadoCod:[null,h.k0.required],destinoSeq:[null,h.k0.required],quilometragemNaSaida:[null,[h.k0.required,h.k0.min(0)]],motivoSeq:[null,h.k0.required],funcCod:[null,h.k0.required],obs:[""]})}addRetornoControls(o,e){o.addControl("quilometragemNoRetorno",new h.MJ(e+1,[h.k0.required,h.k0.min(null!=e?e:1)])),o.addControl("dataHoraRetorno",new h.MJ(new Date,h.k0.required))}}return(n=i).\u0275fac=function(o){return new(o||n)(t.KVO(h.ok))},n.\u0275prov=t.jDH({token:n,factory:n.\u0275fac,providedIn:"root"}),i})();function Qt(n,i){if(1&n&&(t.qex(0),t.nrm(1,"app-frota-retorno",11),t.bVm()),2&n){const a=t.XpG();t.R7$(),t.Y8G("dataCard",a.dataSharedCard)("kmRetornoControl",a.form.controls.quilometragemNoRetorno)("dataRetornoControl",a.form.controls.dataHoraRetorno)("tipoAcompanhanteRetorno",a.isClose)("saveAcompanhanteFrota",a.sendSaidaIdForAcompanhante)}}function Zt(n,i){if(1&n&&(t.qex(0),t.nrm(1,"app-frota-veiculo",18),t.bVm()),2&n){const a=t.XpG(2);t.R7$(),t.Y8G("control",a.form.controls.imobilizadoCod)("withoutRoutesOpen",!1)}}function te(n,i){if(1&n&&(t.qex(0),t.nrm(1,"app-frota-veiculo",13),t.bVm()),2&n){const a=t.XpG(2);t.R7$(),t.Y8G("control",a.form.controls.imobilizadoCod)}}function ee(n,i){if(1&n&&(t.qex(0),t.j41(1,"ion-grid",12)(2,"ion-row")(3,"ion-col"),t.nrm(4,"app-frota-motorista",13),t.DNE(5,Zt,2,2,"ng-container",10)(6,te,2,1,"ng-container",10),t.nrm(7,"app-frota-destino",13),t.j41(8,"ion-item")(9,"ion-label",14),t.EFF(10,"Km Sa\xedda"),t.k0s(),t.nrm(11,"ion-input",15),t.k0s(),t.nrm(12,"app-frota-motivo",13),t.j41(13,"ion-item")(14,"ion-label",14),t.EFF(15,"Observa\xe7\xf5es"),t.k0s(),t.nrm(16,"ion-textarea",16),t.k0s(),t.nrm(17,"app-frota-acompanhantes",17),t.k0s()()(),t.bVm()),2&n){const a=t.XpG();t.R7$(),t.Y8G("formGroup",a.form),t.R7$(3),t.Y8G("control",a.form.controls.funcCod),t.R7$(),t.Y8G("ngIf",a.id),t.R7$(),t.Y8G("ngIf",!a.id),t.R7$(),t.Y8G("control",a.form.controls.destinoSeq),t.R7$(5),t.Y8G("control",a.form.controls.motivoSeq),t.R7$(5),t.Y8G("tipoAcompanhanteRetorno",a.isClose)("saveAcompanhanteFrota",a.sendSaidaIdForAcompanhante)("idFrota",a.id)}}let oe=(()=>{var n;class i{constructor(o,e,r,l,f,b,y,I,rt){this.fb=o,this.frotaSaidaSrv=e,this.loaddingCtrl=r,this.alertCtrl=l,this.router=f,this.route=b,this.dataSharedCardSrv=y,this.identificacaoFuncSrv=I,this.frotaSaidaForm=rt,this.id=null,this.sendSaidaIdForAcompanhante=null,this.isClose=!1,this.routeSubscription=null,this.appRoutes=D.S,this.dataSharedCard=null,this.openModalDataTime=!1,this.changeFuncCodSubscription=null,this.srcFotoMotorista="assets/user.png",this.form=this.frotaSaidaForm.createSaidaFrotaForm()}ngOnInit(){var o=this;return(0,d.A)(function*(){o.updateRouteData(),o.changeFuncCodSubscription=o.form.controls.funcCod.valueChanges.subscribe(function(){var e=(0,d.A)(function*(r){const l=yield o.identificacaoFuncSrv.getImage(r);r&&l&&(o.srcFotoMotorista=yield o.identificacaoFuncSrv.getImage(r)),r||(o.srcFotoMotorista="assets/user.png")});return function(r){return e.apply(this,arguments)}}()),o.routeSubscription=o.router.events.pipe((0,E.p)(e=>e instanceof w.wF)).subscribe((0,d.A)(function*(){return yield o.updateRouteData()}))})()}updateRouteData(){var o=this;return(0,d.A)(function*(){if(o.id=Number(o.route.snapshot.paramMap.get("id"))||null,o.isClose=o.route.snapshot.url.some(r=>"close"===r.path),o.dataSharedCard=yield o.dataSharedCardSrv.getData(),o.isClose){var e;o.dataSharedCard||(o.dataSharedCard=yield o.dataSharedCardSrv.getData());const r=null===(e=o.dataSharedCard)||void 0===e?void 0:e.quilometragemNaSaida;o.frotaSaidaForm.addRetornoControls(o.form,null!=r?r:1)}o.id&&(o.dataSharedCard||(o.dataSharedCard=yield o.dataSharedCardSrv.getData()),o.dataSharedCard?o.form.patchValue(o.dataSharedCard):o.getDataForEditForm(o.id))})()}getDataForEditForm(o){this.frotaSaidaSrv.getById(o).subscribe(e=>{this.dataSharedCard=e,this.form.patchValue(e)})}onSubmit(){var o=this;return(0,d.A)(function*(){var e,r;o.id||o.isClose||null===(e=o.form.get("dataHoraSaida"))||void 0===e||e.setValue(new Date),o.form.valid?yield(0,x.h)(o.loaddingCtrl,o.alertCtrl,{mainAction:(r=(0,d.A)(function*(){const l=o.form.value;if(o.isClose||o.id){const f=yield(0,O._)(o.frotaSaidaSrv.update(o.id,l));o.sendSaidaIdForAcompanhante=null==f?void 0:f.id}else{const f=yield(0,O._)(o.frotaSaidaSrv.save(l));o.sendSaidaIdForAcompanhante=null==f?void 0:f.id}}),function(){return r.apply(this,arguments)}),onAfterTryDismiss:()=>o.router.navigate([o.appRoutes.list.path]),onError:r=>console.error("Erro ao salvar:",r)}):console.log("Formul\xe1rio inv\xe1lido")})()}msgCloseForm(){var o=this;return(0,d.A)(function*(){const e=yield o.alertCtrl.create({header:"Sair do cadastro de rota",message:"Voc\xea tem certeza que quer sair do cadastro de rota? Ao sair, suas modifica\xe7\xf5es ser\xe3o perdidas!",buttons:[{text:"Continuar nesta Tela",role:"cancel"},{text:"Sair",handler:()=>o.router.navigate(["/home"])}]});o.form.dirty?yield e.present():o.router.navigate(["/home"])})()}ngOnDestroy(){var o;null===(o=this.routeSubscription)||void 0===o||o.unsubscribe()}}return(n=i).\u0275fac=function(o){return new(o||n)(t.rXU(h.ok),t.rXU(Jt.g),t.rXU(s.Xi),t.rXU(s.hG),t.rXU(w.Ix),t.rXU(w.nX),t.rXU(Kt.w),t.rXU(Q._),t.rXU(zt))},n.\u0275cmp=t.VBU({type:n,selectors:[["app-form"]],standalone:!0,features:[t.aNF],decls:19,vars:6,consts:[[3,"translucent"],["color","primary"],["slot","start"],["color","light",3,"click"],["slot","end"],[3,"fullscreen"],[1,"box-content"],[1,"ion-justify-content-center","ion-align-items-center"],["size","auto"],["alt","Foto de perfil",3,"src"],[4,"ngIf"],[3,"dataCard","kmRetornoControl","dataRetornoControl","tipoAcompanhanteRetorno","saveAcompanhanteFrota"],[3,"formGroup"],[3,"control"],["position","floating"],["type","number","formControlName","quilometragemNaSaida"],["formControlName","obs"],[3,"tipoAcompanhanteRetorno","saveAcompanhanteFrota","idFrota"],[3,"control","withoutRoutesOpen"]],template:function(o,e){1&o&&(t.j41(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-buttons",2)(3,"ion-button",3),t.bIt("click",function(){return e.msgCloseForm()}),t.EFF(4,"Sair"),t.k0s()(),t.j41(5,"ion-title"),t.EFF(6),t.k0s(),t.j41(7,"ion-buttons",4)(8,"ion-button",3),t.bIt("click",function(){return e.onSubmit()}),t.EFF(9,"Salvar"),t.k0s()()()(),t.j41(10,"ion-content",5)(11,"div",6)(12,"ion-grid")(13,"ion-row",7)(14,"ion-col",8)(15,"ion-avatar"),t.nrm(16,"img",9),t.k0s()()()(),t.DNE(17,Qt,2,5,"ng-container",10)(18,ee,18,9,"ng-container",10),t.k0s()()),2&o&&(t.Y8G("translucent",!0),t.R7$(6),t.JRh(e.isClose?"Finalizar percurso":e.id?"Editar percurso":"Iniciar percurso"),t.R7$(4),t.Y8G("fullscreen",!0),t.R7$(6),t.Y8G("src",e.srcFotoMotorista,t.B4B),t.R7$(),t.Y8G("ngIf",e.isClose&&!!e.dataSharedCard),t.R7$(),t.Y8G("ngIf",!e.isClose))},dependencies:[F.MD,F.bT,s.bv,s.mC,s.Jm,s.QW,s.hU,s.W9,s.lO,s.eU,s.$w,s.uz,s.he,s.ln,s.nc,s.BC,s.ai,s.su,s.Gw,w.iI,h.X1,h.BC,h.cb,h.j4,h.JD,ft,_t,Pt,M,Ut,h.YN,qt],styles:["[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .box-content[_ngcontent-%COMP%]{display:block;max-width:800px;margin:0 auto}[_nghost-%COMP%]   ion-avatar[_ngcontent-%COMP%]{height:200px;width:200px}[_nghost-%COMP%]   ion-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{object-fit:contain}"]}),i})()},3207:(Et,et,C)=>{C.d(et,{s:()=>F});var d=C(9350);function F(h,w){const s="object"==typeof w;return new Promise((t,O)=>{let G,j=!1;h.subscribe({next:B=>{G=B,j=!0},error:O,complete:()=>{j?t(G):s?t(w.defaultValue):O(new d.G)}})})}}}]);