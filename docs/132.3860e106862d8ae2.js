"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[132],{580:(q,D,g)=>{g.d(D,{k:()=>I});const I=(0,g(5083).F3)("CameraPreview",{web:()=>g.e(2606).then(g.bind(g,2606)).then(R=>new R.CameraPreviewWeb)})},5083:(q,D,g)=>{g.d(D,{E_:()=>Y,F3:()=>B,I9:()=>E});var d=g(467);typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"&&global;var O=function(r){return r.Unimplemented="UNIMPLEMENTED",r.Unavailable="UNAVAILABLE",r}(O||{});class E extends Error{constructor(e,t,l){super(e),this.message=e,this.code=t,this.data=l}}const N=r=>{var e,t,l,u,a;const b=r.CapacitorCustomPlatform||null,f=r.Capacitor||{},U=f.Plugins=f.Plugins||{},y=r.CapacitorPlatforms,z=(null===(e=null==y?void 0:y.currentPlatform)||void 0===e?void 0:e.getPlatform)||(()=>null!==b?b.name:(r=>{var e,t;return null!=r&&r.androidBridge?"android":null!==(t=null===(e=null==r?void 0:r.webkit)||void 0===e?void 0:e.messageHandlers)&&void 0!==t&&t.bridge?"ios":"web"})(r)),de=(null===(t=null==y?void 0:y.currentPlatform)||void 0===t?void 0:t.isNativePlatform)||(()=>"web"!==z()),fe=(null===(l=null==y?void 0:y.currentPlatform)||void 0===l?void 0:l.isPluginAvailable)||(w=>{const C=re.get(w);return!!(null!=C&&C.platforms.has(z())||se(w))}),se=(null===(u=null==y?void 0:y.currentPlatform)||void 0===u?void 0:u.getPluginHeader)||(w=>{var C;return null===(C=f.PluginHeaders)||void 0===C?void 0:C.find(J=>J.name===w)}),re=new Map,ve=(null===(a=null==y?void 0:y.currentPlatform)||void 0===a?void 0:a.registerPlugin)||((w,C={})=>{const J=re.get(w);if(J)return console.warn(`Capacitor plugin "${w}" already registered. Cannot register plugins twice.`),J.proxy;const H=z(),X=se(w);let $;const be=function(){var A=(0,d.A)(function*(){return!$&&H in C?$=$="function"==typeof C[H]?yield C[H]():C[H]:null!==b&&!$&&"web"in C&&($=$="function"==typeof C.web?yield C.web():C.web),$});return function(){return A.apply(this,arguments)}}(),ne=A=>{let x;const k=(...j)=>{const W=be().then(T=>{const V=((A,x)=>{var k,j;if(!X){if(A)return null===(j=A[x])||void 0===j?void 0:j.bind(A);throw new E(`"${w}" plugin is not implemented on ${H}`,O.Unimplemented)}{const W=null==X?void 0:X.methods.find(T=>x===T.name);if(W)return"promise"===W.rtype?T=>f.nativePromise(w,x.toString(),T):(T,V)=>f.nativeCallback(w,x.toString(),T,V);if(A)return null===(k=A[x])||void 0===k?void 0:k.bind(A)}})(T,A);if(V){const ee=V(...j);return x=null==ee?void 0:ee.remove,ee}throw new E(`"${w}.${A}()" is not implemented on ${H}`,O.Unimplemented)});return"addListener"===A&&(W.remove=(0,d.A)(function*(){return x()})),W};return k.toString=()=>`${A.toString()}() { [capacitor code] }`,Object.defineProperty(k,"name",{value:A,writable:!1,configurable:!1}),k},ce=ne("addListener"),le=ne("removeListener"),Pe=(A,x)=>{const k=ce({eventName:A},x),j=function(){var T=(0,d.A)(function*(){const V=yield k;le({eventName:A,callbackId:V},x)});return function(){return T.apply(this,arguments)}}(),W=new Promise(T=>k.then(()=>T({remove:j})));return W.remove=(0,d.A)(function*(){console.warn("Using addListener() without 'await' is deprecated."),yield j()}),W},oe=new Proxy({},{get(A,x){switch(x){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return X?Pe:ce;case"removeListener":return le;default:return ne(x)}}});return U[w]=oe,re.set(w,{name:w,proxy:oe,platforms:new Set([...Object.keys(C),...X?[H]:[]])}),oe});return f.convertFileSrc||(f.convertFileSrc=w=>w),f.getPlatform=z,f.handleError=w=>r.console.error(w),f.isNativePlatform=de,f.isPluginAvailable=fe,f.pluginMethodNoop=(w,C,J)=>Promise.reject(`${J} does not have an implementation of "${C}".`),f.registerPlugin=ve,f.Exception=E,f.DEBUG=!!f.DEBUG,f.isLoggingEnabled=!!f.isLoggingEnabled,f.platform=f.getPlatform(),f.isNative=f.isNativePlatform(),f},K=(r=>r.Capacitor=N(r))(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),B=K.registerPlugin;class Y{constructor(e){this.listeners={},this.retainedEventArguments={},this.windowListeners={},e&&(console.warn(`Capacitor WebPlugin "${e.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=e)}addListener(e,t){var l=this;let u=!1;this.listeners[e]||(this.listeners[e]=[],u=!0),this.listeners[e].push(t);const b=this.windowListeners[e];b&&!b.registered&&this.addWindowListener(b),u&&this.sendRetainedArgumentsForEvent(e);const f=function(){var y=(0,d.A)(function*(){return l.removeListener(e,t)});return function(){return y.apply(this,arguments)}}();return Promise.resolve({remove:f})}removeAllListeners(){var e=this;return(0,d.A)(function*(){e.listeners={};for(const t in e.windowListeners)e.removeWindowListener(e.windowListeners[t]);e.windowListeners={}})()}notifyListeners(e,t,l){const u=this.listeners[e];if(u)u.forEach(a=>a(t));else if(l){let a=this.retainedEventArguments[e];a||(a=[]),a.push(t),this.retainedEventArguments[e]=a}}hasListeners(e){return!!this.listeners[e].length}registerWindowListener(e,t){this.windowListeners[t]={registered:!1,windowEventName:e,pluginEventName:t,handler:l=>{this.notifyListeners(t,l)}}}unimplemented(e="not implemented"){return new K.Exception(e,O.Unimplemented)}unavailable(e="not available"){return new K.Exception(e,O.Unavailable)}removeListener(e,t){var l=this;return(0,d.A)(function*(){const u=l.listeners[e];if(!u)return;const a=u.indexOf(t);l.listeners[e].splice(a,1),l.listeners[e].length||l.removeWindowListener(l.windowListeners[e])})()}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const t=this.retainedEventArguments[e];t&&(delete this.retainedEventArguments[e],t.forEach(l=>{this.notifyListeners(e,l)}))}}const s=r=>encodeURIComponent(r).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),v=r=>r.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class o extends Y{getCookies(){return(0,d.A)(function*(){const e=document.cookie,t={};return e.split(";").forEach(l=>{if(l.length<=0)return;let[u,a]=l.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");u=v(u).trim(),a=v(a).trim(),t[u]=a}),t})()}setCookie(e){return(0,d.A)(function*(){try{const t=s(e.key),l=s(e.value),u=`; expires=${(e.expires||"").replace("expires=","")}`,a=(e.path||"/").replace("path=",""),b=null!=e.url&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${t}=${l||""}${u}; path=${a}; ${b};`}catch(t){return Promise.reject(t)}})()}deleteCookie(e){return(0,d.A)(function*(){try{document.cookie=`${e.key}=; Max-Age=0`}catch(t){return Promise.reject(t)}})()}clearCookies(){return(0,d.A)(function*(){try{const e=document.cookie.split(";")||[];for(const t of e)document.cookie=t.replace(/^ +/,"").replace(/=.*/,`=;expires=${(new Date).toUTCString()};path=/`)}catch(e){return Promise.reject(e)}})()}clearAllCookies(){var e=this;return(0,d.A)(function*(){try{yield e.clearCookies()}catch(t){return Promise.reject(t)}})()}}B("CapacitorCookies",{web:()=>new o});const c=function(){var r=(0,d.A)(function*(e){return new Promise((t,l)=>{const u=new FileReader;u.onload=()=>{const a=u.result;t(a.indexOf(",")>=0?a.split(",")[1]:a)},u.onerror=a=>l(a),u.readAsDataURL(e)})});return function(t){return r.apply(this,arguments)}}();class P extends Y{request(e){return(0,d.A)(function*(){const t=((r,e={})=>{const t=Object.assign({method:r.method||"GET",headers:r.headers},e),u=((r={})=>{const e=Object.keys(r);return Object.keys(r).map(u=>u.toLocaleLowerCase()).reduce((u,a,b)=>(u[a]=r[e[b]],u),{})})(r.headers)["content-type"]||"";if("string"==typeof r.data)t.body=r.data;else if(u.includes("application/x-www-form-urlencoded")){const a=new URLSearchParams;for(const[b,f]of Object.entries(r.data||{}))a.set(b,f);t.body=a.toString()}else if(u.includes("multipart/form-data")||r.data instanceof FormData){const a=new FormData;if(r.data instanceof FormData)r.data.forEach((f,U)=>{a.append(U,f)});else for(const f of Object.keys(r.data))a.append(f,r.data[f]);t.body=a;const b=new Headers(t.headers);b.delete("content-type"),t.headers=b}else(u.includes("application/json")||"object"==typeof r.data)&&(t.body=JSON.stringify(r.data));return t})(e,e.webFetchExtra),l=((r,e=!0)=>r?Object.entries(r).reduce((l,u)=>{const[a,b]=u;let f,U;return Array.isArray(b)?(U="",b.forEach(y=>{f=e?encodeURIComponent(y):y,U+=`${a}=${f}&`}),U.slice(0,-1)):(f=e?encodeURIComponent(b):b,U=`${a}=${f}`),`${l}&${U}`},"").substr(1):null)(e.params,e.shouldEncodeUrlParams),u=l?`${e.url}?${l}`:e.url,a=yield fetch(u,t),b=a.headers.get("content-type")||"";let U,y,{responseType:f="text"}=a.ok?e:{};switch(b.includes("application/json")&&(f="json"),f){case"arraybuffer":case"blob":y=yield a.blob(),U=yield c(y);break;case"json":U=yield a.json();break;default:U=yield a.text()}const Z={};return a.headers.forEach((z,te)=>{Z[te]=z}),{data:U,headers:Z,status:a.status,url:a.url}})()}get(e){var t=this;return(0,d.A)(function*(){return t.request(Object.assign(Object.assign({},e),{method:"GET"}))})()}post(e){var t=this;return(0,d.A)(function*(){return t.request(Object.assign(Object.assign({},e),{method:"POST"}))})()}put(e){var t=this;return(0,d.A)(function*(){return t.request(Object.assign(Object.assign({},e),{method:"PUT"}))})()}patch(e){var t=this;return(0,d.A)(function*(){return t.request(Object.assign(Object.assign({},e),{method:"PATCH"}))})()}delete(e){var t=this;return(0,d.A)(function*(){return t.request(Object.assign(Object.assign({},e),{method:"DELETE"}))})()}}B("CapacitorHttp",{web:()=>new P})},132:(q,D,g)=>{g.d(D,{r:()=>Y});var d=g(467),I=g(580),R=g(4843),_=g(4438),G=g(9769),L=g(5083),F=function(h){return h.Prompt="PROMPT",h.Camera="CAMERA",h.Photos="PHOTOS",h}(F||{}),O=function(h){return h.Rear="REAR",h.Front="FRONT",h}(O||{}),E=function(h){return h.Uri="uri",h.Base64="base64",h.DataUrl="dataUrl",h}(E||{});class M extends L.E_{getPhoto(s){var v=this;return(0,d.A)(function*(){return new Promise(function(){var o=(0,d.A)(function*(n,c){if(s.webUseInput||s.source===F.Photos)v.fileInputExperience(s,n,c);else if(s.source===F.Prompt){let i=document.querySelector("pwa-action-sheet");i||(i=document.createElement("pwa-action-sheet"),document.body.appendChild(i)),i.header=s.promptLabelHeader||"Photo",i.cancelable=!1,i.options=[{title:s.promptLabelPhoto||"From Photos"},{title:s.promptLabelPicture||"Take Picture"}],i.addEventListener("onSelection",function(){var m=(0,d.A)(function*(p){0===p.detail?v.fileInputExperience(s,n,c):v.cameraExperience(s,n,c)});return function(p){return m.apply(this,arguments)}}())}else v.cameraExperience(s,n,c)});return function(n,c){return o.apply(this,arguments)}}())})()}pickImages(s){var v=this;return(0,d.A)(function*(){return new Promise(function(){var o=(0,d.A)(function*(n,c){v.multipleFileInputExperience(n,c)});return function(n,c){return o.apply(this,arguments)}}())})()}cameraExperience(s,v,o){var n=this;return(0,d.A)(function*(){if(customElements.get("pwa-camera-modal")){const c=document.createElement("pwa-camera-modal");c.facingMode=s.direction===O.Front?"user":"environment",document.body.appendChild(c);try{yield c.componentOnReady(),c.addEventListener("onPhoto",function(){var i=(0,d.A)(function*(m){const p=m.detail;null===p?o(new L.I9("User cancelled photos app")):p instanceof Error?o(p):v(yield n._getCameraPhoto(p,s)),c.dismiss(),document.body.removeChild(c)});return function(m){return i.apply(this,arguments)}}()),c.present()}catch{n.fileInputExperience(s,v,o)}}else console.error("Unable to load PWA Element 'pwa-camera-modal'. See the docs: https://capacitorjs.com/docs/web/pwa-elements."),n.fileInputExperience(s,v,o)})()}fileInputExperience(s,v,o){let n=document.querySelector("#_capacitor-camera-input");const c=()=>{var i;null===(i=n.parentNode)||void 0===i||i.removeChild(n)};n||(n=document.createElement("input"),n.id="_capacitor-camera-input",n.type="file",n.hidden=!0,document.body.appendChild(n),n.addEventListener("change",i=>{const m=n.files[0];let p="jpeg";if("image/png"===m.type?p="png":"image/gif"===m.type&&(p="gif"),"dataUrl"===s.resultType||"base64"===s.resultType){const P=new FileReader;P.addEventListener("load",()=>{if("dataUrl"===s.resultType)v({dataUrl:P.result,format:p});else if("base64"===s.resultType){const S=P.result.split(",")[1];v({base64String:S,format:p})}c()}),P.readAsDataURL(m)}else v({webPath:URL.createObjectURL(m),format:p}),c()}),n.addEventListener("cancel",i=>{o(new L.I9("User cancelled photos app")),c()})),n.accept="image/*",n.capture=!0,s.source===F.Photos||s.source===F.Prompt?n.removeAttribute("capture"):s.direction===O.Front?n.capture="user":s.direction===O.Rear&&(n.capture="environment"),n.click()}multipleFileInputExperience(s,v){let o=document.querySelector("#_capacitor-camera-input-multiple");const n=()=>{var c;null===(c=o.parentNode)||void 0===c||c.removeChild(o)};o||(o=document.createElement("input"),o.id="_capacitor-camera-input-multiple",o.type="file",o.hidden=!0,o.multiple=!0,document.body.appendChild(o),o.addEventListener("change",c=>{const i=[];for(let m=0;m<o.files.length;m++){const p=o.files[m];let P="jpeg";"image/png"===p.type?P="png":"image/gif"===p.type&&(P="gif"),i.push({webPath:URL.createObjectURL(p),format:P})}s({photos:i}),n()}),o.addEventListener("cancel",c=>{v(new L.I9("User cancelled photos app")),n()})),o.accept="image/*",o.click()}_getCameraPhoto(s,v){return new Promise((o,n)=>{const c=new FileReader,i=s.type.split("/")[1];"uri"===v.resultType?o({webPath:URL.createObjectURL(s),format:i,saved:!1}):(c.readAsDataURL(s),c.onloadend=()=>{const m=c.result;o("dataUrl"===v.resultType?{dataUrl:m,format:i,saved:!1}:{base64String:m.split(",")[1],format:i,saved:!1})},c.onerror=m=>{n(m)})})}checkPermissions(){var s=this;return(0,d.A)(function*(){if(typeof navigator>"u"||!navigator.permissions)throw s.unavailable("Permissions API not available in this browser");try{return{camera:(yield window.navigator.permissions.query({name:"camera"})).state,photos:"granted"}}catch{throw s.unavailable("Camera permissions are not available in this browser")}})()}requestPermissions(){var s=this;return(0,d.A)(function*(){throw s.unimplemented("Not implemented on web.")})()}pickLimitedLibraryPhotos(){var s=this;return(0,d.A)(function*(){throw s.unavailable("Not implemented on web.")})()}getLimitedLibraryPhotos(){var s=this;return(0,d.A)(function*(){throw s.unavailable("Not implemented on web.")})()}}new M;const Q=(0,L.F3)("Camera",{web:()=>new M});var K=g(8880),B=g(4742);let ie=(()=>{var h;class s{constructor(o,n){this.navCtrl=o,this.alertCtrl=n}getCamera(o=!0,n=!1){var c=this;return(0,d.A)(function*(){if(typeof navigator<"u"&&navigator.permissions){const i=yield Q.checkPermissions();(!i.camera||!i.photos)&&(yield Q.requestPermissions({permissions:["photos","camera"]}))}try{return yield Q.getPhoto({quality:70,allowEditing:!1,direction:O.Rear,source:F.Camera,resultType:o?E.DataUrl:E.Uri,width:800,height:800,correctOrientation:!0})}catch(i){throw n&&c.navCtrl.back({animated:!1}),new Error(i.message)}})()}getBlob(o){return new Promise((n,c)=>{const i=new XMLHttpRequest;i.onload=()=>{n(i.response)},i.onerror=()=>{c(new Error("uriToBlob failed"))},i.responseType="blob",i.open("GET",o,!0),i.send(null)})}}return(h=s).\u0275fac=function(o){return new(o||h)(_.KVO(K.q9),_.KVO(B.hG))},h.\u0275prov=_.jDH({token:h,factory:h.\u0275fac,providedIn:"root"}),s})();var ae=g(4401);let Y=(()=>{var h;class s{constructor(o,n,c,i,m){this.api=o,this.cameraService=n,this.alertCtrl=c,this.faceService=i,this.loadingCtrl=m,this.fotos=[]}hashEncode(o){return btoa(String.fromCharCode(...new Uint8Array(o.buffer)))}hashDecode(o){return new Float32Array(new Uint8Array([...atob(o)].map(n=>n.charCodeAt(0))).buffer)}takePhoto(o){var n=this;return(0,d.A)(function*(){const c=yield n.loadingCtrl.create();try{const i=yield n.cameraService.getCamera(!0);yield c.present();const m=yield n.faceService.getFaceCrop(i.dataUrl);if(yield c.dismiss(),m.face){console.log("TAKE FOTO",{face:m});const S={hash:n.hashEncode(m.descriptor),funcionario:o,base64:i.dataUrl};console.log({identificacao:S});const r=yield(0,R._)(n.api.save(S));return console.log({result:r}),!0}return!1}catch(i){console.log({error:i}),yield c.dismiss()}return!1})()}previewCamera(o){var n=this;return new Promise(function(){var c=(0,d.A)(function*(i,m){try{let p;console.log("\u{1f535} Iniciando preview da c\xe2mera..."),p=o?{position:o,className:"camera-preview",parent:"content"}:{position:"front",className:"camera-preview",parent:"content"},console.log("\u{1f4f7} Configura\xe7\xf5es da c\xe2mera:",p),yield I.k.start(p),console.log("\u2705 C\xe2mera iniciada com sucesso!");const P=yield n.loadingCtrl.create({spinner:null,message:"Foto em: 3s",showBackdrop:!1,translucent:!0});console.log("\u23f3 Loader criado..."),yield P.present(),console.log("\u2705 Loader exibido"),setTimeout((0,d.A)(function*(){console.log("\u23f3 Mudando mensagem do loader: Foto em 2s"),P.message="Foto em: 2s"}),1e3),setTimeout((0,d.A)(function*(){console.log("\u23f3 Mudando mensagem do loader: Foto em 1s"),P.message="Foto em: 1s"}),2e3),setTimeout((0,d.A)(function*(){console.log("\u{1f534} Capturando imagem..."),yield P.dismiss(),console.log("\u2705 Loader fechado");try{const S=yield I.k.captureSample({});console.log("\u{1f4f8} Foto capturada com sucesso!",S),I.k.stop(),console.log("\u{1f6d1} C\xe2mera parada"),i(S.value)}catch(S){console.error("\u274c Erro ao capturar imagem:",S),m(S)}}),3e3)}catch(p){console.error("\u274c Erro ao iniciar preview da c\xe2mera:",p),I.k.stop(),m(p)}});return function(i,m){return c.apply(this,arguments)}}())}scan(o){var n=this;return(0,d.A)(function*(){const c=yield n.loadingCtrl.create();try{yield c.present();const i=yield n.previewCamera(o);if(console.log("Preview Camera Data:",i),!i)throw new Error("Falha ao capturar imagem da c\xe2mera");const m=yield n.faceService.getFaceCrop(`data:image/jpeg;base64,${i}`);if(console.log("Face Crop Result:",m),yield c.dismiss(),null==m||!m.face)return I.k.stop(),!1;const p=yield n.loadingCtrl.create();yield p.present();let P=null;const S=yield(0,R._)(n.api.getAll());console.log("IDs recuperados:",S);const r=S.map(e=>{try{const t=n.hashDecode(null==e?void 0:e.hash);return t.length>0?{descriptor:t,funcionario:e.funcionario}:{descriptor:!1,funcionario:e.funcionario}}catch(t){return console.error("Erro ao decodificar hash:",t),{descriptor:!1,funcionario:e.funcionario}}});console.log("Quantidade de fotos:",null==r?void 0:r.length);for(const[e,t]of r.entries()){if(!t.descriptor)continue;console.log("Verificando foto:",e);const l=yield n.faceService.matchDescriptors(t.descriptor,m.descriptor);if(console.log("Match Ratio:",l),l<.5){console.log("Match encontrado:",e),P=t.funcionario;break}}return yield p.dismiss(),!!P&&{funcionario:P,face:m.face}}catch(i){return console.error("Erro durante o scan:",i),!1}finally{yield c.dismiss()}})()}}return(h=s).\u0275fac=function(o){return new(o||h)(_.KVO(G._),_.KVO(ie),_.KVO(B.hG),_.KVO(ae.R),_.KVO(B.Xi))},h.\u0275prov=_.jDH({token:h,factory:h.\u0275fac,providedIn:"root"}),s})()},9769:(q,D,g)=>{g.d(D,{_:()=>G});var d=g(467),I=g(3207),R=g(4438),_=g(9684);let G=(()=>{var L;class F{constructor(E){this.baseApiService=E,this.endpoint="api/IdentificacaoFuncionario"}getImage(E){var M=this;return(0,d.A)(function*(){const N=yield(0,I.s)(M.baseApiService.get(`${M.endpoint}/GetImageFunc/${E}`,void 0,"blob"));return N?URL.createObjectURL(N):null})()}getAll(){return this.baseApiService.get(`${this.endpoint}/GetAll`)}save(E){return this.baseApiService.post(`${this.endpoint}/Save`,E)}}return(L=F).\u0275fac=function(E){return new(E||L)(R.KVO(_.v))},L.\u0275prov=R.jDH({token:L,factory:L.\u0275fac,providedIn:"root"}),F})()},3207:(q,D,g)=>{g.d(D,{s:()=>I});var d=g(9350);function I(R,_){const G="object"==typeof _;return new Promise((L,F)=>{let E,O=!1;R.subscribe({next:M=>{E=M,O=!0},error:F,complete:()=>{O?L(E):G?L(_.defaultValue):F(new d.G)}})})}}}]);