"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6527],{6527:(Y,h,s)=>{s.r(h),s.d(h,{ListPage:()=>X});var d=s(467),p=s(177),u=s(4341),m=s(2902),l=s(4742),v=s(5079),f=s(5873),F=s(5964),g=s(4843),b=s(8663),t=s(4438);function I(n,r){if(1&n){const i=t.RV6();t.j41(0,"ion-item",3),t.bIt("click",function(){const e=t.eBV(i).$implicit,a=t.XpG(3);return t.Njj(a.selectItem(e))}),t.EFF(1),t.k0s()}if(2&n){const i=r.$implicit,o=t.XpG(3);t.R7$(),t.SpI(" ",i[o.labelKey]," ")}}function j(n,r){if(1&n&&(t.j41(0,"ion-list"),t.DNE(1,I,2,1,"ion-item",6),t.nI1(2,"slice"),t.k0s()),2&n){const i=t.XpG(2);t.R7$(),t.Y8G("ngForOf",t.brH(2,1,i.filteredItems,0,5))}}function P(n,r){1&n&&(t.j41(0,"ion-text"),t.EFF(1," Nenhum resultado encontrado. "),t.k0s())}function S(n,r){if(1&n){const i=t.RV6();t.j41(0,"ion-content",1)(1,"ion-header")(2,"ion-toolbar")(3,"ion-buttons",2)(4,"ion-button",3),t.bIt("click",function(){t.eBV(i);const e=t.XpG();return t.Njj(e.closePopover())}),t.EFF(5,"Voltar"),t.k0s()()()(),t.j41(6,"ion-searchbar",4),t.mxI("ngModelChange",function(e){t.eBV(i);const a=t.XpG();return t.DH7(a.searchQuery,e)||(a.searchQuery=e),t.Njj(e)}),t.bIt("ionInput",function(){t.eBV(i);const e=t.XpG();return t.Njj(e.filterItems())}),t.k0s(),t.DNE(7,j,3,5,"ion-list",5)(8,P,2,0,"ion-text",5),t.k0s()}if(2&n){const i=t.XpG();t.R7$(6),t.R50("ngModel",i.searchQuery),t.R7$(),t.Y8G("ngIf",i.filteredItems.length>0),t.R7$(),t.Y8G("ngIf",0===i.filteredItems.length&&i.searchQuery)}}let k=(()=>{var n;class r{constructor(){this.isPopoverOpen=!1,this.items=[],this.label="",this.placeholder="Buscar",this.itemSelected=new t.bkB,this.popoverClosed=new t.bkB,this.itemSelectedView=null,this.searchQuery="",this.filteredItems=[]}filterItems(){const o=this.searchQuery.toLowerCase();this.filteredItems=this.items.filter(e=>{var a;return null===(a=e[this.labelKey])||void 0===a?void 0:a.toLowerCase().includes(o)})}selectItem(o){this.itemSelected.emit(o),this.itemSelectedView=o,this.searchQuery="",this.filteredItems=[],this.closePopover()}closePopover(){this.popoverClosed.emit()}removeItem(){this.itemSelected.emit(null),this.itemSelectedView=null}}return(n=r).\u0275fac=function(o){return new(o||n)},n.\u0275cmp=t.VBU({type:n,selectors:[["app-searchable-filter"]],inputs:{isPopoverOpen:"isPopoverOpen",popoverEvent:"popoverEvent",items:"items",labelKey:"labelKey",label:"label",placeholder:"placeholder"},outputs:{itemSelected:"itemSelected",popoverClosed:"popoverClosed"},standalone:!0,features:[t.aNF],decls:2,vars:2,consts:[["showBackdrop","true","backdropDismiss","false",3,"ionDidDismiss","isOpen","event"],[1,"popover-content"],["slot","start"],[3,"click"],["placeholder","Buscar Motorista",3,"ngModelChange","ionInput","ngModel"],[4,"ngIf"],[3,"click",4,"ngFor","ngForOf"]],template:function(o,e){1&o&&(t.j41(0,"ion-popover",0),t.bIt("ionDidDismiss",function(){return e.isPopoverOpen=!1}),t.DNE(1,S,9,3,"ng-template"),t.k0s()),2&o&&t.Y8G("isOpen",e.isPopoverOpen)("event",e.popoverEvent)},dependencies:[p.MD,p.Sq,p.bT,p.P9,l.bv,l.Jm,l.QW,l.W9,l.eU,l.uz,l.nf,l.S1,l.IO,l.ai,l.CF,l.Gw,u.YN,u.BC,u.vS]}),r})();var D=s(5784),y=s(9457),C=s(7106),G=s(2705);const A=["modalFiltro"];function R(n,r){if(1&n){const i=t.RV6();t.j41(0,"ion-button",19),t.bIt("click",function(){t.eBV(i);const e=t.XpG(2);return t.Njj(e.clearFilterByProperty("motoristaId"))}),t.EFF(1),t.nrm(2,"ion-icon",20),t.k0s()}if(2&n){const i=t.XpG(2);t.Y8G("fill","outline"),t.R7$(),t.SpI(" Motorista: ",i.getPropById(i.filtroAtual.motoristaId,i.allMotoristas,"name")," ")}}function T(n,r){if(1&n){const i=t.RV6();t.j41(0,"ion-button",19),t.bIt("click",function(){t.eBV(i);const e=t.XpG(2);return t.Njj(e.clearFilterByProperty("veiculoId"))}),t.EFF(1),t.nrm(2,"ion-icon",20),t.k0s()}if(2&n){const i=t.XpG(2);t.Y8G("fill","outline"),t.R7$(),t.SpI(" Ve\xedculo: ",i.getPropById(i.filtroAtual.veiculoId,i.allVeiculos,"descricao")," ")}}function x(n,r){if(1&n){const i=t.RV6();t.j41(0,"ion-button",19),t.bIt("click",function(){t.eBV(i);const e=t.XpG(2);return t.Njj(e.clearFilterByProperty("status"))}),t.EFF(1),t.nrm(2,"ion-icon",20),t.k0s()}if(2&n){const i=t.XpG(2);t.Y8G("fill","outline"),t.R7$(),t.SpI(" Status: ",i.getTipo(i.filtroAtual.status)," ")}}function E(n,r){if(1&n){const i=t.RV6();t.j41(0,"ion-button",19),t.bIt("click",function(){t.eBV(i);const e=t.XpG(2);return t.Njj(e.clearFilterByProperty("tipoDataFiltro"))}),t.EFF(1),t.nrm(2,"ion-icon",20),t.k0s()}if(2&n){const i=t.XpG(2);t.Y8G("fill","outline"),t.R7$(),t.SpI(" Tipo de Data: ",i.getTipoData(i.filtroAtual.tipoDataFiltro)," ")}}function M(n,r){if(1&n&&(t.j41(0,"div",17),t.DNE(1,R,3,2,"ion-button",18)(2,T,3,2,"ion-button",18)(3,x,3,2,"ion-button",18)(4,E,3,2,"ion-button",18),t.k0s()),2&n){const i=t.XpG();t.R7$(),t.Y8G("ngIf",i.filtroAtual.motoristaId),t.R7$(),t.Y8G("ngIf",i.filtroAtual.veiculoId),t.R7$(),t.Y8G("ngIf",i.filtroAtual.status),t.R7$(),t.Y8G("ngIf",i.filtroAtual.tipoDataFiltro)}}function V(n,r){1&n&&t.nrm(0,"app-card",21),2&n&&t.Y8G("data",r.$implicit)}function B(n,r){if(1&n&&(t.j41(0,"ion-select-option",27),t.EFF(1),t.k0s()),2&n){const i=r.$implicit;t.Y8G("value",i.id),t.R7$(),t.SpI(" ",i.descricao," ")}}function N(n,r){if(1&n){const i=t.RV6();t.j41(0,"ion-content")(1,"ion-datetime",37,1),t.bIt("ionChange",function(){t.eBV(i);const e=t.sdS(2),a=t.XpG(3);return t.Njj(a.filtroAtual.de=e.value)}),t.k0s()()}}function L(n,r){if(1&n){const i=t.RV6();t.j41(0,"ion-content")(1,"ion-datetime",37,2),t.bIt("ionChange",function(){t.eBV(i);const e=t.sdS(2),a=t.XpG(3);return t.Njj(a.filtroAtual.ate=e.value)}),t.k0s()()}}function O(n,r){if(1&n&&(t.qex(0),t.j41(1,"ion-item",33)(2,"ion-label"),t.EFF(3,"De"),t.k0s(),t.j41(4,"ion-text",8),t.EFF(5),t.nI1(6,"date"),t.k0s(),t.j41(7,"ion-modal",34),t.DNE(8,N,3,0,"ng-template"),t.k0s()(),t.j41(9,"ion-item",35)(10,"ion-label"),t.EFF(11,"At\xe9"),t.k0s(),t.j41(12,"ion-text",8),t.EFF(13),t.nI1(14,"date"),t.k0s(),t.j41(15,"ion-modal",36),t.DNE(16,L,3,0,"ng-template"),t.k0s()(),t.bVm()),2&n){const i=t.XpG(2);t.R7$(5),t.JRh(t.i5U(6,2,i.filtroAtual.de,"dd/MM/yyyy")),t.R7$(8),t.JRh(t.i5U(14,5,i.filtroAtual.ate,"dd/MM/yyyy"))}}function $(n,r){if(1&n){const i=t.RV6();t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),t.EFF(3,"Filtros"),t.k0s()()(),t.j41(4,"ion-content",22)(5,"ion-input",23),t.bIt("click",function(){t.eBV(i);const e=t.XpG();return t.Njj(e.isPopoverOpen=!0)}),t.k0s(),t.j41(6,"ion-select",24),t.mxI("ngModelChange",function(e){t.eBV(i);const a=t.XpG();return t.DH7(a.filtroAtual.veiculoId,e)||(a.filtroAtual.veiculoId=e),t.Njj(e)}),t.DNE(7,B,2,2,"ion-select-option",25),t.k0s(),t.j41(8,"ion-select",26),t.mxI("ngModelChange",function(e){t.eBV(i);const a=t.XpG();return t.DH7(a.filtroAtual.status,e)||(a.filtroAtual.status=e),t.Njj(e)}),t.nrm(9,"ion-select-option",27),t.j41(10,"ion-select-option",27),t.EFF(11,"Sa\xedda"),t.k0s(),t.j41(12,"ion-select-option",27),t.EFF(13,"Retorno"),t.k0s()(),t.j41(14,"div",28)(15,"ion-select",29),t.mxI("ngModelChange",function(e){t.eBV(i);const a=t.XpG();return t.DH7(a.filtroAtual.tipoDataFiltro,e)||(a.filtroAtual.tipoDataFiltro=e),t.Njj(e)}),t.nrm(16,"ion-select-option",27),t.j41(17,"ion-select-option",27),t.EFF(18,"Data de sa\xedda"),t.k0s(),t.j41(19,"ion-select-option",27),t.EFF(20,"Data de retorno"),t.k0s()(),t.DNE(21,O,17,8,"ng-container",30),t.k0s()(),t.j41(22,"ion-footer")(23,"ion-toolbar")(24,"ion-buttons",5)(25,"ion-button",31),t.bIt("click",function(){t.eBV(i);const e=t.XpG();return t.Njj(e.clearFilter())}),t.EFF(26,"Cancelar"),t.k0s()(),t.j41(27,"ion-buttons",8)(28,"ion-button",32),t.bIt("click",function(){t.eBV(i);const e=t.XpG();return t.Njj(e.filter())}),t.EFF(29,"Confirmar"),t.k0s()()()()}if(2&n){const i=t.XpG();t.R7$(5),t.Y8G("value",i.filtroAtual.motoristaId?i.getPropById(i.filtroAtual.motoristaId,i.allMotoristas,"name"):""),t.R7$(),t.R50("ngModel",i.filtroAtual.veiculoId),t.R7$(),t.Y8G("ngForOf",i.allVeiculos),t.R7$(),t.R50("ngModel",i.filtroAtual.status),t.R7$(),t.Y8G("value",-1),t.R7$(),t.Y8G("value",0),t.R7$(2),t.Y8G("value",1),t.R7$(3),t.R50("ngModel",i.filtroAtual.tipoDataFiltro),t.R7$(),t.Y8G("value",-1),t.R7$(),t.Y8G("value",0),t.R7$(2),t.Y8G("value",1),t.R7$(2),t.Y8G("ngIf",void 0!==i.filtroAtual.tipoDataFiltro&&-1!==i.filtroAtual.tipoDataFiltro)}}let X=(()=>{var n;class r{constructor(o,e,a,c,_){this.frotaSaidaService=o,this.frotaVeiculoService=e,this.funcionarioService=a,this.router=c,this.loadingCtrl=_,this.isPopoverOpen=!1,this.listaSaidaFrota=[],this.appRoutes=D.S,this.filtroAtual={motoristaId:void 0,veiculoId:void 0,status:void 0,tipoDataFiltro:void 0,de:void 0,ate:void 0},(0,v.a)({funnel:f.XNy,close:f.VNx,arrowBack:f.$$C})}ngOnInit(){var o=this;return(0,d.A)(function*(){o.routeSubscription=o.router.events.pipe((0,F.p)(e=>e instanceof m.wF)).subscribe((0,d.A)(function*(){const e=yield o.loadingCtrl.create();yield e.present(),yield o.loadData(),yield e.dismiss()}))})()}loadData(o){var e=this;return(0,d.A)(function*(){e.listaSaidaFrota=yield(0,g._)(e.frotaSaidaService.getAllBy({...o,limit:15})),e.allMotoristas=yield(0,g._)(e.funcionarioService.getAll()),e.allVeiculos=yield(0,g._)(e.frotaVeiculoService.getAll())})()}filter(){var o=this;return(0,d.A)(function*(){yield o.loadData(o.filtroAtual),o.modal.dismiss()})()}clearFilter(){this.filtroAtual={motoristaId:void 0,veiculoId:void 0,status:void 0,tipoDataFiltro:void 0,de:void 0,ate:void 0},this.filter()}clearFilterByProperty(o){this.filtroAtual[o]=void 0,this.filter()}getPropById(o,e,a){const c=null==e?void 0:e.find(_=>_.id===o);return c?c[a]:"N\xe3o encontrado"}loadMore(o){this.frotaSaidaService.getAllBy({...this.filtroAtual,limit:15,offset:this.listaSaidaFrota.length}).subscribe(e=>{this.listaSaidaFrota=[...this.listaSaidaFrota,...e],this.listaSaidaFrota.sort((a,c)=>new Date(c.dataHoraSaida).getTime()-new Date(a.dataHoraSaida).getTime()),o.target.complete(),e.length<this.listaSaidaFrota.length&&(o.target.disabled=!0)})}selectedMotorista(o){this.filtroAtual.motoristaId=o?o.id:void 0}openPopover(o){this.popoverEvent=o,this.isPopoverOpen=!0}getTipo(o){return 0===o?"SA\xcdDA":1===o?"RETORNO":""}getTipoData(o){return 0===o?"DATA DE SA\xcdDA":1===o?"DATA DE RETORNO":""}}return(n=r).\u0275fac=function(o){return new(o||n)(t.rXU(y.g),t.rXU(C.T),t.rXU(G.r),t.rXU(m.Ix),t.rXU(l.Xi))},n.\u0275cmp=t.VBU({type:n,selectors:[["app-list"]],viewQuery:function(o,e){if(1&o&&t.GBs(A,5),2&o){let a;t.mGM(a=t.lsd())&&(e.modal=a.first)}},standalone:!0,features:[t.aNF],decls:21,vars:8,consts:[["modalFiltro",""],["popoverDatetimeDe",""],["popoverDatetimeAte",""],[3,"translucent"],["color","primary"],["slot","start"],[3,"routerLink"],["slot","icon-only","name","arrow-back","color","light"],["slot","end"],["id","open-modal"],["slot","icon-only","name","funnel","color","light"],[3,"fullscreen"],["class","ion-text-center ion-padding",4,"ngIf"],[3,"data",4,"ngFor","ngForOf"],[3,"ionInfinite"],["trigger","open-modal"],["label","Motorista","labelKey","name",1,"ion-padding",3,"itemSelected","popoverClosed","isPopoverOpen","popoverEvent","items"],[1,"ion-text-center","ion-padding"],[3,"fill","click",4,"ngIf"],[3,"click","fill"],["slot","end","name","close"],[3,"data"],[1,"ion-padding"],["label","Motorista","labelPlacement","stacked","fill","outline","readonly","",3,"click","value"],["label","Ve\xedculo","labelPlacement","stacked","fill","outline",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["label","Status","labelPlacement","stacked","fill","outline",3,"ngModelChange","ngModel"],[3,"value"],[1,"filtro-data"],["label","Filtrar data por","labelPlacement","stacked","fill","outline",3,"ngModelChange","ngModel"],[4,"ngIf"],["color","danger",3,"click"],["color","primary",3,"click"],["button","true","id","open-datetime-de"],["trigger","open-datetime-de",1,"de-datetime"],["button","true","id","open-datetime-ate"],["trigger","open-datetime-ate",1,"de-datetime"],["size","cover","presentation","date",3,"ionChange"]],template:function(o,e){if(1&o){const a=t.RV6();t.j41(0,"ion-header",3)(1,"ion-toolbar",4)(2,"ion-buttons",5)(3,"ion-button",6),t.nrm(4,"ion-icon",7),t.k0s()(),t.j41(5,"ion-title"),t.EFF(6,"Consultar percursos"),t.k0s(),t.j41(7,"ion-buttons",8)(8,"ion-button",9),t.nrm(9,"ion-icon",10),t.k0s()()()(),t.j41(10,"ion-content",11),t.DNE(11,M,5,4,"div",12),t.j41(12,"div")(13,"ion-list"),t.DNE(14,V,1,1,"app-card",13),t.k0s(),t.j41(15,"ion-infinite-scroll",14),t.bIt("ionInfinite",function(_){return t.eBV(a),t.Njj(e.loadMore(_))}),t.nrm(16,"ion-infinite-scroll-content"),t.k0s()(),t.j41(17,"ion-modal",15,0),t.DNE(19,$,30,12,"ng-template"),t.k0s()(),t.j41(20,"app-searchable-filter",16),t.bIt("itemSelected",function(_){return t.eBV(a),t.Njj(e.selectedMotorista(_))})("popoverClosed",function(){return t.eBV(a),t.Njj(e.isPopoverOpen=!1)}),t.k0s()}2&o&&(t.Y8G("translucent",!0),t.R7$(3),t.FS9("routerLink",e.appRoutes.home.path),t.R7$(7),t.Y8G("fullscreen",!0),t.R7$(),t.Y8G("ngIf",e.filtroAtual.motoristaId||e.filtroAtual.veiculoId||e.filtroAtual.status||e.filtroAtual.tipoDataFiltro),t.R7$(3),t.Y8G("ngForOf",e.listaSaidaFrota),t.R7$(6),t.Y8G("isPopoverOpen",e.isPopoverOpen)("popoverEvent",e.popoverEvent)("items",e.allMotoristas))},dependencies:[p.MD,p.Sq,p.bT,p.vh,l.bv,l.Jm,l.QW,l.W9,l.A9,l.M0,l.eU,l.iq,l.Ax,l.Hp,l.$w,l.uz,l.he,l.nf,l.Nm,l.Ip,l.IO,l.BC,l.ai,l.Sb,l.Je,l.Gw,l.N7,m.iI,m.Wk,u.YN,u.BC,u.vS,b.i,k],styles:[".de-datetime[_ngcontent-%COMP%]{--width: 290px;--height: 382px;--border-radius: 8px}.de-datetime[_ngcontent-%COMP%]   ion-datetime[_ngcontent-%COMP%]{height:auto;width:auto;max-width:350px}.de-datetime[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(288px,1fr));grid-gap:0 10px}.de-datetime[_ngcontent-%COMP%]   ion-datetime[_ngcontent-%COMP%]{height:382px}"]}),r})()}}]);