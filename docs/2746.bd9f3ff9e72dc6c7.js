"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2746],{2746:(zt,k,m)=>{m.r(k),m.d(k,{FormPage:()=>Lt});var l=m(467),p=m(177),c=m(4341),f=m(2902),i=m(4742),t=m(4438),C=m(4843),h=m(3469),v=m(5079),_=m(5873);function x(e,s){if(1&e&&t.nrm(0,"ion-icon",3),2&e){const a=t.XpG();t.Y8G("name","primary"===a.color?"add-circle":"trash-outline")}}function D(e,s){if(1&e&&(t.j41(0,"ion-label"),t.EFF(1),t.k0s()),2&e){const a=t.XpG();t.R7$(),t.JRh(a.text)}}let S=(()=>{var e;class s{constructor(){this.color="primary",this.text="",this.disabled=!1,this.slot="end",this.buttonClick=new t.bkB,(0,v.a)({addCircle:_.YH_,trashOutline:_.P1A})}onClick(){this.disabled||this.buttonClick.emit()}}return(e=s).\u0275fac=function(o){return new(o||e)},e.\u0275cmp=t.VBU({type:e,selectors:[["app-button-add-remove"]],inputs:{color:"color",text:"text",disabled:"disabled",slot:"slot"},outputs:{buttonClick:"buttonClick"},standalone:!0,features:[t.aNF],decls:3,vars:5,consts:[[3,"click","color","disabled","slot"],["slot","icon-only",3,"name",4,"ngIf"],[4,"ngIf"],["slot","icon-only",3,"name"]],template:function(o,n){1&o&&(t.j41(0,"ion-button",0),t.bIt("click",function(){return n.onClick()}),t.DNE(1,x,1,1,"ion-icon",1)(2,D,2,1,"ion-label",2),t.k0s()),2&o&&(t.Y8G("color",n.color)("disabled",n.disabled)("slot",n.slot),t.R7$(),t.Y8G("ngIf",!n.text),t.R7$(),t.Y8G("ngIf",n.text))},dependencies:[p.MD,p.bT,i.bv,i.Jm,i.iq,i.he]}),s})();var E=m(580);let $=(()=>{var e;class s{constructor(o){this.modalCtrl=o}ngOnInit(){}submit(){this.modalCtrl.dismiss(!0)}cancel(){this.modalCtrl.dismiss(!1)}}return(e=s).\u0275fac=function(o){return new(o||e)(t.rXU(i.W3))},e.\u0275cmp=t.VBU({type:e,selectors:[["app-alert"]],inputs:{title:"title",message:"message",cancelLabel:"cancelLabel",okLabel:"okLabel"},standalone:!0,features:[t.aNF],decls:20,vars:4,consts:[[1,"ion-padding","ion-text-center"],[1,"ion-no-padding"],["size","large","expand","full","color","danger",3,"click"],["size","large","expand","full","color","success",3,"click"]],template:function(o,n){1&o&&(t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),t.EFF(3),t.k0s()()(),t.j41(4,"ion-content",0),t.nrm(5,"br")(6,"br")(7,"br")(8,"br"),t.j41(9,"h2"),t.EFF(10),t.k0s()(),t.j41(11,"ion-footer")(12,"ion-grid",1)(13,"ion-row")(14,"ion-col")(15,"ion-button",2),t.bIt("click",function(){return n.cancel()}),t.EFF(16),t.k0s()(),t.j41(17,"ion-col")(18,"ion-button",3),t.bIt("click",function(){return n.submit()}),t.EFF(19),t.k0s()()()()()),2&o&&(t.R7$(3),t.JRh(n.title),t.R7$(7),t.JRh(n.message),t.R7$(6),t.SpI(" ",n.cancelLabel," "),t.R7$(3),t.SpI(" ",n.okLabel," "))},dependencies:[p.MD,i.bv,i.Jm,i.hU,i.W9,i.M0,i.lO,i.eU,i.ln,i.BC,i.ai],styles:["[_nghost-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:24px;font-weight:500}"]}),s})();var V=m(132),X=m(8880),N=m(9684);function Y(e,s){1&e&&(t.qex(0),t.j41(1,"ion-row",3)(2,"ion-col",4),t.nrm(3,"ion-spinner",5),t.j41(4,"p"),t.EFF(5,"Carregando foto da c\xe2mera..."),t.k0s()()(),t.bVm())}function w(e,s){if(1&e){const a=t.RV6();t.j41(0,"ion-card",9),t.bIt("click",function(){t.eBV(a);const n=t.XpG(2);return t.Njj(n.emitResult())}),t.nrm(1,"ion-img",10),t.j41(2,"ion-card-header")(3,"ion-card-title"),t.EFF(4),t.k0s()()()}if(2&e){const a=t.XpG(2);t.R7$(),t.Y8G("src",a.scanResult.face),t.R7$(3),t.SpI(" ",a.scanResult.funcionario.name||"Motorista n\xe3o identificado"," ")}}function P(e,s){if(1&e&&(t.j41(0,"ion-row",6)(1,"ion-col",7),t.DNE(2,w,5,2,"ion-card",8),t.k0s()()),2&e){const a=t.XpG();t.R7$(2),t.Y8G("ngIf",a.scanResult)}}let M=(()=>{var e;class s{constructor(o,n,r,u){this.modalCtrl=o,this.fotos=n,this.navCtrl=r,this.baseApi=u,this.options={},this.loadingCamera=!0,this.getResultLeitorFacial=new t.bkB,this.cancelBuscaFacial=new t.bkB,(0,v.a)({keypadOutline:_.BSR,cameraOutline:_.GOB,cameraReverseOutline:_.O33})}ngOnInit(){this.iniciarCamera()}ngOnChanges(o){o.modoBuscaManualAtivo&&(this.modoBuscaManualAtivo||this.pararCamera())}iniciarCamera(){var o=this;return(0,l.A)(function*(){o.baseApi.positionCamera$.subscribe(function(){var n=(0,l.A)(function*(r){r&&(yield o.scan(r))});return function(r){return n.apply(this,arguments)}}())})()}pararCamera(){return(0,l.A)(function*(){yield E.k.stop()})()}scan(o){var n=this;return(0,l.A)(function*(){n.loadingCamera=!0;const r=yield n.fotos.scan(o);if(n.loadingCamera=!1,!r){n.scanResult=!1;const u=yield n.modalCtrl.create({component:$,componentProps:{title:"Erro",message:"N\xe3o conseguimos identificar a foto. Gostaria de tentar novamente?",okLabel:"Tentar novamente",cancelLabel:"Busca manual"}});return yield u.present(),(yield u.onDidDismiss()).data?n.scan():(n.pararCamera(),void n.cancelBuscaFacial.emit())}n.scanResult=r})()}recarregarCamera(){var o=this;return(0,l.A)(function*(){yield o.pararCamera(),o.scanResult=void 0,yield o.iniciarCamera()})()}emitResult(){this.getResultLeitorFacial.emit(this.scanResult),this.loadingCamera=!0,this.scanResult=!1}stopCamera(){var o=this;return(0,l.A)(function*(){yield o.pararCamera()})()}}return(e=s).\u0275fac=function(o){return new(o||e)(t.rXU(i.W3),t.rXU(V.r),t.rXU(X.q9),t.rXU(N.v))},e.\u0275cmp=t.VBU({type:e,selectors:[["app-leitor-facial"]],inputs:{modoBuscaManualAtivo:"modoBuscaManualAtivo"},outputs:{getResultLeitorFacial:"getResultLeitorFacial",cancelBuscaFacial:"cancelBuscaFacial"},standalone:!0,features:[t.OA$,t.aNF],decls:5,vars:2,consts:[["scanContent",""],["id","content",1,"ion-padding"],[4,"ngIf","ngIfElse"],[1,"ion-justify-content-center","ion-align-items-center"],[1,"ion-text-center"],["name","crescent"],[1,"ion-justify-content-center"],["size","12",1,"ion-text-center"],["class","image-card",3,"click",4,"ngIf"],[1,"image-card",3,"click"],[3,"src"]],template:function(o,n){if(1&o&&(t.j41(0,"ion-content",1)(1,"ion-grid"),t.DNE(2,Y,6,0,"ng-container",2)(3,P,3,1,"ng-template",null,0,t.C5r),t.k0s()()),2&o){const r=t.sdS(4);t.R7$(2),t.Y8G("ngIf",n.loadingCamera)("ngIfElse",r)}},dependencies:[p.MD,p.bT,i.bv,i.b_,i.ME,i.tN,i.hU,i.W9,i.lO,i.KW,i.ln,i.w2]}),s})();var B=m(2705),U=m(3459),j=m(9769);const G=e=>({"ion-hide":e});function L(e,s){1&e&&t.eu8(0)}function J(e,s){1&e&&t.eu8(0)}function q(e,s){if(1&e){const a=t.RV6();t.j41(0,"ion-button",15),t.bIt("click",function(){t.eBV(a);const n=t.XpG(2);return t.Njj(n.modoBuscaManual=!0)}),t.nrm(1,"ion-icon",16),t.k0s()}}function z(e,s){if(1&e){const a=t.RV6();t.j41(0,"ion-button",15),t.bIt("click",function(){t.eBV(a);const n=t.XpG(2);return t.Njj(n.modoBuscaManual=!1)}),t.nrm(1,"ion-icon",17),t.k0s()}}function W(e,s){if(1&e){const a=t.RV6();t.j41(0,"div",18)(1,"app-leitor-facial",19),t.bIt("cancelBuscaFacial",function(){t.eBV(a);const n=t.XpG(2);return t.Njj(n.modoBuscaManual=!0)})("getResultLeitorFacial",function(n){t.eBV(a);const r=t.XpG(2);return t.Njj(r.resultLeitorFacial(n))}),t.k0s()()}if(2&e){const a=t.XpG(2);t.R7$(),t.Y8G("modoBuscaManualAtivo",a.modoBuscaManual)}}function H(e,s){if(1&e){const a=t.RV6();t.j41(0,"ion-item",8),t.bIt("click",function(){const n=t.eBV(a).$implicit,r=t.XpG(4);return t.Njj(r.adicionarAcompanhante(n))}),t.EFF(1),t.k0s()}if(2&e){const a=s.$implicit;t.R7$(),t.SpI(" ",a.name," ")}}function K(e,s){if(1&e&&(t.j41(0,"ion-list"),t.DNE(1,H,2,1,"ion-item",23),t.k0s()),2&e){const a=t.XpG(3);t.R7$(),t.Y8G("ngForOf",a.acompanhantesFiltrados)}}function Q(e,s){if(1&e){const a=t.RV6();t.j41(0,"div",20)(1,"ion-item")(2,"ion-searchbar",21),t.mxI("ngModelChange",function(n){t.eBV(a);const r=t.XpG(2);return t.DH7(r.acompanhanteBusca,n)||(r.acompanhanteBusca=n),t.Njj(n)}),t.bIt("ionInput",function(){t.eBV(a);const n=t.XpG(2);return t.Njj(n.buscarAcompanhantes())}),t.k0s()(),t.DNE(3,K,2,1,"ion-list",22),t.k0s()}if(2&e){const a=t.XpG(2);t.R7$(2),t.R50("ngModel",a.acompanhanteBusca),t.R7$(),t.Y8G("ngIf",a.acompanhantesFiltrados.length>0&&a.acompanhanteBusca)}}function Z(e,s){1&e&&t.eu8(0)}function tt(e,s){1&e&&t.eu8(0)}function ot(e,s){if(1&e){const a=t.RV6();t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",7)(3,"ion-button",8),t.bIt("click",function(){t.eBV(a);const n=t.XpG();return t.Njj(n.isOpen=!1)}),t.nrm(4,"ion-icon",9),t.k0s()(),t.j41(5,"ion-buttons",10),t.DNE(6,q,2,0,"ion-button",11)(7,z,2,0,"ion-button",11),t.k0s()()(),t.j41(8,"ion-content",12),t.DNE(9,W,2,1,"div",13)(10,Q,4,2,"div",14)(11,Z,1,0,"ng-container",5)(12,tt,1,0,"ng-container",5),t.k0s()}if(2&e){const a=t.XpG(),o=t.sdS(11),n=t.sdS(13);t.R7$(6),t.Y8G("ngIf",!a.modoBuscaManual),t.R7$(),t.Y8G("ngIf",a.modoBuscaManual),t.R7$(2),t.Y8G("ngIf",!a.modoBuscaManual),t.R7$(),t.Y8G("ngIf",a.modoBuscaManual),t.R7$(),t.Y8G("ngTemplateOutlet",o),t.R7$(),t.Y8G("ngTemplateOutlet",n)}}function nt(e,s){if(1&e){const a=t.RV6();t.j41(0,"ion-item")(1,"ion-avatar"),t.nrm(2,"img",25),t.k0s(),t.j41(3,"ion-label"),t.EFF(4),t.k0s(),t.nrm(5,"ion-input",3),t.j41(6,"app-button-add-remove",26),t.bIt("buttonClick",function(){const n=t.eBV(a).$implicit,r=t.XpG(2);return t.Njj(r.removerAcompanhante(n))}),t.k0s()()}if(2&e){const a=s.$implicit,o=t.XpG(2);t.R7$(2),t.Mz_("alt","Foto de acompanhante ",a.name,""),t.Y8G("src",o.fotosAcompanhantesSelecionados[a.id],t.B4B),t.R7$(2),t.JRh(a.name),t.R7$(),t.Y8G("disabled",!0),t.R7$(),t.Y8G("ngClass",t.eq3(6,G,o.isFinished))}}function et(e,s){if(1&e&&(t.j41(0,"ion-list"),t.DNE(1,nt,7,8,"ion-item",24),t.k0s()),2&e){const a=t.XpG();t.R7$(),t.Y8G("ngForOf",a.acompanhantesSelecionados)}}function at(e,s){1&e&&(t.j41(0,"p",28)(1,"strong"),t.EFF(2,"Nenhum acompanhante selecionado."),t.k0s()())}function it(e,s){if(1&e&&t.DNE(0,at,3,0,"p",27),2&e){const a=t.XpG();t.Y8G("ngIf",a.acompanhantesSelecionados.length<1)}}let y=(()=>{var e;class s{constructor(o,n,r){this.funcionarioService=o,this.acompanhanteFrotaSrv=n,this.identificacaoFuncSrv=r,this.modoBuscaManual=!1,this.isOpen=!1,this.acompanhantes=[],this.acompanhanteBusca="",this.acompanhantesFiltrados=[],this.acompanhantesSelecionados=[],this.fotosAcompanhantesSelecionados={},this.tipoAcompanhanteRetorno=!1,this.isFinished=!1,this.statusSaveAcompanhanteFrota=new t.bkB,(0,v.a)({addCircle:_.YH_,keypadOutline:_.BSR,cameraOutline:_.GOB,arrowBack:_.$$C})}ngOnInit(){var o=this;return(0,l.A)(function*(){yield o.carregarAcompanhantes()})()}ngOnChanges(o){var n=this;return(0,l.A)(function*(){if(o.saveAcompanhanteFrota){const r=o.saveAcompanhanteFrota.currentValue;r&&(yield n.submitFrotaAcompanhante(r))}o.idFrota&&n.idFrota&&(yield n.carregarAcompanhantesSelecionados(n.idFrota)),o.tipoAcompanhanteRetorno&&n.idFrota&&(yield n.carregarAcompanhantesSelecionados(n.idFrota))})()}carregarAcompanhantesSelecionados(o){var n=this;return(0,l.A)(function*(){try{let u;u=n.isFinished&&n.tipoAcompanhanteRetorno?yield(0,C._)(n.acompanhanteFrotaSrv.getAll(o,h.E.Retorno)):yield(0,C._)(n.acompanhanteFrotaSrv.getAll(o,h.E.Saida)),yield n.carregarAcompanhantes();const d=n.acompanhantes;n.acompanhantesSelecionados=u.map(g=>d.find(F=>F.id===g.funcCod)).filter(g=>null!=g),n.acompanhantesSelecionados.length>0&&n.acompanhantesSelecionados.forEach(function(){var g=(0,l.A)(function*(F){n.fotosAcompanhantesSelecionados[F.id]=yield n.getPhotoAcompanhante(F.id)});return function(F){return g.apply(this,arguments)}}())}catch(u){console.error("Erro ao carregar acompanhantes selecionados:",u)}})()}carregarAcompanhantes(){var o=this;return(0,l.A)(function*(){const n=o.funcionarioService.getCachedFuncionarios();if(n&&0!==n.length)o.acompanhantes=n;else{const r=yield(0,C._)(o.funcionarioService.getAll());o.acompanhantes=r}})()}buscarAcompanhantes(){const o=this.acompanhanteBusca.toLowerCase();this.acompanhantesFiltrados=this.acompanhantes.filter(n=>n.name.toLowerCase().includes(o)&&!this.acompanhantesSelecionados.some(r=>r.id===n.id))}adicionarAcompanhante(o){var n=this;return(0,l.A)(function*(){n.fotosAcompanhantesSelecionados[o.id]||(n.fotosAcompanhantesSelecionados[o.id]=yield n.getPhotoAcompanhante(o.id)),n.acompanhantesSelecionados.push(o),n.acompanhanteBusca="",n.acompanhantesFiltrados=[]})()}removerAcompanhante(o){this.acompanhantesSelecionados=this.acompanhantesSelecionados.filter(n=>n.id!==o.id)}submitFrotaAcompanhante(o){var n=this;return(0,l.A)(function*(){const r=n.tipoAcompanhanteRetorno?h.E.Retorno:h.E.Saida,u=n.acompanhantesSelecionados.map(d=>({frotaSeq:o,tipo:r,funcCod:d.id}));n.acompanhantesSelecionados.length>0&&(n.idFrota&&!n.tipoAcompanhanteRetorno?n.acompanhanteFrotaSrv.update(n.idFrota,h.E.Saida,u).subscribe({next:()=>{n.statusSaveAcompanhanteFrota.emit(!0)},error:d=>{n.statusSaveAcompanhanteFrota.emit(!1)}}):n.acompanhanteFrotaSrv.save(u).subscribe({next:()=>{n.statusSaveAcompanhanteFrota.emit(!0)},error:d=>{n.statusSaveAcompanhanteFrota.emit(!1)}}))})()}resultLeitorFacial(o){this.fotosAcompanhantesSelecionados[o.funcionario.id]=o.face,this.acompanhantesSelecionados.push(o.funcionario)}getPhotoAcompanhante(o){var n=this;return(0,l.A)(function*(){try{const r=yield n.identificacaoFuncSrv.getImage(o);return o&&r?r:"assets/user.png"}catch{return"assets/user.png"}})()}}return(e=s).\u0275fac=function(o){return new(o||e)(t.rXU(B.r),t.rXU(U.H),t.rXU(j._))},e.\u0275cmp=t.VBU({type:e,selectors:[["app-frota-acompanhantes"]],inputs:{tipoAcompanhanteRetorno:"tipoAcompanhanteRetorno",saveAcompanhanteFrota:"saveAcompanhanteFrota",idFrota:"idFrota",isFinished:"isFinished"},outputs:{statusSaveAcompanhanteFrota:"statusSaveAcompanhanteFrota"},standalone:!0,features:[t.OA$,t.aNF],decls:14,vars:7,consts:[["listaAcompanhantesSelecionados",""],["mensagensAcompanhantes",""],[1,"ion-justify-content-center","ion-align-items-center"],[2,"width","0","height","0",3,"disabled"],["color","primary",3,"buttonClick","ngClass"],[4,"ngTemplateOutlet"],[3,"isOpen"],["slot","start"],[3,"click"],["slot","icon-only","name","arrow-back","color","primary"],["slot","end"],["fill","clear",3,"click",4,"ngIf"],[1,"ion-padding"],["class","busca-facial",4,"ngIf"],["class","busca-manual",4,"ngIf"],["fill","clear",3,"click"],["name","keypad-outline"],["name","camera-outline","color","primary"],[1,"busca-facial"],[3,"cancelBuscaFacial","getResultLeitorFacial","modoBuscaManualAtivo"],[1,"busca-manual"],["placeholder","Buscar Acompanhante",3,"ngModelChange","ionInput","ngModel"],[4,"ngIf"],[3,"click",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[3,"src","alt"],["color","danger",3,"buttonClick","ngClass"],["class","ion-text-center",4,"ngIf"],[1,"ion-text-center"]],template:function(o,n){if(1&o){const r=t.RV6();t.j41(0,"ion-list")(1,"ion-item",2)(2,"ion-label"),t.EFF(3,"Acompanhante(s) selecionado(s)"),t.k0s(),t.nrm(4,"ion-input",3),t.j41(5,"app-button-add-remove",4),t.bIt("buttonClick",function(){return t.eBV(r),t.Njj(n.isOpen=!0)}),t.k0s()(),t.DNE(6,L,1,0,"ng-container",5)(7,J,1,0,"ng-container",5),t.k0s(),t.j41(8,"ion-modal",6),t.DNE(9,ot,13,6,"ng-template"),t.k0s(),t.DNE(10,et,2,1,"ng-template",null,0,t.C5r)(12,it,1,1,"ng-template",null,1,t.C5r)}if(2&o){const r=t.sdS(11),u=t.sdS(13);t.R7$(4),t.Y8G("disabled",!0),t.R7$(),t.Y8G("ngClass",t.eq3(5,G,n.isFinished)),t.R7$(),t.Y8G("ngTemplateOutlet",r),t.R7$(),t.Y8G("ngTemplateOutlet",u),t.R7$(),t.Y8G("isOpen",n.isOpen)}},dependencies:[p.MD,p.YU,p.Sq,p.bT,p.T3,i.bv,i.mC,i.Jm,i.QW,i.W9,i.eU,i.iq,i.$w,i.uz,i.he,i.nf,i.S1,i.ai,i.Sb,i.Gw,f.iI,c.YN,c.BC,c.vS,S,M],styles:["ion-avatar[_ngcontent-%COMP%]{height:80px;width:80px;background-color:#fff;margin-top:1rem;border-radius:50%;margin-right:1rem}ion-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{object-fit:contain}app-leitor-facial[_ngcontent-%COMP%]{height:510px;display:block}.busca-facial[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{margin:auto}"]}),s})();function rt(e,s){if(1&e&&(t.j41(0,"ion-select-option",5),t.EFF(1),t.k0s()),2&e){const a=s.$implicit,o=t.XpG();t.Y8G("value",a[o.idKey]),t.R7$(),t.SpI(" ",a[o.descricaoKey]||""," ")}}function st(e,s){if(1&e){const a=t.RV6();t.qex(0),t.j41(1,"ion-button",6),t.bIt("click",function(){t.eBV(a);const n=t.XpG();return t.Njj(n.add())}),t.nrm(2,"ion-icon",7),t.k0s(),t.bVm()}}let b=(()=>{var e;class s{constructor(){this.data=[],this.control=new c.MJ,this.placeholder="",this.label="Motivo",this.idKey="id",this.descricaoKey="descricao",this.showAddButton=!0,this.itemAdd=new t.bkB,(0,v.a)({addCircle:_.YH_})}add(){this.itemAdd.emit()}}return(e=s).\u0275fac=function(o){return new(o||e)},e.\u0275cmp=t.VBU({type:e,selectors:[["app-frota-select"]],inputs:{data:"data",control:"control",placeholder:"placeholder",label:"label",idKey:"idKey",descricaoKey:"descricaoKey",showAddButton:"showAddButton"},outputs:{itemAdd:"itemAdd"},standalone:!0,features:[t.aNF],decls:6,vars:5,consts:[[1,"ion-justify-content-center","ion-align-items-center"],["position","floating"],[3,"formControl","placeholder"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"value"],["slot","end","color","primary",3,"click"],["name","add-circle"]],template:function(o,n){1&o&&(t.j41(0,"ion-item",0)(1,"ion-label",1),t.EFF(2),t.k0s(),t.j41(3,"ion-select",2),t.DNE(4,rt,2,2,"ion-select-option",3),t.k0s(),t.DNE(5,st,3,0,"ng-container",4),t.k0s()),2&o&&(t.R7$(2),t.JRh(n.label),t.R7$(),t.Y8G("formControl",n.control)("placeholder",n.placeholder),t.R7$(),t.Y8G("ngForOf",n.data),t.R7$(),t.Y8G("ngIf",n.showAddButton))},dependencies:[p.MD,p.Sq,p.bT,i.bv,i.Jm,i.iq,i.uz,i.he,i.Nm,i.Ip,i.Je,f.iI,c.X1,c.BC,c.l_]}),s})();function ct(e,s){if(1&e){const a=t.RV6();t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",1)(3,"ion-button",2),t.bIt("click",function(){t.eBV(a);const n=t.XpG();return t.Njj(n.botaoCancelarModal())}),t.EFF(4,"Voltar"),t.k0s()(),t.j41(5,"ion-buttons",3)(6,"ion-button",4),t.bIt("click",function(){t.eBV(a);const n=t.XpG();return t.Njj(n.botaoConfirmar())}),t.EFF(7," Confirmar "),t.k0s()()()(),t.j41(8,"ion-content",5)(9,"ion-item")(10,"ion-row")(11,"ion-col",6),t.nrm(12,"ion-textarea",7),t.EFF(13),t.k0s()()()()}if(2&e){const a=t.XpG();t.R7$(6),t.Y8G("disabled",!a.descricaoControl.value)("strong",!0),t.R7$(6),t.Y8G("formControl",a.descricaoControl)("placeholder",a.placeholder),t.R7$(),t.SpI(" ",a.descricaoControl.value," ")}}let I=(()=>{var e;class s{constructor(){this.isOpen=!1,this.placeholder="Descri\xe7\xe3o",this.descricaoControl=new c.MJ(""),this.cancelar=new t.bkB,this.confirmar=new t.bkB}botaoCancelarModal(){this.cancelar.emit()}botaoConfirmar(){this.confirmar.emit()}}return(e=s).\u0275fac=function(o){return new(o||e)},e.\u0275cmp=t.VBU({type:e,selectors:[["app-frota-basic-modal"]],inputs:{isOpen:"isOpen",placeholder:"placeholder",descricaoControl:"descricaoControl"},outputs:{cancelar:"cancelar",confirmar:"confirmar"},standalone:!0,features:[t.aNF],decls:2,vars:1,consts:[[3,"isOpen"],["slot","start"],[3,"click"],["slot","end"],[3,"click","disabled","strong"],[1,"ion-padding"],["size","12"],["rows","3","fill","outline",3,"formControl","placeholder"]],template:function(o,n){1&o&&(t.j41(0,"ion-modal",0),t.DNE(1,ct,14,5,"ng-template"),t.k0s()),2&o&&t.Y8G("isOpen",n.isOpen)},dependencies:[p.MD,i.bv,i.Jm,i.QW,i.hU,i.W9,i.eU,i.uz,i.ln,i.nc,i.ai,i.Sb,i.Gw,f.iI,c.X1,c.BC,c.l_]}),s})();var R=m(3207),T=m(8313);let A=(()=>{var e;class s{constructor(o,n,r){this.service=o,this.loadingCtrl=n,this.alertCtrl=r,this.modalOpen=!1,this.control=new c.MJ(""),this.descricao=new c.MJ(""),this.data=[]}loadingData(){var o=this;return(0,l.A)(function*(){try{const n=yield(0,R.s)(o.service.getAll());o.data=n}catch(n){throw console.error("Erro ao carregar:",n.message),n}})()}addItem(){this.modalOpen=!0}onModalCancel(){this.modalOpen=!1}onModalConfirm(){var o=this;return(0,l.A)(function*(){var n;yield(0,T.h)(o.loadingCtrl,o.alertCtrl,{mainAction:(n=(0,l.A)(function*(){yield(0,R.s)(o.service.save({descricao:o.descricao.value})),yield o.loadingData(),o.modalOpen=!1}),function(){return n.apply(this,arguments)}),onError:n=>{console.error("Erro ao executar a\xe7\xe3o no modal:",n.message)}})})()}}return(e=s).\u0275fac=function(o){t.QTQ()},e.\u0275prov=t.jDH({token:e,factory:e.\u0275fac,providedIn:"any"}),s})();var lt=m(3103),O=m(9795);let mt=(()=>{var e;class s extends A{constructor(o,n,r){super(o,n,r)}ngOnInit(){var o=this;return(0,l.A)(function*(){yield o.loadingData()})()}}return(e=s).\u0275fac=function(o){return new(o||e)(t.rXU(lt.i),t.rXU(O.Xi),t.rXU(i.hG))},e.\u0275cmp=t.VBU({type:e,selectors:[["app-frota-motivo"]],inputs:{control:"control"},standalone:!0,features:[t.Vt3,t.aNF],decls:2,vars:4,consts:[["label","Sele\xe7\xe3o de Motivo",3,"itemAdd","data","control"],["placeholder","Digite aqui o motivo",3,"cancelar","confirmar","isOpen","descricaoControl"]],template:function(o,n){1&o&&(t.j41(0,"app-frota-select",0),t.bIt("itemAdd",function(){return n.addItem()}),t.k0s(),t.j41(1,"app-frota-basic-modal",1),t.bIt("cancelar",function(){return n.onModalCancel()})("confirmar",function(){return n.onModalConfirm()}),t.k0s()),2&o&&(t.Y8G("data",n.data)("control",n.control),t.R7$(),t.Y8G("isOpen",n.modalOpen)("descricaoControl",n.descricao))},dependencies:[p.MD,i.bv,f.iI,c.X1,b,I]}),s})();var ut=m(2553);let pt=(()=>{var e;class s extends A{constructor(o,n,r){super(o,n,r)}ngOnInit(){var o=this;return(0,l.A)(function*(){yield o.loadingData()})()}}return(e=s).\u0275fac=function(o){return new(o||e)(t.rXU(ut.G),t.rXU(i.Xi),t.rXU(i.hG))},e.\u0275cmp=t.VBU({type:e,selectors:[["app-frota-destino"]],inputs:{control:"control"},standalone:!0,features:[t.Vt3,t.aNF],decls:2,vars:4,consts:[["label","Sele\xe7\xe3o de Destino",3,"itemAdd","data","control"],["placeholder","Digite aqui o destino",3,"cancelar","confirmar","isOpen","descricaoControl"]],template:function(o,n){1&o&&(t.j41(0,"app-frota-select",0),t.bIt("itemAdd",function(){return n.addItem()}),t.k0s(),t.j41(1,"app-frota-basic-modal",1),t.bIt("cancelar",function(){return n.onModalCancel()})("confirmar",function(){return n.onModalConfirm()}),t.k0s()),2&o&&(t.Y8G("data",n.data)("control",n.control),t.R7$(),t.Y8G("isOpen",n.modalOpen)("descricaoControl",n.descricao))},dependencies:[p.MD,i.bv,f.iI,c.X1,b,I]}),s})();var dt=m(7106);let _t=(()=>{var e;class s extends A{constructor(o,n,r){super(o,n,r),this.withoutRoutesOpen=!0}ngOnInit(){var o=this;return(0,l.A)(function*(){o.withoutRoutesOpen?yield o.loadingDataWithoutRoutesOpen():yield o.loadingData()})()}loadingDataWithoutRoutesOpen(){var o=this;return(0,l.A)(function*(){try{const n=yield(0,R.s)(o.service.getAllWithoutRoutesOpen());o.data=n}catch(n){throw console.error("Erro ao carregar veiculos:",n.message),n}})()}}return(e=s).\u0275fac=function(o){return new(o||e)(t.rXU(dt.T),t.rXU(i.Xi),t.rXU(O.hG))},e.\u0275cmp=t.VBU({type:e,selectors:[["app-frota-veiculo"]],inputs:{control:"control",withoutRoutesOpen:"withoutRoutesOpen"},standalone:!0,features:[t.Vt3,t.aNF],decls:1,vars:3,consts:[["label","Sele\xe7\xe3o de ve\xedculo",3,"itemAdd","data","control","showAddButton"]],template:function(o,n){1&o&&(t.j41(0,"app-frota-select",0),t.bIt("itemAdd",function(){return n.addItem()}),t.k0s()),2&o&&t.Y8G("data",n.data)("control",n.control)("showAddButton",!1)},dependencies:[p.MD,i.bv,f.iI,c.X1,b]}),s})();var ft=m(5964),ht=m(5784);const gt=e=>({"ion-hide":e});function Ft(e,s){if(1&e){const a=t.RV6();t.j41(0,"ion-item",3)(1,"ion-label"),t.EFF(2,"Selecionar motorista:"),t.k0s(),t.qex(3),t.j41(4,"app-button-add-remove",4),t.bIt("buttonClick",function(){t.eBV(a);const n=t.XpG();return t.Njj(n.isOpen=!0)}),t.k0s(),t.bVm(),t.k0s()}if(2&e){const a=t.XpG();t.R7$(4),t.Y8G("ngClass",t.eq3(1,gt,a.isFinished))}}function Ct(e,s){if(1&e){const a=t.RV6();t.j41(0,"ion-item")(1,"div",5)(2,"ion-label",6),t.EFF(3,"Motorista:"),t.k0s(),t.j41(4,"ion-input",7),t.mxI("ngModelChange",function(n){t.eBV(a);const r=t.XpG();return t.DH7(r.motoristaSelecionado.name,n)||(r.motoristaSelecionado.name=n),t.Njj(n)}),t.k0s()(),t.j41(5,"app-button-add-remove",8),t.bIt("buttonClick",function(){t.eBV(a);const n=t.XpG();return t.Njj(n.removerMotorista())}),t.k0s()()}if(2&e){const a=t.XpG();t.R7$(4),t.Y8G("readonly",!0),t.R50("ngModel",a.motoristaSelecionado.name)}}function vt(e,s){if(1&e){const a=t.RV6();t.j41(0,"ion-button",17),t.bIt("click",function(){t.eBV(a);const n=t.XpG(2);return t.Njj(n.modoBuscaManual=!0)}),t.nrm(1,"ion-icon",18),t.k0s()}}function bt(e,s){if(1&e){const a=t.RV6();t.j41(0,"ion-button",17),t.bIt("click",function(){t.eBV(a);const n=t.XpG(2);return t.Njj(n.modoBuscaManual=!1)}),t.nrm(1,"ion-icon",19),t.k0s()}}function Rt(e,s){if(1&e){const a=t.RV6();t.j41(0,"div",20)(1,"app-leitor-facial",21),t.bIt("cancelBuscaFacial",function(){t.eBV(a);const n=t.XpG(2);return t.Njj(n.modoBuscaManual=!0)})("getResultLeitorFacial",function(n){t.eBV(a);const r=t.XpG(2);return t.Njj(r.resultLeitorFacial(n))}),t.k0s()()}if(2&e){const a=t.XpG(2);t.R7$(),t.Y8G("modoBuscaManualAtivo",a.modoBuscaManual)}}function At(e,s){if(1&e){const a=t.RV6();t.j41(0,"ion-item",10),t.bIt("click",function(){const n=t.eBV(a).$implicit,r=t.XpG(4);return t.Njj(r.selecionarMotorista(n))}),t.EFF(1),t.k0s()}if(2&e){const a=s.$implicit;t.R7$(),t.SpI(" ",a.name," ")}}function kt(e,s){if(1&e&&(t.j41(0,"ion-list"),t.DNE(1,At,2,1,"ion-item",24),t.k0s()),2&e){const a=t.XpG(3);t.R7$(),t.Y8G("ngForOf",a.motoristasFiltrados)}}function St(e,s){1&e&&(t.j41(0,"ion-text"),t.EFF(1," Nenhum motorista encontrado. "),t.k0s())}function Mt(e,s){if(1&e){const a=t.RV6();t.j41(0,"div",22)(1,"ion-item")(2,"ion-searchbar",23),t.mxI("ngModelChange",function(n){t.eBV(a);const r=t.XpG(2);return t.DH7(r.funcionarioBusca,n)||(r.funcionarioBusca=n),t.Njj(n)}),t.bIt("ionInput",function(){t.eBV(a);const n=t.XpG(2);return t.Njj(n.buscarMotoristas())}),t.k0s()(),t.DNE(3,kt,2,1,"ion-list",1)(4,St,2,0,"ion-text",1),t.k0s()}if(2&e){const a=t.XpG(2);t.R7$(2),t.R50("ngModel",a.funcionarioBusca),t.R7$(),t.Y8G("ngIf",a.motoristasFiltrados.length>0&&a.funcionarioBusca),t.R7$(),t.Y8G("ngIf",0===a.motoristasFiltrados.length&&a.funcionarioBusca)}}function Bt(e,s){if(1&e){const a=t.RV6();t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",9)(3,"ion-button",10),t.bIt("click",function(){t.eBV(a);const n=t.XpG();return t.Njj(n.isOpen=!1)}),t.nrm(4,"ion-icon",11),t.k0s()(),t.j41(5,"ion-title"),t.EFF(6,"Selecionar Motorista"),t.k0s(),t.j41(7,"ion-buttons",12),t.DNE(8,vt,2,0,"ion-button",13)(9,bt,2,0,"ion-button",13),t.k0s()()(),t.j41(10,"ion-content",14),t.DNE(11,Rt,2,1,"div",15)(12,Mt,5,3,"div",16),t.k0s()}if(2&e){const a=t.XpG();t.R7$(8),t.Y8G("ngIf",!a.modoBuscaManual),t.R7$(),t.Y8G("ngIf",a.modoBuscaManual),t.R7$(),t.Y8G("fullscreen",!0),t.R7$(),t.Y8G("ngIf",!a.modoBuscaManual),t.R7$(),t.Y8G("ngIf",a.modoBuscaManual)}}let jt=(()=>{var e;class s{constructor(o){this.funcionarioService=o,this.modoBuscaManual=!1,this.isOpen=!1,this.funcionarios=[],this.funcionarioBusca="",this.motoristasFiltrados=[],this.motoristaSelecionado=null,this.isFinished=!1,(0,v.a)({trashOutline:_.P1A,arrowBack:_.$$C})}ngOnInit(){var o=this;return(0,l.A)(function*(){yield o.carregarMotoristas(),o.getMotoristaIdSubscription=o.control.valueChanges.subscribe(function(){var n=(0,l.A)(function*(r){r&&(yield o.carregarMotoristaSelecionado(r))});return function(r){return n.apply(this,arguments)}}())})()}carregarMotoristas(){var o=this;return(0,l.A)(function*(){const n=o.funcionarioService.getCachedFuncionarios();if(n&&0!==n.length)o.funcionarios=n;else{const r=yield(0,C._)(o.funcionarioService.getAll());o.funcionarios=r}})()}buscarMotoristas(){const o=this.funcionarioBusca.toLowerCase();this.motoristasFiltrados=this.funcionarios.filter(n=>{var r;return null===(r=n.name)||void 0===r?void 0:r.toLowerCase().includes(o)})}selecionarMotorista(o){this.motoristaSelecionado=o,this.control.setValue(o.id),this.isOpen=!1,this.funcionarioBusca="",this.motoristasFiltrados=[]}removerMotorista(){this.motoristaSelecionado=null,this.control.setValue(null)}ngOnChanges(o){var n=this;return(0,l.A)(function*(){if(o.control){const r=o.control.currentValue;r&&r.value&&(yield n.carregarMotoristaSelecionado(r.value))}})()}carregarMotoristaSelecionado(o){var n=this;return(0,l.A)(function*(){try{yield n.carregarMotoristas(),n.motoristaSelecionado=n.funcionarios.find(u=>u.id===o)}catch(r){console.error("Erro ao carregar motorista selecionado:",r)}})()}resultLeitorFacial(o){this.selecionarMotorista(o.funcionario)}ngOnDestroy(){this.getMotoristaIdSubscription.unsubscribe()}}return(e=s).\u0275fac=function(o){return new(o||e)(t.rXU(B.r))},e.\u0275cmp=t.VBU({type:e,selectors:[["app-frota-motorista"]],inputs:{control:"control",isFinished:"isFinished"},standalone:!0,features:[t.OA$,t.aNF],decls:5,vars:3,consts:[["class","ion-justify-content-center ion-align-items-center",4,"ngIf"],[4,"ngIf"],[3,"isOpen"],[1,"ion-justify-content-center","ion-align-items-center"],["color","primary",3,"buttonClick","ngClass"],[1,"item-content"],["position","floating"],[3,"ngModelChange","readonly","ngModel"],["color","danger","slot","end",3,"buttonClick"],["slot","start"],[3,"click"],["slot","icon-only","name","arrow-back","color","primary"],["slot","end"],["fill","clear",3,"click",4,"ngIf"],[1,"ion-padding",3,"fullscreen"],["class","busca-facial",4,"ngIf"],["class","busca-manual",4,"ngIf"],["fill","clear",3,"click"],["name","keypad-outline"],["name","camera-outline","color","primary"],[1,"busca-facial"],[3,"cancelBuscaFacial","getResultLeitorFacial","modoBuscaManualAtivo"],[1,"busca-manual"],["placeholder","Buscar Motorista",3,"ngModelChange","ionInput","ngModel"],[3,"click",4,"ngFor","ngForOf"]],template:function(o,n){1&o&&(t.j41(0,"ion-list"),t.DNE(1,Ft,5,3,"ion-item",0)(2,Ct,6,2,"ion-item",1),t.k0s(),t.j41(3,"ion-modal",2),t.DNE(4,Bt,13,5,"ng-template"),t.k0s()),2&o&&(t.R7$(),t.Y8G("ngIf",!n.motoristaSelecionado),t.R7$(),t.Y8G("ngIf",n.motoristaSelecionado),t.R7$(),t.Y8G("isOpen",n.isOpen))},dependencies:[p.MD,p.YU,p.Sq,p.bT,i.bv,i.Jm,i.QW,i.W9,i.eU,i.iq,i.$w,i.uz,i.he,i.nf,i.S1,i.IO,i.BC,i.ai,i.Sb,i.Gw,f.iI,c.YN,c.BC,c.vS,S,M],styles:["ion-item[_ngcontent-%COMP%]{display:flex;align-items:center}ion-item[_ngcontent-%COMP%]   .item-content[_ngcontent-%COMP%]{flex-grow:1;display:flex;flex-direction:column;width:100%}app-leitor-facial[_ngcontent-%COMP%]{height:510px;display:block}"]}),s})();var Gt=m(8663);function yt(e,s){1&e&&(t.j41(0,"span"),t.EFF(1,"Campo obrigat\xf3rio."),t.k0s())}function It(e,s){1&e&&(t.j41(0,"span"),t.EFF(1,"O valor m\xednimo deve ser maior que o Km de sa\xedda."),t.k0s())}function Tt(e,s){if(1&e&&(t.j41(0,"ion-text",7),t.DNE(1,yt,2,0,"span",8)(2,It,2,0,"span",8),t.k0s()),2&e){const a=t.XpG();t.R7$(),t.Y8G("ngIf",null==a.kmRetornoControl||null==a.kmRetornoControl.errors?null:a.kmRetornoControl.errors.required),t.R7$(),t.Y8G("ngIf",null==a.kmRetornoControl||null==a.kmRetornoControl.errors?null:a.kmRetornoControl.errors.min)}}function Ot(e,s){if(1&e){const a=t.RV6();t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),t.EFF(3,"Selecionar Data e Hora"),t.k0s(),t.j41(4,"ion-buttons",9)(5,"ion-button",10),t.bIt("click",function(){t.eBV(a);const n=t.XpG();return t.Njj(n.onCloseModal())}),t.EFF(6,"Voltar"),t.k0s()(),t.j41(7,"ion-buttons",11)(8,"ion-button",12),t.bIt("click",function(){t.eBV(a);const n=t.XpG();return t.Njj(n.onConfirmSelectDate())}),t.EFF(9,"Confirmar"),t.k0s()()()(),t.j41(10,"ion-content",13),t.nrm(11,"ion-datetime",14),t.k0s()}if(2&e){const a=t.XpG();t.R7$(8),t.Y8G("disabled",!a.dataRetornoControl.value)("strong",!0),t.R7$(3),t.Y8G("formControl",a.dataRetornoControl)}}let xt=(()=>{var e;class s{constructor(o){this.datePipe=o,this.openModal=!1}ngOnInit(){this.dataRetornoControl.valueChanges.subscribe(o=>{var n;o&&(this.showDataRetorno=null!==(n=this.datePipe.transform(o,"dd-MM-yyyy HH:mm","pt-BR"))&&void 0!==n?n:"")}),this.dataRetornoControl.setValue(new Date)}onOpenModal(){this.openModal=!0}onCloseModal(){this.openModal=!1}onConfirmSelectDate(){this.openModal=!0}}return(e=s).\u0275fac=function(o){return new(o||e)(t.rXU(p.vh))},e.\u0275cmp=t.VBU({type:e,selectors:[["app-frota-retorno"]],inputs:{dataCard:"dataCard",kmRetornoControl:"kmRetornoControl",dataRetornoControl:"dataRetornoControl",tipoAcompanhanteRetorno:"tipoAcompanhanteRetorno",saveAcompanhanteFrota:"saveAcompanhanteFrota"},standalone:!0,features:[t.Jv_([p.vh]),t.aNF],decls:16,vars:12,consts:[[3,"hideButtonActions","data","isFinished"],["position","floating"],["type","number",3,"formControl"],["color","danger",4,"ngIf"],[3,"ngModelChange","click","readonly","ngModel"],[3,"tipoAcompanhanteRetorno","saveAcompanhanteFrota","idFrota"],[1,"modal-data-time",3,"isOpen","backdropDismiss"],["color","danger"],[4,"ngIf"],["slot","start"],[3,"click"],["slot","end"],[3,"click","disabled","strong"],[1,"ion-padding"],["presentation","date-time",3,"formControl"]],template:function(o,n){1&o&&(t.nrm(0,"app-card",0),t.j41(1,"ion-grid")(2,"ion-row")(3,"ion-col")(4,"ion-item")(5,"ion-label",1),t.EFF(6,"Km Retorno"),t.k0s(),t.nrm(7,"ion-input",2),t.DNE(8,Tt,3,2,"ion-text",3),t.k0s(),t.j41(9,"ion-item")(10,"ion-label",1),t.EFF(11,"Data e hora de retorno"),t.k0s(),t.j41(12,"ion-input",4),t.mxI("ngModelChange",function(u){return t.DH7(n.showDataRetorno,u)||(n.showDataRetorno=u),u}),t.bIt("click",function(){return n.onOpenModal()}),t.k0s()(),t.nrm(13,"app-frota-acompanhantes",5),t.j41(14,"ion-modal",6),t.DNE(15,Ot,12,3,"ng-template"),t.k0s()()()()),2&o&&(t.Y8G("hideButtonActions",!0)("data",n.dataCard)("isFinished",!0),t.R7$(7),t.Y8G("formControl",n.kmRetornoControl),t.R7$(),t.Y8G("ngIf",(null==n.kmRetornoControl?null:n.kmRetornoControl.invalid)&&(null==n.kmRetornoControl?null:n.kmRetornoControl.touched)),t.R7$(4),t.Y8G("readonly",!0),t.R50("ngModel",n.showDataRetorno),t.R7$(),t.Y8G("tipoAcompanhanteRetorno",n.tipoAcompanhanteRetorno)("saveAcompanhanteFrota",n.saveAcompanhanteFrota)("idFrota",n.dataCard.id),t.R7$(),t.Y8G("isOpen",n.openModal)("backdropDismiss",!1))},dependencies:[i.bv,i.Jm,i.QW,i.hU,i.W9,i.A9,i.lO,i.eU,i.$w,i.uz,i.he,i.ln,i.IO,i.BC,i.ai,i.Sb,i.su,i.Je,i.Gw,p.MD,p.bT,Gt.i,c.X1,c.BC,c.l_,c.YN,c.vS,y]}),s})();var Dt=m(9457),Et=m(2177);let $t=(()=>{var e;class s{constructor(o){this.fb=o}createSaidaFrotaForm(){return this.fb.group({dataHoraSaida:[null,c.k0.required],imobilizadoCod:[null,c.k0.required],destinoSeq:[null,c.k0.required],quilometragemNaSaida:[null,[c.k0.required,c.k0.min(1)]],motivoSeq:[null,c.k0.required],funcCod:[null,c.k0.required],obs:[""]})}addRetornoControls(o,n){o.addControl("quilometragemNoRetorno",new c.MJ(n+1,[c.k0.required,c.k0.min(null!=n?n:1)])),o.addControl("dataHoraRetorno",new c.MJ(new Date,c.k0.required))}}return(e=s).\u0275fac=function(o){return new(o||e)(t.KVO(c.ok))},e.\u0275prov=t.jDH({token:e,factory:e.\u0275fac,providedIn:"root"}),s})();function Vt(e,s){if(1&e&&(t.qex(0),t.nrm(1,"app-frota-retorno",11),t.bVm()),2&e){const a=t.XpG();t.R7$(),t.Y8G("dataCard",a.dataSharedCard)("kmRetornoControl",a.form.controls.quilometragemNoRetorno)("dataRetornoControl",a.form.controls.dataHoraRetorno)("tipoAcompanhanteRetorno",a.isClose)("saveAcompanhanteFrota",a.sendSaidaIdForAcompanhante)}}function Xt(e,s){if(1&e&&(t.qex(0),t.nrm(1,"app-frota-veiculo",19),t.bVm()),2&e){const a=t.XpG(2);t.R7$(),t.Y8G("control",a.form.controls.imobilizadoCod)("withoutRoutesOpen",!1)}}function Nt(e,s){if(1&e&&(t.qex(0),t.nrm(1,"app-frota-veiculo",13),t.bVm()),2&e){const a=t.XpG(2);t.R7$(),t.Y8G("control",a.form.controls.imobilizadoCod)}}function Yt(e,s){1&e&&(t.j41(0,"span"),t.EFF(1,"Campo obrigat\xf3rio."),t.k0s())}function wt(e,s){1&e&&(t.j41(0,"span"),t.EFF(1,"O Km de sa\xedda deve ser maior que 0."),t.k0s())}function Pt(e,s){if(1&e&&(t.j41(0,"ion-text",20),t.DNE(1,Yt,2,0,"span",10)(2,wt,2,0,"span",10),t.k0s()),2&e){let a,o;const n=t.XpG(2);t.R7$(),t.Y8G("ngIf",null==(a=n.form.get("quilometragemNaSaida"))||null==a.errors?null:a.errors.required),t.R7$(),t.Y8G("ngIf",null==(o=n.form.get("quilometragemNaSaida"))||null==o.errors?null:o.errors.min)}}function Ut(e,s){if(1&e&&(t.qex(0),t.j41(1,"ion-grid",12)(2,"ion-row")(3,"ion-col"),t.nrm(4,"app-frota-motorista",13),t.DNE(5,Xt,2,2,"ng-container",10)(6,Nt,2,1,"ng-container",10),t.nrm(7,"app-frota-destino",13),t.j41(8,"ion-item")(9,"ion-label",14),t.EFF(10,"Km Sa\xedda"),t.k0s(),t.nrm(11,"ion-input",15),t.DNE(12,Pt,3,2,"ion-text",16),t.k0s(),t.nrm(13,"app-frota-motivo",13),t.j41(14,"ion-item")(15,"ion-label",14),t.EFF(16,"Observa\xe7\xf5es"),t.k0s(),t.nrm(17,"ion-textarea",17),t.k0s(),t.nrm(18,"app-frota-acompanhantes",18),t.k0s()()(),t.bVm()),2&e){let a;const o=t.XpG();t.R7$(),t.Y8G("formGroup",o.form),t.R7$(3),t.Y8G("control",o.form.controls.funcCod),t.R7$(),t.Y8G("ngIf",o.id),t.R7$(),t.Y8G("ngIf",!o.id),t.R7$(),t.Y8G("control",o.form.controls.destinoSeq),t.R7$(5),t.Y8G("ngIf",(null==(a=o.form.get("quilometragemNaSaida"))?null:a.invalid)&&(null==(a=o.form.get("quilometragemNaSaida"))?null:a.touched)),t.R7$(),t.Y8G("control",o.form.controls.motivoSeq),t.R7$(5),t.Y8G("tipoAcompanhanteRetorno",o.isClose)("saveAcompanhanteFrota",o.sendSaidaIdForAcompanhante)("idFrota",o.id)}}let Lt=(()=>{var e;class s{constructor(o,n,r,u,d,g,F,Jt,qt){this.fb=o,this.frotaSaidaSrv=n,this.loaddingCtrl=r,this.alertCtrl=u,this.router=d,this.route=g,this.dataSharedCardSrv=F,this.identificacaoFuncSrv=Jt,this.frotaSaidaForm=qt,this.id=null,this.sendSaidaIdForAcompanhante=null,this.isClose=!1,this.routeSubscription=null,this.appRoutes=ht.S,this.dataSharedCard=null,this.openModalDataTime=!1,this.changeFuncCodSubscription=null,this.srcFotoMotorista="assets/user.png",this.form=this.frotaSaidaForm.createSaidaFrotaForm()}ngOnInit(){var o=this;return(0,l.A)(function*(){o.updateRouteData(),o.changeFuncCodSubscription=o.form.controls.funcCod.valueChanges.subscribe(function(){var n=(0,l.A)(function*(r){const u=yield o.identificacaoFuncSrv.getImage(r);r&&u&&(o.srcFotoMotorista=yield o.identificacaoFuncSrv.getImage(r)),r||(o.srcFotoMotorista="assets/user.png")});return function(r){return n.apply(this,arguments)}}()),o.routeSubscription=o.router.events.pipe((0,ft.p)(n=>n instanceof f.wF)).subscribe((0,l.A)(function*(){return yield o.updateRouteData()}))})()}updateRouteData(){var o=this;return(0,l.A)(function*(){if(o.id=Number(o.route.snapshot.paramMap.get("id"))||null,o.isClose=o.route.snapshot.url.some(r=>"close"===r.path),o.dataSharedCard=yield o.dataSharedCardSrv.getData(),o.isClose){var n;o.dataSharedCard||(o.dataSharedCard=yield o.dataSharedCardSrv.getData());const r=null===(n=o.dataSharedCard)||void 0===n?void 0:n.quilometragemNaSaida;o.frotaSaidaForm.addRetornoControls(o.form,null!=r?r:1)}o.id&&(o.dataSharedCard||(o.dataSharedCard=yield o.dataSharedCardSrv.getData()),o.dataSharedCard?o.form.patchValue(o.dataSharedCard):o.getDataForEditForm(o.id))})()}getDataForEditForm(o){this.frotaSaidaSrv.getById(o).subscribe(n=>{this.dataSharedCard=n,this.form.patchValue(n)})}onSubmit(){var o=this;return(0,l.A)(function*(){var n,r;o.id||o.isClose||null===(n=o.form.get("dataHoraSaida"))||void 0===n||n.setValue(new Date),o.form.valid&&(yield(0,T.h)(o.loaddingCtrl,o.alertCtrl,{mainAction:(r=(0,l.A)(function*(){const u=o.form.value;if(o.isClose||o.id){const d=yield(0,C._)(o.frotaSaidaSrv.update(o.id,u));o.sendSaidaIdForAcompanhante=null==d?void 0:d.id}else{const d=yield(0,C._)(o.frotaSaidaSrv.save(u));o.sendSaidaIdForAcompanhante=null==d?void 0:d.id}}),function(){return r.apply(this,arguments)}),onAfterTryDismiss:()=>o.router.navigate([o.appRoutes.list.path]),onError:r=>console.error("Erro ao salvar:",r)}))})()}msgCloseForm(){var o=this;return(0,l.A)(function*(){const n=yield o.alertCtrl.create({header:"Sair do cadastro de rota",message:"Voc\xea tem certeza que quer sair do cadastro de rota? Ao sair, suas modifica\xe7\xf5es ser\xe3o perdidas!",buttons:[{text:"Continuar nesta Tela",role:"cancel"},{text:"Sair",handler:()=>o.router.navigate(["/home"])}]});o.form.dirty?yield n.present():o.router.navigate(["/home"])})()}ngOnDestroy(){var o;null===(o=this.routeSubscription)||void 0===o||o.unsubscribe()}}return(e=s).\u0275fac=function(o){return new(o||e)(t.rXU(c.ok),t.rXU(Dt.g),t.rXU(i.Xi),t.rXU(i.hG),t.rXU(f.Ix),t.rXU(f.nX),t.rXU(Et.w),t.rXU(j._),t.rXU($t))},e.\u0275cmp=t.VBU({type:e,selectors:[["app-form"]],standalone:!0,features:[t.aNF],decls:19,vars:6,consts:[[3,"translucent"],["color","primary"],["slot","start"],["color","light",3,"click"],["slot","end"],[3,"fullscreen"],[1,"box-content"],[1,"ion-justify-content-center","ion-align-items-center"],["size","auto"],["alt","Foto de perfil",3,"src"],[4,"ngIf"],[3,"dataCard","kmRetornoControl","dataRetornoControl","tipoAcompanhanteRetorno","saveAcompanhanteFrota"],[3,"formGroup"],[3,"control"],["position","floating"],["type","number","formControlName","quilometragemNaSaida"],["color","danger",4,"ngIf"],["formControlName","obs"],[3,"tipoAcompanhanteRetorno","saveAcompanhanteFrota","idFrota"],[3,"control","withoutRoutesOpen"],["color","danger"]],template:function(o,n){1&o&&(t.j41(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-buttons",2)(3,"ion-button",3),t.bIt("click",function(){return n.msgCloseForm()}),t.EFF(4,"Sair"),t.k0s()(),t.j41(5,"ion-title"),t.EFF(6),t.k0s(),t.j41(7,"ion-buttons",4)(8,"ion-button",3),t.bIt("click",function(){return n.onSubmit()}),t.EFF(9,"Salvar"),t.k0s()()()(),t.j41(10,"ion-content",5)(11,"div",6)(12,"ion-grid")(13,"ion-row",7)(14,"ion-col",8)(15,"ion-avatar"),t.nrm(16,"img",9),t.k0s()()()(),t.DNE(17,Vt,2,5,"ng-container",10)(18,Ut,19,10,"ng-container",10),t.k0s()()),2&o&&(t.Y8G("translucent",!0),t.R7$(6),t.JRh(n.isClose?"Finalizar percurso":n.id?"Editar percurso":"Iniciar percurso"),t.R7$(4),t.Y8G("fullscreen",!0),t.R7$(6),t.Y8G("src",n.srcFotoMotorista,t.B4B),t.R7$(),t.Y8G("ngIf",n.isClose&&!!n.dataSharedCard),t.R7$(),t.Y8G("ngIf",!n.isClose))},dependencies:[p.MD,p.bT,i.bv,i.mC,i.Jm,i.QW,i.hU,i.W9,i.lO,i.eU,i.$w,i.uz,i.he,i.ln,i.IO,i.nc,i.BC,i.ai,i.su,i.Gw,f.iI,c.X1,c.BC,c.cb,c.j4,c.JD,y,mt,pt,_t,jt,c.YN,xt],styles:["[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .box-content[_ngcontent-%COMP%]{display:block;max-width:800px;margin:0 auto}[_nghost-%COMP%]   ion-avatar[_ngcontent-%COMP%]{height:200px;width:200px}[_nghost-%COMP%]   ion-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{object-fit:contain}"]}),s})()}}]);