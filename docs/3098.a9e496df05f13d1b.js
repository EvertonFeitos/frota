"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3098],{5083:(Et,et,C)=>{C.d(et,{E_:()=>Q,F3:()=>$,I9:()=>G});var d=C(467);typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"&&global;var j=function(m){return m.Unimplemented="UNIMPLEMENTED",m.Unavailable="UNAVAILABLE",m}(j||{});class G extends Error{constructor(c,u,_){super(c),this.message=c,this.code=u,this.data=_}}const vt=m=>{var c,u,_,g,p;const A=m.CapacitorCustomPlatform||null,v=m.Capacitor||{},P=v.Plugins=v.Plugins||{},R=m.CapacitorPlatforms,K=(null===(c=null==R?void 0:R.currentPlatform)||void 0===c?void 0:c.getPlatform)||(()=>null!==A?A.name:(m=>{var c,u;return null!=m&&m.androidBridge?"android":null!==(u=null===(c=null==m?void 0:m.webkit)||void 0===c?void 0:c.messageHandlers)&&void 0!==u&&u.bridge?"ios":"web"})(m)),yt=(null===(u=null==R?void 0:R.currentPlatform)||void 0===u?void 0:u.isNativePlatform)||(()=>"web"!==K()),Rt=(null===(_=null==R?void 0:R.currentPlatform)||void 0===_?void 0:_.isPluginAvailable)||(k=>{const S=st.get(k);return!!(null!=S&&S.platforms.has(K())||ft(k))}),ft=(null===(g=null==R?void 0:R.currentPlatform)||void 0===g?void 0:g.getPluginHeader)||(k=>{var S;return null===(S=v.PluginHeaders)||void 0===S?void 0:S.find(V=>V.name===k)}),st=new Map,_t=(null===(p=null==R?void 0:R.currentPlatform)||void 0===p?void 0:p.registerPlugin)||((k,S={})=>{const V=st.get(k);if(V)return console.warn(`Capacitor plugin "${k}" already registered. Cannot register plugins twice.`),V.proxy;const X=K(),Y=ft(k);let x;const ht=function(){var M=(0,d.A)(function*(){return!x&&X in S?x=x="function"==typeof S[X]?yield S[X]():S[X]:null!==A&&!x&&"web"in S&&(x=x="function"==typeof S.web?yield S.web():S.web),x});return function(){return M.apply(this,arguments)}}(),lt=M=>{let E;const D=(...L)=>{const U=ht().then(T=>{const N=((M,E)=>{var D,L;if(!Y){if(M)return null===(L=M[E])||void 0===L?void 0:L.bind(M);throw new G(`"${k}" plugin is not implemented on ${X}`,j.Unimplemented)}{const U=null==Y?void 0:Y.methods.find(T=>E===T.name);if(U)return"promise"===U.rtype?T=>v.nativePromise(k,E.toString(),T):(T,N)=>v.nativeCallback(k,E.toString(),T,N);if(M)return null===(D=M[E])||void 0===D?void 0:D.bind(M)}})(T,M);if(N){const nt=N(...L);return E=null==nt?void 0:nt.remove,nt}throw new G(`"${k}.${M}()" is not implemented on ${X}`,j.Unimplemented)});return"addListener"===M&&(U.remove=(0,d.A)(function*(){return E()})),U};return D.toString=()=>`${M.toString()}() { [capacitor code] }`,Object.defineProperty(D,"name",{value:M,writable:!1,configurable:!1}),D},ut=lt("addListener"),gt=lt("removeListener"),Pt=(M,E)=>{const D=ut({eventName:M},E),L=function(){var T=(0,d.A)(function*(){const N=yield D;gt({eventName:M,callbackId:N},E)});return function(){return T.apply(this,arguments)}}(),U=new Promise(T=>D.then(()=>T({remove:L})));return U.remove=(0,d.A)(function*(){console.warn("Using addListener() without 'await' is deprecated."),yield L()}),U},dt=new Proxy({},{get(M,E){switch(E){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return Y?Pt:ut;case"removeListener":return gt;default:return lt(E)}}});return P[k]=dt,st.set(k,{name:k,proxy:dt,platforms:new Set([...Object.keys(S),...Y?[X]:[]])}),dt});return v.convertFileSrc||(v.convertFileSrc=k=>k),v.getPlatform=K,v.handleError=k=>m.console.error(k),v.isNativePlatform=yt,v.isPluginAvailable=Rt,v.pluginMethodNoop=(k,S,V)=>Promise.reject(`${V} does not have an implementation of "${S}".`),v.registerPlugin=_t,v.Exception=G,v.DEBUG=!!v.DEBUG,v.isLoggingEnabled=!!v.isLoggingEnabled,v.platform=v.getPlatform(),v.isNative=v.isNativePlatform(),v},H=(m=>m.Capacitor=vt(m))(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),$=H.registerPlugin;class Q{constructor(c){this.listeners={},this.retainedEventArguments={},this.windowListeners={},c&&(console.warn(`Capacitor WebPlugin "${c.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=c)}addListener(c,u){var _=this;let g=!1;this.listeners[c]||(this.listeners[c]=[],g=!0),this.listeners[c].push(u);const A=this.windowListeners[c];A&&!A.registered&&this.addWindowListener(A),g&&this.sendRetainedArgumentsForEvent(c);const v=function(){var R=(0,d.A)(function*(){return _.removeListener(c,u)});return function(){return R.apply(this,arguments)}}();return Promise.resolve({remove:v})}removeAllListeners(){var c=this;return(0,d.A)(function*(){c.listeners={};for(const u in c.windowListeners)c.removeWindowListener(c.windowListeners[u]);c.windowListeners={}})()}notifyListeners(c,u,_){const g=this.listeners[c];if(g)g.forEach(p=>p(u));else if(_){let p=this.retainedEventArguments[c];p||(p=[]),p.push(u),this.retainedEventArguments[c]=p}}hasListeners(c){return!!this.listeners[c].length}registerWindowListener(c,u){this.windowListeners[u]={registered:!1,windowEventName:c,pluginEventName:u,handler:_=>{this.notifyListeners(u,_)}}}unimplemented(c="not implemented"){return new H.Exception(c,j.Unimplemented)}unavailable(c="not available"){return new H.Exception(c,j.Unavailable)}removeListener(c,u){var _=this;return(0,d.A)(function*(){const g=_.listeners[c];if(!g)return;const p=g.indexOf(u);_.listeners[c].splice(p,1),_.listeners[c].length||_.removeWindowListener(_.windowListeners[c])})()}addWindowListener(c){window.addEventListener(c.windowEventName,c.handler),c.registered=!0}removeWindowListener(c){c&&(window.removeEventListener(c.windowEventName,c.handler),c.registered=!1)}sendRetainedArgumentsForEvent(c){const u=this.retainedEventArguments[c];u&&(delete this.retainedEventArguments[c],u.forEach(_=>{this.notifyListeners(c,_)}))}}const q=m=>encodeURIComponent(m).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),ot=m=>m.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class mt extends Q{getCookies(){return(0,d.A)(function*(){const c=document.cookie,u={};return c.split(";").forEach(_=>{if(_.length<=0)return;let[g,p]=_.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");g=ot(g).trim(),p=ot(p).trim(),u[g]=p}),u})()}setCookie(c){return(0,d.A)(function*(){try{const u=q(c.key),_=q(c.value),g=`; expires=${(c.expires||"").replace("expires=","")}`,p=(c.path||"/").replace("path=",""),A=null!=c.url&&c.url.length>0?`domain=${c.url}`:"";document.cookie=`${u}=${_||""}${g}; path=${p}; ${A};`}catch(u){return Promise.reject(u)}})()}deleteCookie(c){return(0,d.A)(function*(){try{document.cookie=`${c.key}=; Max-Age=0`}catch(u){return Promise.reject(u)}})()}clearCookies(){return(0,d.A)(function*(){try{const c=document.cookie.split(";")||[];for(const u of c)document.cookie=u.replace(/^ +/,"").replace(/=.*/,`=;expires=${(new Date).toUTCString()};path=/`)}catch(c){return Promise.reject(c)}})()}clearAllCookies(){var c=this;return(0,d.A)(function*(){try{yield c.clearCookies()}catch(u){return Promise.reject(u)}})()}}$("CapacitorCookies",{web:()=>new mt});const rt=function(){var m=(0,d.A)(function*(c){return new Promise((u,_)=>{const g=new FileReader;g.onload=()=>{const p=g.result;u(p.indexOf(",")>=0?p.split(",")[1]:p)},g.onerror=p=>_(p),g.readAsDataURL(c)})});return function(u){return m.apply(this,arguments)}}();class Ft extends Q{request(c){return(0,d.A)(function*(){const u=((m,c={})=>{const u=Object.assign({method:m.method||"GET",headers:m.headers},c),g=((m={})=>{const c=Object.keys(m);return Object.keys(m).map(g=>g.toLocaleLowerCase()).reduce((g,p,A)=>(g[p]=m[c[A]],g),{})})(m.headers)["content-type"]||"";if("string"==typeof m.data)u.body=m.data;else if(g.includes("application/x-www-form-urlencoded")){const p=new URLSearchParams;for(const[A,v]of Object.entries(m.data||{}))p.set(A,v);u.body=p.toString()}else if(g.includes("multipart/form-data")||m.data instanceof FormData){const p=new FormData;if(m.data instanceof FormData)m.data.forEach((v,P)=>{p.append(P,v)});else for(const v of Object.keys(m.data))p.append(v,m.data[v]);u.body=p;const A=new Headers(u.headers);A.delete("content-type"),u.headers=A}else(g.includes("application/json")||"object"==typeof m.data)&&(u.body=JSON.stringify(m.data));return u})(c,c.webFetchExtra),_=((m,c=!0)=>m?Object.entries(m).reduce((_,g)=>{const[p,A]=g;let v,P;return Array.isArray(A)?(P="",A.forEach(R=>{v=c?encodeURIComponent(R):R,P+=`${p}=${v}&`}),P.slice(0,-1)):(v=c?encodeURIComponent(A):A,P=`${p}=${v}`),`${_}&${P}`},"").substr(1):null)(c.params,c.shouldEncodeUrlParams),g=_?`${c.url}?${_}`:c.url,p=yield fetch(g,u),A=p.headers.get("content-type")||"";let P,R,{responseType:v="text"}=p.ok?c:{};switch(A.includes("application/json")&&(v="json"),v){case"arraybuffer":case"blob":R=yield p.blob(),P=yield rt(R);break;case"json":P=yield p.json();break;default:P=yield p.text()}const tt={};return p.headers.forEach((K,it)=>{tt[it]=K}),{data:P,headers:tt,status:p.status,url:p.url}})()}get(c){var u=this;return(0,d.A)(function*(){return u.request(Object.assign(Object.assign({},c),{method:"GET"}))})()}post(c){var u=this;return(0,d.A)(function*(){return u.request(Object.assign(Object.assign({},c),{method:"POST"}))})()}put(c){var u=this;return(0,d.A)(function*(){return u.request(Object.assign(Object.assign({},c),{method:"PUT"}))})()}patch(c){var u=this;return(0,d.A)(function*(){return u.request(Object.assign(Object.assign({},c),{method:"PATCH"}))})()}delete(c){var u=this;return(0,d.A)(function*(){return u.request(Object.assign(Object.assign({},c),{method:"DELETE"}))})()}}$("CapacitorHttp",{web:()=>new Ft})},3098:(Et,et,C)=>{C.r(et),C.d(et,{FormPage:()=>ie});var d=C(467),F=C(177),h=C(4341),w=C(2902),s=C(4742),t=C(4438),O=C(4843),j=C(3469),G=C(5079),I=C(5873);function vt(n,i){if(1&n&&t.nrm(0,"ion-icon",3),2&n){const a=t.XpG();t.Y8G("name","primary"===a.color?"add-circle":"trash-outline")}}function jt(n,i){if(1&n&&(t.j41(0,"ion-label"),t.EFF(1),t.k0s()),2&n){const a=t.XpG();t.R7$(),t.JRh(a.text)}}let H=(()=>{var n;class i{constructor(){this.color="primary",this.text="",this.disabled=!1,this.slot="end",this.buttonClick=new t.bkB,(0,G.a)({addCircle:I.YH_,trashOutline:I.P1A})}onClick(){this.disabled||this.buttonClick.emit()}}return(n=i).\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.VBU({type:n,selectors:[["app-button-add-remove"]],inputs:{color:"color",text:"text",disabled:"disabled",slot:"slot"},outputs:{buttonClick:"buttonClick"},standalone:!0,features:[t.aNF],decls:3,vars:5,consts:[[3,"click","color","disabled","slot"],["slot","icon-only",3,"name",4,"ngIf"],[4,"ngIf"],["slot","icon-only",3,"name"]],template:function(e,o){1&e&&(t.j41(0,"ion-button",0),t.bIt("click",function(){return o.onClick()}),t.DNE(1,vt,1,1,"ion-icon",1)(2,jt,2,1,"ion-label",2),t.k0s()),2&e&&(t.Y8G("color",o.color)("disabled",o.disabled)("slot",o.slot),t.R7$(),t.Y8G("ngIf",!o.text),t.R7$(),t.Y8G("ngIf",o.text))},dependencies:[F.MD,F.bT,s.bv,s.Jm,s.iq,s.he]}),i})();var $=C(5083);const z=(0,$.F3)("CameraPreview",{web:()=>C.e(2606).then(C.bind(C,2606)).then(n=>new n.CameraPreviewWeb)});let It=(()=>{var n;class i{constructor(e){this.modalCtrl=e}ngOnInit(){}submit(){this.modalCtrl.dismiss(!0)}cancel(){this.modalCtrl.dismiss(!1)}}return(n=i).\u0275fac=function(e){return new(e||n)(t.rXU(s.W3))},n.\u0275cmp=t.VBU({type:n,selectors:[["app-alert"]],inputs:{title:"title",message:"message",cancelLabel:"cancelLabel",okLabel:"okLabel"},standalone:!0,features:[t.aNF],decls:20,vars:4,consts:[[1,"ion-padding","ion-text-center"],[1,"ion-no-padding"],["size","large","expand","full","color","danger",3,"click"],["size","large","expand","full","color","success",3,"click"]],template:function(e,o){1&e&&(t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),t.EFF(3),t.k0s()()(),t.j41(4,"ion-content",0),t.nrm(5,"br")(6,"br")(7,"br")(8,"br"),t.j41(9,"h2"),t.EFF(10),t.k0s()(),t.j41(11,"ion-footer")(12,"ion-grid",1)(13,"ion-row")(14,"ion-col")(15,"ion-button",2),t.bIt("click",function(){return o.cancel()}),t.EFF(16),t.k0s()(),t.j41(17,"ion-col")(18,"ion-button",3),t.bIt("click",function(){return o.submit()}),t.EFF(19),t.k0s()()()()()),2&e&&(t.R7$(3),t.JRh(o.title),t.R7$(7),t.JRh(o.message),t.R7$(6),t.SpI(" ",o.cancelLabel," "),t.R7$(3),t.SpI(" ",o.okLabel," "))},dependencies:[F.MD,s.bv,s.Jm,s.hU,s.W9,s.M0,s.lO,s.eU,s.ln,s.BC,s.ai],styles:["[_nghost-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:24px;font-weight:500}"]}),i})();var Q=C(9769),Z=function(n){return n.Prompt="PROMPT",n.Camera="CAMERA",n.Photos="PHOTOS",n}(Z||{}),q=function(n){return n.Rear="REAR",n.Front="FRONT",n}(q||{}),ot=function(n){return n.Uri="uri",n.Base64="base64",n.DataUrl="dataUrl",n}(ot||{});class mt extends $.E_{getPhoto(i){var a=this;return(0,d.A)(function*(){return new Promise(function(){var e=(0,d.A)(function*(o,r){if(i.webUseInput||i.source===Z.Photos)a.fileInputExperience(i,o,r);else if(i.source===Z.Prompt){let l=document.querySelector("pwa-action-sheet");l||(l=document.createElement("pwa-action-sheet"),document.body.appendChild(l)),l.header=i.promptLabelHeader||"Photo",l.cancelable=!1,l.options=[{title:i.promptLabelPhoto||"From Photos"},{title:i.promptLabelPicture||"Take Picture"}],l.addEventListener("onSelection",function(){var f=(0,d.A)(function*(b){0===b.detail?a.fileInputExperience(i,o,r):a.cameraExperience(i,o,r)});return function(b){return f.apply(this,arguments)}}())}else a.cameraExperience(i,o,r)});return function(o,r){return e.apply(this,arguments)}}())})()}pickImages(i){var a=this;return(0,d.A)(function*(){return new Promise(function(){var e=(0,d.A)(function*(o,r){a.multipleFileInputExperience(o,r)});return function(o,r){return e.apply(this,arguments)}}())})()}cameraExperience(i,a,e){var o=this;return(0,d.A)(function*(){if(customElements.get("pwa-camera-modal")){const r=document.createElement("pwa-camera-modal");r.facingMode=i.direction===q.Front?"user":"environment",document.body.appendChild(r);try{yield r.componentOnReady(),r.addEventListener("onPhoto",function(){var l=(0,d.A)(function*(f){const b=f.detail;null===b?e(new $.I9("User cancelled photos app")):b instanceof Error?e(b):a(yield o._getCameraPhoto(b,i)),r.dismiss(),document.body.removeChild(r)});return function(f){return l.apply(this,arguments)}}()),r.present()}catch{o.fileInputExperience(i,a,e)}}else console.error("Unable to load PWA Element 'pwa-camera-modal'. See the docs: https://capacitorjs.com/docs/web/pwa-elements."),o.fileInputExperience(i,a,e)})()}fileInputExperience(i,a,e){let o=document.querySelector("#_capacitor-camera-input");const r=()=>{var l;null===(l=o.parentNode)||void 0===l||l.removeChild(o)};o||(o=document.createElement("input"),o.id="_capacitor-camera-input",o.type="file",o.hidden=!0,document.body.appendChild(o),o.addEventListener("change",l=>{const f=o.files[0];let b="jpeg";if("image/png"===f.type?b="png":"image/gif"===f.type&&(b="gif"),"dataUrl"===i.resultType||"base64"===i.resultType){const y=new FileReader;y.addEventListener("load",()=>{if("dataUrl"===i.resultType)a({dataUrl:y.result,format:b});else if("base64"===i.resultType){const B=y.result.split(",")[1];a({base64String:B,format:b})}r()}),y.readAsDataURL(f)}else a({webPath:URL.createObjectURL(f),format:b}),r()}),o.addEventListener("cancel",l=>{e(new $.I9("User cancelled photos app")),r()})),o.accept="image/*",o.capture=!0,i.source===Z.Photos||i.source===Z.Prompt?o.removeAttribute("capture"):i.direction===q.Front?o.capture="user":i.direction===q.Rear&&(o.capture="environment"),o.click()}multipleFileInputExperience(i,a){let e=document.querySelector("#_capacitor-camera-input-multiple");const o=()=>{var r;null===(r=e.parentNode)||void 0===r||r.removeChild(e)};e||(e=document.createElement("input"),e.id="_capacitor-camera-input-multiple",e.type="file",e.hidden=!0,e.multiple=!0,document.body.appendChild(e),e.addEventListener("change",r=>{const l=[];for(let f=0;f<e.files.length;f++){const b=e.files[f];let y="jpeg";"image/png"===b.type?y="png":"image/gif"===b.type&&(y="gif"),l.push({webPath:URL.createObjectURL(b),format:y})}i({photos:l}),o()}),e.addEventListener("cancel",r=>{a(new $.I9("User cancelled photos app")),o()})),e.accept="image/*",e.click()}_getCameraPhoto(i,a){return new Promise((e,o)=>{const r=new FileReader,l=i.type.split("/")[1];"uri"===a.resultType?e({webPath:URL.createObjectURL(i),format:l,saved:!1}):(r.readAsDataURL(i),r.onloadend=()=>{const f=r.result;e("dataUrl"===a.resultType?{dataUrl:f,format:l,saved:!1}:{base64String:f.split(",")[1],format:l,saved:!1})},r.onerror=f=>{o(f)})})}checkPermissions(){var i=this;return(0,d.A)(function*(){if(typeof navigator>"u"||!navigator.permissions)throw i.unavailable("Permissions API not available in this browser");try{return{camera:(yield window.navigator.permissions.query({name:"camera"})).state,photos:"granted"}}catch{throw i.unavailable("Camera permissions are not available in this browser")}})()}requestPermissions(){var i=this;return(0,d.A)(function*(){throw i.unimplemented("Not implemented on web.")})()}pickLimitedLibraryPhotos(){var i=this;return(0,d.A)(function*(){throw i.unavailable("Not implemented on web.")})()}getLimitedLibraryPhotos(){var i=this;return(0,d.A)(function*(){throw i.unavailable("Not implemented on web.")})()}}new mt;const rt=(0,$.F3)("Camera",{web:()=>new mt});var pt=C(8880);let Ct=(()=>{var n;class i{constructor(e,o){this.navCtrl=e,this.alertCtrl=o}getCamera(e=!0,o=!1){var r=this;return(0,d.A)(function*(){if(typeof navigator<"u"&&navigator.permissions){const l=yield rt.checkPermissions();(!l.camera||!l.photos)&&(yield rt.requestPermissions({permissions:["photos","camera"]}))}try{return yield rt.getPhoto({quality:70,allowEditing:!1,direction:q.Rear,source:Z.Camera,resultType:e?ot.DataUrl:ot.Uri,width:600,height:600,correctOrientation:!0})}catch(l){throw console.log({err:l}),o&&r.navCtrl.back({animated:!1}),new Error(l.message)}})()}getBlob(e){return new Promise((o,r)=>{const l=new XMLHttpRequest;l.onload=()=>{o(l.response)},l.onerror=()=>{r(new Error("uriToBlob failed"))},l.responseType="blob",l.open("GET",e,!0),l.send(null)})}}return(n=i).\u0275fac=function(e){return new(e||n)(t.KVO(pt.q9),t.KVO(s.hG))},n.\u0275prov=t.jDH({token:n,factory:n.\u0275fac,providedIn:"root"}),i})();var bt=C(4401);let Ft=(()=>{var n;class i{constructor(e,o,r,l,f){this.api=e,this.cameraService=o,this.alertCtrl=r,this.faceService=l,this.loadingCtrl=f,this.fotos=[]}hashEncode(e){return btoa(String.fromCharCode(...new Uint8Array(e.buffer)))}hashDecode(e){return new Float32Array(new Uint8Array([...atob(e)].map(o=>o.charCodeAt(0))).buffer)}takePhoto(e){var o=this;return(0,d.A)(function*(){const r=yield o.loadingCtrl.create();try{const l=yield o.cameraService.getCamera(!0);yield r.present();const f=yield o.faceService.getFaceCrop(l.dataUrl);if(yield r.dismiss(),f.face){console.log("TAKE FOTO",{face:f});const y={hash:o.hashEncode(f.descriptor),funcionario:e};console.log({identificacao:y});const B=yield(0,O._)(o.api.save(y));return console.log({result:B}),!0}return!1}catch(l){console.log({error:l}),yield r.dismiss()}return!1})()}previewCamera(e){var o=this;return new Promise(function(){var r=(0,d.A)(function*(l,f){try{let b;console.log("\u{1f535} Iniciando preview da c\xe2mera..."),b=e?{position:e,className:"camera-preview",parent:"content"}:{position:"front",className:"camera-preview",parent:"content"},console.log("\u{1f4f7} Configura\xe7\xf5es da c\xe2mera:",b),yield z.start(b),console.log("\u2705 C\xe2mera iniciada com sucesso!");const y=yield o.loadingCtrl.create({spinner:null,message:"Foto em: 3s",showBackdrop:!1,translucent:!0});console.log("\u23f3 Loader criado..."),yield y.present(),console.log("\u2705 Loader exibido"),setTimeout((0,d.A)(function*(){console.log("\u23f3 Mudando mensagem do loader: Foto em 2s"),y.message="Foto em: 2s"}),1e3),setTimeout((0,d.A)(function*(){console.log("\u23f3 Mudando mensagem do loader: Foto em 1s"),y.message="Foto em: 1s"}),2e3),setTimeout((0,d.A)(function*(){console.log("\u{1f534} Capturando imagem..."),yield y.dismiss(),console.log("\u2705 Loader fechado");try{const B=yield z.captureSample({});console.log("\u{1f4f8} Foto capturada com sucesso!",B),z.stop(),console.log("\u{1f6d1} C\xe2mera parada"),l(B.value)}catch(B){console.error("\u274c Erro ao capturar imagem:",B),f(B)}}),3e3)}catch(b){console.error("\u274c Erro ao iniciar preview da c\xe2mera:",b),z.stop(),f(b)}});return function(l,f){return r.apply(this,arguments)}}())}scan(e){var o=this;return(0,d.A)(function*(){const r=yield o.loadingCtrl.create();try{yield r.present();const l=yield o.previewCamera(e);if(console.log("Preview Camera Data:",l),!l)throw new Error("Falha ao capturar imagem da c\xe2mera");const f=yield o.faceService.getFaceCrop(`data:image/jpeg;base64,${l}`);if(console.log("Face Crop Result:",f),yield r.dismiss(),null==f||!f.face)return z.stop(),!1;const b=yield o.loadingCtrl.create();yield b.present();let y=null;const B=yield(0,O._)(o.api.getAll());console.log("IDs recuperados:",B);const at=B.map(W=>{try{const J=o.hashDecode(null==W?void 0:W.hash);return J.length>0?{descriptor:J,funcionario:W.funcionario}:{descriptor:!1,funcionario:W.funcionario}}catch(J){return console.error("Erro ao decodificar hash:",J),{descriptor:!1,funcionario:W.funcionario}}});console.log("Quantidade de fotos:",null==at?void 0:at.length);for(const[W,J]of at.entries()){if(!J.descriptor)continue;console.log("Verificando foto:",W);const Ot=yield o.faceService.matchDescriptors(J.descriptor,f.descriptor);if(console.log("Match Ratio:",Ot),Ot<.5){console.log("Match encontrado:",W),y=J.funcionario;break}}return yield b.dismiss(),!!y&&{funcionario:y,face:f.face}}catch(l){return console.error("Erro durante o scan:",l),!1}finally{yield r.dismiss()}})()}}return(n=i).\u0275fac=function(e){return new(e||n)(t.KVO(Q._),t.KVO(Ct),t.KVO(s.hG),t.KVO(bt.R),t.KVO(s.Xi))},n.\u0275prov=t.jDH({token:n,factory:n.\u0275fac,providedIn:"root"}),i})();var Bt=C(9684);function m(n,i){1&n&&(t.qex(0),t.j41(1,"ion-row",3)(2,"ion-col",4),t.nrm(3,"ion-spinner",5),t.j41(4,"p"),t.EFF(5,"Carregando foto da c\xe2mera..."),t.k0s()()(),t.bVm())}function c(n,i){if(1&n){const a=t.RV6();t.j41(0,"ion-card",9),t.bIt("click",function(){t.eBV(a);const o=t.XpG(2);return t.Njj(o.emitResult())}),t.nrm(1,"ion-img",10),t.j41(2,"ion-card-header")(3,"ion-card-title"),t.EFF(4),t.k0s()()()}if(2&n){const a=t.XpG(2);t.R7$(),t.Y8G("src",a.scanResult.face),t.R7$(3),t.SpI(" ",a.scanResult.funcionario.name||"Motorista n\xe3o identificado"," ")}}function u(n,i){if(1&n&&(t.j41(0,"ion-row",6)(1,"ion-col",7),t.DNE(2,c,5,2,"ion-card",8),t.k0s()()),2&n){const a=t.XpG();t.R7$(2),t.Y8G("ngIf",a.scanResult)}}let _=(()=>{var n;class i{constructor(e,o,r,l){this.modalCtrl=e,this.fotos=o,this.navCtrl=r,this.baseApi=l,this.options={},this.loadingCamera=!0,this.getResultLeitorFacial=new t.bkB,this.cancelBuscaFacial=new t.bkB,(0,G.a)({keypadOutline:I.BSR,cameraOutline:I.GOB,cameraReverseOutline:I.O33})}ngOnInit(){this.iniciarCamera()}ngOnChanges(e){e.modoBuscaManualAtivo&&(this.modoBuscaManualAtivo||this.pararCamera())}iniciarCamera(){var e=this;return(0,d.A)(function*(){e.baseApi.positionCamera$.subscribe(function(){var o=(0,d.A)(function*(r){r&&(yield e.scan(r))});return function(r){return o.apply(this,arguments)}}())})()}pararCamera(){return(0,d.A)(function*(){yield z.stop()})()}scan(e){var o=this;return(0,d.A)(function*(){o.loadingCamera=!0;const r=yield o.fotos.scan(e);if(o.loadingCamera=!1,!r){o.scanResult=!1;const l=yield o.modalCtrl.create({component:It,componentProps:{title:"Erro",message:"N\xe3o conseguimos identificar a foto. Gostaria de tentar novamente?",okLabel:"Tentar novamente",cancelLabel:"Busca manual"}});return yield l.present(),(yield l.onDidDismiss()).data?o.scan():(o.pararCamera(),void o.cancelBuscaFacial.emit())}o.scanResult=r})()}recarregarCamera(){var e=this;return(0,d.A)(function*(){yield e.pararCamera(),e.scanResult=void 0,yield e.iniciarCamera()})()}emitResult(){this.getResultLeitorFacial.emit(this.scanResult),this.loadingCamera=!0,this.scanResult=!1}stopCamera(){var e=this;return(0,d.A)(function*(){yield e.pararCamera()})()}}return(n=i).\u0275fac=function(e){return new(e||n)(t.rXU(s.W3),t.rXU(Ft),t.rXU(pt.q9),t.rXU(Bt.v))},n.\u0275cmp=t.VBU({type:n,selectors:[["app-leitor-facial"]],inputs:{modoBuscaManualAtivo:"modoBuscaManualAtivo"},outputs:{getResultLeitorFacial:"getResultLeitorFacial",cancelBuscaFacial:"cancelBuscaFacial"},standalone:!0,features:[t.OA$,t.aNF],decls:5,vars:2,consts:[["scanContent",""],["id","content",1,"ion-padding"],[4,"ngIf","ngIfElse"],[1,"ion-justify-content-center","ion-align-items-center"],[1,"ion-text-center"],["name","crescent"],[1,"ion-justify-content-center"],["size","12",1,"ion-text-center"],["class","image-card",3,"click",4,"ngIf"],[1,"image-card",3,"click"],[3,"src"]],template:function(e,o){if(1&e&&(t.j41(0,"ion-content",1)(1,"ion-grid"),t.DNE(2,m,6,0,"ng-container",2)(3,u,3,1,"ng-template",null,0,t.C5r),t.k0s()()),2&e){const r=t.sdS(4);t.R7$(2),t.Y8G("ngIf",o.loadingCamera)("ngIfElse",r)}},dependencies:[F.MD,F.bT,s.bv,s.b_,s.ME,s.tN,s.hU,s.W9,s.lO,s.KW,s.ln,s.w2]}),i})();var g=C(2705),p=C(3459);const A=n=>({"ion-hide":n});function v(n,i){1&n&&t.eu8(0)}function P(n,i){1&n&&t.eu8(0)}function R(n,i){if(1&n){const a=t.RV6();t.j41(0,"ion-button",15),t.bIt("click",function(){t.eBV(a);const o=t.XpG(2);return t.Njj(o.modoBuscaManual=!0)}),t.nrm(1,"ion-icon",16),t.k0s()}}function tt(n,i){if(1&n){const a=t.RV6();t.j41(0,"ion-button",15),t.bIt("click",function(){t.eBV(a);const o=t.XpG(2);return t.Njj(o.modoBuscaManual=!1)}),t.nrm(1,"ion-icon",17),t.k0s()}}function K(n,i){if(1&n){const a=t.RV6();t.j41(0,"div",18)(1,"app-leitor-facial",19),t.bIt("cancelBuscaFacial",function(){t.eBV(a);const o=t.XpG(2);return t.Njj(o.modoBuscaManual=!0)})("getResultLeitorFacial",function(o){t.eBV(a);const r=t.XpG(2);return t.Njj(r.resultLeitorFacial(o))}),t.k0s()()}if(2&n){const a=t.XpG(2);t.R7$(),t.Y8G("modoBuscaManualAtivo",a.modoBuscaManual)}}function it(n,i){if(1&n){const a=t.RV6();t.j41(0,"ion-item",8),t.bIt("click",function(){const o=t.eBV(a).$implicit,r=t.XpG(4);return t.Njj(r.adicionarAcompanhante(o))}),t.EFF(1),t.k0s()}if(2&n){const a=i.$implicit;t.R7$(),t.SpI(" ",a.name," ")}}function yt(n,i){if(1&n&&(t.j41(0,"ion-list"),t.DNE(1,it,2,1,"ion-item",23),t.k0s()),2&n){const a=t.XpG(3);t.R7$(),t.Y8G("ngForOf",a.acompanhantesFiltrados)}}function At(n,i){if(1&n){const a=t.RV6();t.j41(0,"div",20)(1,"ion-item")(2,"ion-searchbar",21),t.mxI("ngModelChange",function(o){t.eBV(a);const r=t.XpG(2);return t.DH7(r.acompanhanteBusca,o)||(r.acompanhanteBusca=o),t.Njj(o)}),t.bIt("ionInput",function(){t.eBV(a);const o=t.XpG(2);return t.Njj(o.buscarAcompanhantes())}),t.k0s()(),t.DNE(3,yt,2,1,"ion-list",22),t.k0s()}if(2&n){const a=t.XpG(2);t.R7$(2),t.R50("ngModel",a.acompanhanteBusca),t.R7$(),t.Y8G("ngIf",a.acompanhantesFiltrados.length>0&&a.acompanhanteBusca)}}function Rt(n,i){1&n&&t.eu8(0)}function kt(n,i){1&n&&t.eu8(0)}function ft(n,i){if(1&n){const a=t.RV6();t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",7)(3,"ion-button",8),t.bIt("click",function(){t.eBV(a);const o=t.XpG();return t.Njj(o.isOpen=!1)}),t.nrm(4,"ion-icon",9),t.k0s()(),t.j41(5,"ion-buttons",10),t.DNE(6,R,2,0,"ion-button",11)(7,tt,2,0,"ion-button",11),t.k0s()()(),t.j41(8,"ion-content",12),t.DNE(9,K,2,1,"div",13)(10,At,4,2,"div",14)(11,Rt,1,0,"ng-container",5)(12,kt,1,0,"ng-container",5),t.k0s()}if(2&n){const a=t.XpG(),e=t.sdS(11),o=t.sdS(13);t.R7$(6),t.Y8G("ngIf",!a.modoBuscaManual),t.R7$(),t.Y8G("ngIf",a.modoBuscaManual),t.R7$(2),t.Y8G("ngIf",!a.modoBuscaManual),t.R7$(),t.Y8G("ngIf",a.modoBuscaManual),t.R7$(),t.Y8G("ngTemplateOutlet",e),t.R7$(),t.Y8G("ngTemplateOutlet",o)}}function St(n,i){if(1&n){const a=t.RV6();t.j41(0,"ion-item")(1,"ion-avatar"),t.nrm(2,"img",25),t.k0s(),t.j41(3,"ion-label"),t.EFF(4),t.k0s(),t.nrm(5,"ion-input",3),t.j41(6,"app-button-add-remove",26),t.bIt("buttonClick",function(){const o=t.eBV(a).$implicit,r=t.XpG(2);return t.Njj(r.removerAcompanhante(o))}),t.k0s()()}if(2&n){const a=i.$implicit,e=t.XpG(2);t.R7$(2),t.Mz_("alt","Foto de acompanhante ",a.name,""),t.Y8G("src",e.fotosAcompanhantesSelecionados[a.id],t.B4B),t.R7$(2),t.JRh(a.name),t.R7$(),t.Y8G("disabled",!0),t.R7$(),t.Y8G("ngClass",t.eq3(6,A,e.isFinished))}}function Mt(n,i){if(1&n&&(t.j41(0,"ion-list"),t.DNE(1,St,7,8,"ion-item",24),t.k0s()),2&n){const a=t.XpG();t.R7$(),t.Y8G("ngForOf",a.acompanhantesSelecionados)}}function st(n,i){1&n&&(t.j41(0,"p",28)(1,"strong"),t.EFF(2,"Nenhum acompanhante selecionado."),t.k0s()())}function wt(n,i){if(1&n&&t.DNE(0,st,3,0,"p",27),2&n){const a=t.XpG();t.Y8G("ngIf",a.acompanhantesSelecionados.length<1)}}let _t=(()=>{var n;class i{constructor(e,o,r){this.funcionarioService=e,this.acompanhanteFrotaSrv=o,this.identificacaoFuncSrv=r,this.modoBuscaManual=!1,this.isOpen=!1,this.acompanhantes=[],this.acompanhanteBusca="",this.acompanhantesFiltrados=[],this.acompanhantesSelecionados=[],this.fotosAcompanhantesSelecionados={},this.tipoAcompanhanteRetorno=!1,this.isFinished=!1,this.statusSaveAcompanhanteFrota=new t.bkB,(0,G.a)({addCircle:I.YH_,keypadOutline:I.BSR,cameraOutline:I.GOB,arrowBack:I.$$C})}ngOnInit(){var e=this;return(0,d.A)(function*(){yield e.carregarAcompanhantes()})()}ngOnChanges(e){var o=this;return(0,d.A)(function*(){if(e.saveAcompanhanteFrota){const r=e.saveAcompanhanteFrota.currentValue;r&&(yield o.submitFrotaAcompanhante(r))}e.idFrota&&o.idFrota&&(yield o.carregarAcompanhantesSelecionados(o.idFrota)),e.tipoAcompanhanteRetorno&&o.idFrota&&(yield o.carregarAcompanhantesSelecionados(o.idFrota))})()}carregarAcompanhantesSelecionados(e){var o=this;return(0,d.A)(function*(){try{let l;l=o.isFinished&&o.tipoAcompanhanteRetorno?yield(0,O._)(o.acompanhanteFrotaSrv.getAll(e,j.E.Retorno)):yield(0,O._)(o.acompanhanteFrotaSrv.getAll(e,j.E.Saida)),yield o.carregarAcompanhantes();const f=o.acompanhantes;o.acompanhantesSelecionados=l.map(b=>f.find(y=>y.id===b.funcCod)).filter(b=>null!=b),o.acompanhantesSelecionados.length>0&&o.acompanhantesSelecionados.forEach(function(){var b=(0,d.A)(function*(y){o.fotosAcompanhantesSelecionados[y.id]=yield o.getPhotoAcompanhante(y.id)});return function(y){return b.apply(this,arguments)}}())}catch(l){console.error("Erro ao carregar acompanhantes selecionados:",l)}})()}carregarAcompanhantes(){var e=this;return(0,d.A)(function*(){const o=e.funcionarioService.getCachedFuncionarios();if(o&&0!==o.length)e.acompanhantes=o;else{const r=yield(0,O._)(e.funcionarioService.getAll());e.acompanhantes=r}})()}buscarAcompanhantes(){const e=this.acompanhanteBusca.toLowerCase();this.acompanhantesFiltrados=this.acompanhantes.filter(o=>o.name.toLowerCase().includes(e)&&!this.acompanhantesSelecionados.some(r=>r.id===o.id))}adicionarAcompanhante(e){var o=this;return(0,d.A)(function*(){o.fotosAcompanhantesSelecionados[e.id]||(o.fotosAcompanhantesSelecionados[e.id]=yield o.getPhotoAcompanhante(e.id)),o.acompanhantesSelecionados.push(e),o.acompanhanteBusca="",o.acompanhantesFiltrados=[]})()}removerAcompanhante(e){this.acompanhantesSelecionados=this.acompanhantesSelecionados.filter(o=>o.id!==e.id)}submitFrotaAcompanhante(e){var o=this;return(0,d.A)(function*(){const r=o.tipoAcompanhanteRetorno?j.E.Retorno:j.E.Saida,l=o.acompanhantesSelecionados.map(f=>({frotaSeq:e,tipo:r,funcCod:f.id}));o.acompanhantesSelecionados.length>0&&(o.idFrota&&!o.tipoAcompanhanteRetorno?o.acompanhanteFrotaSrv.update(o.idFrota,j.E.Saida,l).subscribe({next:()=>{o.statusSaveAcompanhanteFrota.emit(!0)},error:f=>{o.statusSaveAcompanhanteFrota.emit(!1)}}):o.acompanhanteFrotaSrv.save(l).subscribe({next:()=>{o.statusSaveAcompanhanteFrota.emit(!0)},error:f=>{o.statusSaveAcompanhanteFrota.emit(!1)}}))})()}resultLeitorFacial(e){this.fotosAcompanhantesSelecionados[e.funcionario.id]=e.face,this.acompanhantesSelecionados.push(e.funcionario)}getPhotoAcompanhante(e){var o=this;return(0,d.A)(function*(){const r=yield o.identificacaoFuncSrv.getImage(e);return e&&r?r:"assets/user.png"})()}}return(n=i).\u0275fac=function(e){return new(e||n)(t.rXU(g.r),t.rXU(p.H),t.rXU(Q._))},n.\u0275cmp=t.VBU({type:n,selectors:[["app-frota-acompanhantes"]],inputs:{tipoAcompanhanteRetorno:"tipoAcompanhanteRetorno",saveAcompanhanteFrota:"saveAcompanhanteFrota",idFrota:"idFrota",isFinished:"isFinished"},outputs:{statusSaveAcompanhanteFrota:"statusSaveAcompanhanteFrota"},standalone:!0,features:[t.OA$,t.aNF],decls:14,vars:7,consts:[["listaAcompanhantesSelecionados",""],["mensagensAcompanhantes",""],[1,"ion-justify-content-center","ion-align-items-center"],[2,"width","0","height","0",3,"disabled"],["color","primary",3,"buttonClick","ngClass"],[4,"ngTemplateOutlet"],[3,"isOpen"],["slot","start"],[3,"click"],["slot","icon-only","name","arrow-back","color","primary"],["slot","end"],["fill","clear",3,"click",4,"ngIf"],[1,"ion-padding"],["class","busca-facial",4,"ngIf"],["class","busca-manual",4,"ngIf"],["fill","clear",3,"click"],["name","keypad-outline"],["name","camera-outline","color","primary"],[1,"busca-facial"],[3,"cancelBuscaFacial","getResultLeitorFacial","modoBuscaManualAtivo"],[1,"busca-manual"],["placeholder","Buscar Acompanhante",3,"ngModelChange","ionInput","ngModel"],[4,"ngIf"],[3,"click",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[3,"src","alt"],["color","danger",3,"buttonClick","ngClass"],["class","ion-text-center",4,"ngIf"],[1,"ion-text-center"]],template:function(e,o){if(1&e){const r=t.RV6();t.j41(0,"ion-list")(1,"ion-item",2)(2,"ion-label"),t.EFF(3,"Acompanhante(s) selecionado(s)"),t.k0s(),t.nrm(4,"ion-input",3),t.j41(5,"app-button-add-remove",4),t.bIt("buttonClick",function(){return t.eBV(r),t.Njj(o.isOpen=!0)}),t.k0s()(),t.DNE(6,v,1,0,"ng-container",5)(7,P,1,0,"ng-container",5),t.k0s(),t.j41(8,"ion-modal",6),t.DNE(9,ft,13,6,"ng-template"),t.k0s(),t.DNE(10,Mt,2,1,"ng-template",null,0,t.C5r)(12,wt,1,1,"ng-template",null,1,t.C5r)}if(2&e){const r=t.sdS(11),l=t.sdS(13);t.R7$(4),t.Y8G("disabled",!0),t.R7$(),t.Y8G("ngClass",t.eq3(5,A,o.isFinished)),t.R7$(),t.Y8G("ngTemplateOutlet",r),t.R7$(),t.Y8G("ngTemplateOutlet",l),t.R7$(),t.Y8G("isOpen",o.isOpen)}},dependencies:[F.MD,F.YU,F.Sq,F.bT,F.T3,s.bv,s.mC,s.Jm,s.QW,s.W9,s.eU,s.iq,s.$w,s.uz,s.he,s.nf,s.S1,s.ai,s.Sb,s.Gw,w.iI,h.YN,h.BC,h.vS,H,_],styles:["ion-avatar[_ngcontent-%COMP%]{height:80px;width:80px;background-color:#fff;margin-top:1rem;border-radius:50%;margin-right:1rem}ion-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{object-fit:contain}app-leitor-facial[_ngcontent-%COMP%]{height:510px;display:block}.busca-facial[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{margin:auto}"]}),i})();function k(n,i){if(1&n&&(t.j41(0,"ion-select-option",5),t.EFF(1),t.k0s()),2&n){const a=i.$implicit,e=t.XpG();t.Y8G("value",a[e.idKey]),t.R7$(),t.SpI(" ",a[e.descricaoKey]||""," ")}}function S(n,i){if(1&n){const a=t.RV6();t.qex(0),t.j41(1,"ion-button",6),t.bIt("click",function(){t.eBV(a);const o=t.XpG();return t.Njj(o.add())}),t.nrm(2,"ion-icon",7),t.k0s(),t.bVm()}}let V=(()=>{var n;class i{constructor(){this.data=[],this.control=new h.MJ,this.placeholder="",this.label="Motivo",this.idKey="id",this.descricaoKey="descricao",this.showAddButton=!0,this.itemAdd=new t.bkB,(0,G.a)({addCircle:I.YH_})}add(){this.itemAdd.emit()}}return(n=i).\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.VBU({type:n,selectors:[["app-frota-select"]],inputs:{data:"data",control:"control",placeholder:"placeholder",label:"label",idKey:"idKey",descricaoKey:"descricaoKey",showAddButton:"showAddButton"},outputs:{itemAdd:"itemAdd"},standalone:!0,features:[t.aNF],decls:6,vars:5,consts:[[1,"ion-justify-content-center","ion-align-items-center"],["position","floating"],[3,"formControl","placeholder"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"value"],["slot","end","color","primary",3,"click"],["name","add-circle"]],template:function(e,o){1&e&&(t.j41(0,"ion-item",0)(1,"ion-label",1),t.EFF(2),t.k0s(),t.j41(3,"ion-select",2),t.DNE(4,k,2,2,"ion-select-option",3),t.k0s(),t.DNE(5,S,3,0,"ng-container",4),t.k0s()),2&e&&(t.R7$(2),t.JRh(o.label),t.R7$(),t.Y8G("formControl",o.control)("placeholder",o.placeholder),t.R7$(),t.Y8G("ngForOf",o.data),t.R7$(),t.Y8G("ngIf",o.showAddButton))},dependencies:[F.MD,F.Sq,F.bT,s.bv,s.Jm,s.iq,s.uz,s.he,s.Nm,s.Ip,s.Je,w.iI,h.X1,h.BC,h.l_]}),i})();function X(n,i){if(1&n){const a=t.RV6();t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",1)(3,"ion-button",2),t.bIt("click",function(){t.eBV(a);const o=t.XpG();return t.Njj(o.botaoCancelarModal())}),t.EFF(4,"Voltar"),t.k0s()(),t.j41(5,"ion-buttons",3)(6,"ion-button",4),t.bIt("click",function(){t.eBV(a);const o=t.XpG();return t.Njj(o.botaoConfirmar())}),t.EFF(7," Confirmar "),t.k0s()()()(),t.j41(8,"ion-content",5)(9,"ion-item")(10,"ion-row")(11,"ion-col",6),t.nrm(12,"ion-textarea",7),t.EFF(13),t.k0s()()()()}if(2&n){const a=t.XpG();t.R7$(6),t.Y8G("disabled",!a.descricaoControl.value)("strong",!0),t.R7$(6),t.Y8G("formControl",a.descricaoControl)("placeholder",a.placeholder),t.R7$(),t.SpI(" ",a.descricaoControl.value," ")}}let Y=(()=>{var n;class i{constructor(){this.isOpen=!1,this.placeholder="Descri\xe7\xe3o",this.descricaoControl=new h.MJ(""),this.cancelar=new t.bkB,this.confirmar=new t.bkB}botaoCancelarModal(){this.cancelar.emit()}botaoConfirmar(){this.confirmar.emit()}}return(n=i).\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.VBU({type:n,selectors:[["app-frota-basic-modal"]],inputs:{isOpen:"isOpen",placeholder:"placeholder",descricaoControl:"descricaoControl"},outputs:{cancelar:"cancelar",confirmar:"confirmar"},standalone:!0,features:[t.aNF],decls:2,vars:1,consts:[[3,"isOpen"],["slot","start"],[3,"click"],["slot","end"],[3,"click","disabled","strong"],[1,"ion-padding"],["size","12"],["rows","3","fill","outline",3,"formControl","placeholder"]],template:function(e,o){1&e&&(t.j41(0,"ion-modal",0),t.DNE(1,X,14,5,"ng-template"),t.k0s()),2&e&&t.Y8G("isOpen",o.isOpen)},dependencies:[F.MD,s.bv,s.Jm,s.QW,s.hU,s.W9,s.eU,s.uz,s.ln,s.nc,s.ai,s.Sb,s.Gw,w.iI,h.X1,h.BC,h.l_]}),i})();var x=C(3207),ht=C(8313);let ct=(()=>{var n;class i{constructor(e,o,r){this.service=e,this.loadingCtrl=o,this.alertCtrl=r,this.modalOpen=!1,this.control=new h.MJ(""),this.descricao=new h.MJ(""),this.data=[]}loadingData(){var e=this;return(0,d.A)(function*(){try{const o=yield(0,x.s)(e.service.getAll());e.data=o}catch(o){throw console.error("Erro ao carregar:",o.message),o}})()}addItem(){this.modalOpen=!0,console.log("Adicionar motivo clicado!")}onModalCancel(){this.modalOpen=!1}onModalConfirm(){var e=this;return(0,d.A)(function*(){var o;yield(0,ht.h)(e.loadingCtrl,e.alertCtrl,{mainAction:(o=(0,d.A)(function*(){yield(0,x.s)(e.service.save({descricao:e.descricao.value})),yield e.loadingData(),e.modalOpen=!1}),function(){return o.apply(this,arguments)}),onError:o=>{console.error("Erro ao executar a\xe7\xe3o no modal:",o.message)}})})()}}return(n=i).\u0275fac=function(e){t.QTQ()},n.\u0275prov=t.jDH({token:n,factory:n.\u0275fac,providedIn:"any"}),i})();var lt=C(3103),ut=C(9795);let gt=(()=>{var n;class i extends ct{constructor(e,o,r){super(e,o,r)}ngOnInit(){var e=this;return(0,d.A)(function*(){yield e.loadingData()})()}}return(n=i).\u0275fac=function(e){return new(e||n)(t.rXU(lt.i),t.rXU(ut.Xi),t.rXU(s.hG))},n.\u0275cmp=t.VBU({type:n,selectors:[["app-frota-motivo"]],inputs:{control:"control"},standalone:!0,features:[t.Vt3,t.aNF],decls:2,vars:4,consts:[["label","Sele\xe7\xe3o de Motivo",3,"itemAdd","data","control"],["placeholder","Digite aqui o motivo",3,"cancelar","confirmar","isOpen","descricaoControl"]],template:function(e,o){1&e&&(t.j41(0,"app-frota-select",0),t.bIt("itemAdd",function(){return o.addItem()}),t.k0s(),t.j41(1,"app-frota-basic-modal",1),t.bIt("cancelar",function(){return o.onModalCancel()})("confirmar",function(){return o.onModalConfirm()}),t.k0s()),2&e&&(t.Y8G("data",o.data)("control",o.control),t.R7$(),t.Y8G("isOpen",o.modalOpen)("descricaoControl",o.descricao))},dependencies:[F.MD,s.bv,w.iI,h.X1,V,Y]}),i})();var Pt=C(2553);let dt=(()=>{var n;class i extends ct{constructor(e,o,r){super(e,o,r)}ngOnInit(){var e=this;return(0,d.A)(function*(){yield e.loadingData()})()}}return(n=i).\u0275fac=function(e){return new(e||n)(t.rXU(Pt.G),t.rXU(s.Xi),t.rXU(s.hG))},n.\u0275cmp=t.VBU({type:n,selectors:[["app-frota-destino"]],inputs:{control:"control"},standalone:!0,features:[t.Vt3,t.aNF],decls:2,vars:4,consts:[["label","Sele\xe7\xe3o de Destino",3,"itemAdd","data","control"],["placeholder","Digite aqui o destino",3,"cancelar","confirmar","isOpen","descricaoControl"]],template:function(e,o){1&e&&(t.j41(0,"app-frota-select",0),t.bIt("itemAdd",function(){return o.addItem()}),t.k0s(),t.j41(1,"app-frota-basic-modal",1),t.bIt("cancelar",function(){return o.onModalCancel()})("confirmar",function(){return o.onModalConfirm()}),t.k0s()),2&e&&(t.Y8G("data",o.data)("control",o.control),t.R7$(),t.Y8G("isOpen",o.modalOpen)("descricaoControl",o.descricao))},dependencies:[F.MD,s.bv,w.iI,h.X1,V,Y]}),i})();var M=C(7106);let E=(()=>{var n;class i extends ct{constructor(e,o,r){super(e,o,r),this.withoutRoutesOpen=!0}ngOnInit(){var e=this;return(0,d.A)(function*(){e.withoutRoutesOpen?yield e.loadingDataWithoutRoutesOpen():yield e.loadingData()})()}loadingDataWithoutRoutesOpen(){var e=this;return(0,d.A)(function*(){try{const o=yield(0,x.s)(e.service.getAllWithoutRoutesOpen());e.data=o}catch(o){throw console.error("Erro ao carregar veiculos:",o.message),o}})()}}return(n=i).\u0275fac=function(e){return new(e||n)(t.rXU(M.T),t.rXU(s.Xi),t.rXU(ut.hG))},n.\u0275cmp=t.VBU({type:n,selectors:[["app-frota-veiculo"]],inputs:{control:"control",withoutRoutesOpen:"withoutRoutesOpen"},standalone:!0,features:[t.Vt3,t.aNF],decls:1,vars:3,consts:[["label","Sele\xe7\xe3o de ve\xedculo",3,"itemAdd","data","control","showAddButton"]],template:function(e,o){1&e&&(t.j41(0,"app-frota-select",0),t.bIt("itemAdd",function(){return o.addItem()}),t.k0s()),2&e&&t.Y8G("data",o.data)("control",o.control)("showAddButton",!1)},dependencies:[F.MD,s.bv,w.iI,h.X1,V]}),i})();var D=C(5964),L=C(5784);const U=n=>({"ion-hide":n});function T(n,i){if(1&n){const a=t.RV6();t.j41(0,"ion-item",3)(1,"ion-label"),t.EFF(2,"Selecionar motorista:"),t.k0s(),t.qex(3),t.j41(4,"app-button-add-remove",4),t.bIt("buttonClick",function(){t.eBV(a);const o=t.XpG();return t.Njj(o.isOpen=!0)}),t.k0s(),t.bVm(),t.k0s()}if(2&n){const a=t.XpG();t.R7$(4),t.Y8G("ngClass",t.eq3(1,U,a.isFinished))}}function N(n,i){if(1&n){const a=t.RV6();t.j41(0,"ion-item")(1,"div",5)(2,"ion-label",6),t.EFF(3,"Motorista:"),t.k0s(),t.j41(4,"ion-input",7),t.mxI("ngModelChange",function(o){t.eBV(a);const r=t.XpG();return t.DH7(r.motoristaSelecionado.name,o)||(r.motoristaSelecionado.name=o),t.Njj(o)}),t.k0s()(),t.j41(5,"app-button-add-remove",8),t.bIt("buttonClick",function(){t.eBV(a);const o=t.XpG();return t.Njj(o.removerMotorista())}),t.k0s()()}if(2&n){const a=t.XpG();t.R7$(4),t.Y8G("readonly",!0),t.R50("ngModel",a.motoristaSelecionado.name)}}function nt(n,i){if(1&n){const a=t.RV6();t.j41(0,"ion-button",17),t.bIt("click",function(){t.eBV(a);const o=t.XpG(2);return t.Njj(o.modoBuscaManual=!0)}),t.nrm(1,"ion-icon",18),t.k0s()}}function xt(n,i){if(1&n){const a=t.RV6();t.j41(0,"ion-button",17),t.bIt("click",function(){t.eBV(a);const o=t.XpG(2);return t.Njj(o.modoBuscaManual=!1)}),t.nrm(1,"ion-icon",19),t.k0s()}}function Tt(n,i){if(1&n){const a=t.RV6();t.j41(0,"div",20)(1,"app-leitor-facial",21),t.bIt("cancelBuscaFacial",function(){t.eBV(a);const o=t.XpG(2);return t.Njj(o.modoBuscaManual=!0)})("getResultLeitorFacial",function(o){t.eBV(a);const r=t.XpG(2);return t.Njj(r.resultLeitorFacial(o))}),t.k0s()()}if(2&n){const a=t.XpG(2);t.R7$(),t.Y8G("modoBuscaManualAtivo",a.modoBuscaManual)}}function Dt(n,i){if(1&n){const a=t.RV6();t.j41(0,"ion-item",10),t.bIt("click",function(){const o=t.eBV(a).$implicit,r=t.XpG(4);return t.Njj(r.selecionarMotorista(o))}),t.EFF(1),t.k0s()}if(2&n){const a=i.$implicit;t.R7$(),t.SpI(" ",a.name," ")}}function $t(n,i){if(1&n&&(t.j41(0,"ion-list"),t.DNE(1,Dt,2,1,"ion-item",24),t.k0s()),2&n){const a=t.XpG(3);t.R7$(),t.Y8G("ngForOf",a.motoristasFiltrados)}}function Vt(n,i){1&n&&(t.j41(0,"ion-text"),t.EFF(1," Nenhum motorista encontrado. "),t.k0s())}function Lt(n,i){if(1&n){const a=t.RV6();t.j41(0,"div",22)(1,"ion-item")(2,"ion-searchbar",23),t.mxI("ngModelChange",function(o){t.eBV(a);const r=t.XpG(2);return t.DH7(r.funcionarioBusca,o)||(r.funcionarioBusca=o),t.Njj(o)}),t.bIt("ionInput",function(){t.eBV(a);const o=t.XpG(2);return t.Njj(o.buscarMotoristas())}),t.k0s()(),t.DNE(3,$t,2,1,"ion-list",1)(4,Vt,2,0,"ion-text",1),t.k0s()}if(2&n){const a=t.XpG(2);t.R7$(2),t.R50("ngModel",a.funcionarioBusca),t.R7$(),t.Y8G("ngIf",a.motoristasFiltrados.length>0&&a.funcionarioBusca),t.R7$(),t.Y8G("ngIf",0===a.motoristasFiltrados.length&&a.funcionarioBusca)}}function Ut(n,i){if(1&n){const a=t.RV6();t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",9)(3,"ion-button",10),t.bIt("click",function(){t.eBV(a);const o=t.XpG();return t.Njj(o.isOpen=!1)}),t.nrm(4,"ion-icon",11),t.k0s()(),t.j41(5,"ion-title"),t.EFF(6,"Selecionar Motorista"),t.k0s(),t.j41(7,"ion-buttons",12),t.DNE(8,nt,2,0,"ion-button",13)(9,xt,2,0,"ion-button",13),t.k0s()()(),t.j41(10,"ion-content",14),t.DNE(11,Tt,2,1,"div",15)(12,Lt,5,3,"div",16),t.k0s()}if(2&n){const a=t.XpG();t.R7$(8),t.Y8G("ngIf",!a.modoBuscaManual),t.R7$(),t.Y8G("ngIf",a.modoBuscaManual),t.R7$(),t.Y8G("fullscreen",!0),t.R7$(),t.Y8G("ngIf",!a.modoBuscaManual),t.R7$(),t.Y8G("ngIf",a.modoBuscaManual)}}let Xt=(()=>{var n;class i{constructor(e){this.funcionarioService=e,this.modoBuscaManual=!1,this.isOpen=!1,this.funcionarios=[],this.funcionarioBusca="",this.motoristasFiltrados=[],this.motoristaSelecionado=null,this.isFinished=!1,(0,G.a)({trashOutline:I.P1A,arrowBack:I.$$C})}ngOnInit(){var e=this;return(0,d.A)(function*(){yield e.carregarMotoristas(),e.getMotoristaIdSubscription=e.control.valueChanges.subscribe(function(){var o=(0,d.A)(function*(r){r&&(yield e.carregarMotoristaSelecionado(r))});return function(r){return o.apply(this,arguments)}}())})()}carregarMotoristas(){var e=this;return(0,d.A)(function*(){const o=e.funcionarioService.getCachedFuncionarios();if(o&&0!==o.length)e.funcionarios=o;else{const r=yield(0,O._)(e.funcionarioService.getAll());e.funcionarios=r}})()}buscarMotoristas(){const e=this.funcionarioBusca.toLowerCase();this.motoristasFiltrados=this.funcionarios.filter(o=>{var r;return null===(r=o.name)||void 0===r?void 0:r.toLowerCase().includes(e)})}selecionarMotorista(e){this.motoristaSelecionado=e,this.control.setValue(e.id),this.isOpen=!1,this.funcionarioBusca="",this.motoristasFiltrados=[]}removerMotorista(){this.motoristaSelecionado=null,this.control.setValue(null)}ngOnChanges(e){var o=this;return(0,d.A)(function*(){if(e.control){const r=e.control.currentValue;r&&r.value&&(yield o.carregarMotoristaSelecionado(r.value))}})()}carregarMotoristaSelecionado(e){var o=this;return(0,d.A)(function*(){try{yield o.carregarMotoristas(),o.motoristaSelecionado=o.funcionarios.find(l=>l.id===e)}catch(r){console.error("Erro ao carregar motorista selecionado:",r)}})()}resultLeitorFacial(e){this.selecionarMotorista(e.funcionario)}ngOnDestroy(){this.getMotoristaIdSubscription.unsubscribe()}}return(n=i).\u0275fac=function(e){return new(e||n)(t.rXU(g.r))},n.\u0275cmp=t.VBU({type:n,selectors:[["app-frota-motorista"]],inputs:{control:"control",isFinished:"isFinished"},standalone:!0,features:[t.OA$,t.aNF],decls:5,vars:3,consts:[["class","ion-justify-content-center ion-align-items-center",4,"ngIf"],[4,"ngIf"],[3,"isOpen"],[1,"ion-justify-content-center","ion-align-items-center"],["color","primary",3,"buttonClick","ngClass"],[1,"item-content"],["position","floating"],[3,"ngModelChange","readonly","ngModel"],["color","danger","slot","end",3,"buttonClick"],["slot","start"],[3,"click"],["slot","icon-only","name","arrow-back","color","primary"],["slot","end"],["fill","clear",3,"click",4,"ngIf"],[1,"ion-padding",3,"fullscreen"],["class","busca-facial",4,"ngIf"],["class","busca-manual",4,"ngIf"],["fill","clear",3,"click"],["name","keypad-outline"],["name","camera-outline","color","primary"],[1,"busca-facial"],[3,"cancelBuscaFacial","getResultLeitorFacial","modoBuscaManualAtivo"],[1,"busca-manual"],["placeholder","Buscar Motorista",3,"ngModelChange","ionInput","ngModel"],[3,"click",4,"ngFor","ngForOf"]],template:function(e,o){1&e&&(t.j41(0,"ion-list"),t.DNE(1,T,5,3,"ion-item",0)(2,N,6,2,"ion-item",1),t.k0s(),t.j41(3,"ion-modal",2),t.DNE(4,Ut,13,5,"ng-template"),t.k0s()),2&e&&(t.R7$(),t.Y8G("ngIf",!o.motoristaSelecionado),t.R7$(),t.Y8G("ngIf",o.motoristaSelecionado),t.R7$(),t.Y8G("isOpen",o.isOpen))},dependencies:[F.MD,F.YU,F.Sq,F.bT,s.bv,s.Jm,s.QW,s.W9,s.eU,s.iq,s.$w,s.uz,s.he,s.nf,s.S1,s.IO,s.BC,s.ai,s.Sb,s.Gw,w.iI,h.YN,h.BC,h.vS,H,_],styles:["ion-item[_ngcontent-%COMP%]{display:flex;align-items:center}ion-item[_ngcontent-%COMP%]   .item-content[_ngcontent-%COMP%]{flex-grow:1;display:flex;flex-direction:column;width:100%}app-leitor-facial[_ngcontent-%COMP%]{height:510px;display:block}"]}),i})();var Yt=C(8663);function Nt(n,i){1&n&&(t.j41(0,"span"),t.EFF(1,"Campo obrigat\xf3rio."),t.k0s())}function Wt(n,i){1&n&&(t.j41(0,"span"),t.EFF(1,"O valor m\xednimo deve ser maior que o Km de sa\xedda."),t.k0s())}function Ht(n,i){if(1&n&&(t.j41(0,"ion-text",7),t.DNE(1,Nt,2,0,"span",8)(2,Wt,2,0,"span",8),t.k0s()),2&n){const a=t.XpG();t.R7$(),t.Y8G("ngIf",null==a.kmRetornoControl||null==a.kmRetornoControl.errors?null:a.kmRetornoControl.errors.required),t.R7$(),t.Y8G("ngIf",null==a.kmRetornoControl||null==a.kmRetornoControl.errors?null:a.kmRetornoControl.errors.min)}}function qt(n,i){if(1&n){const a=t.RV6();t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),t.EFF(3,"Selecionar Data e Hora"),t.k0s(),t.j41(4,"ion-buttons",9)(5,"ion-button",10),t.bIt("click",function(){t.eBV(a);const o=t.XpG();return t.Njj(o.onCloseModal())}),t.EFF(6,"Voltar"),t.k0s()(),t.j41(7,"ion-buttons",11)(8,"ion-button",12),t.bIt("click",function(){t.eBV(a);const o=t.XpG();return t.Njj(o.onConfirmSelectDate())}),t.EFF(9,"Confirmar"),t.k0s()()()(),t.j41(10,"ion-content",13),t.nrm(11,"ion-datetime",14),t.k0s()}if(2&n){const a=t.XpG();t.R7$(8),t.Y8G("disabled",!a.dataRetornoControl.value)("strong",!0),t.R7$(3),t.Y8G("formControl",a.dataRetornoControl)}}let Kt=(()=>{var n;class i{constructor(e){this.datePipe=e,this.openModal=!1}ngOnInit(){this.dataRetornoControl.valueChanges.subscribe(e=>{var o;e&&(this.showDataRetorno=null!==(o=this.datePipe.transform(e,"dd-MM-yyyy HH:mm","pt-BR"))&&void 0!==o?o:"")}),this.dataRetornoControl.setValue(new Date)}onOpenModal(){this.openModal=!0}onCloseModal(){this.openModal=!1}onConfirmSelectDate(){this.openModal=!0}}return(n=i).\u0275fac=function(e){return new(e||n)(t.rXU(F.vh))},n.\u0275cmp=t.VBU({type:n,selectors:[["app-frota-retorno"]],inputs:{dataCard:"dataCard",kmRetornoControl:"kmRetornoControl",dataRetornoControl:"dataRetornoControl",tipoAcompanhanteRetorno:"tipoAcompanhanteRetorno",saveAcompanhanteFrota:"saveAcompanhanteFrota"},standalone:!0,features:[t.Jv_([F.vh]),t.aNF],decls:16,vars:12,consts:[[3,"hideButtonActions","data","isFinished"],["position","floating"],["type","number",3,"formControl"],["color","danger",4,"ngIf"],[3,"ngModelChange","click","readonly","ngModel"],[3,"tipoAcompanhanteRetorno","saveAcompanhanteFrota","idFrota"],[1,"modal-data-time",3,"isOpen","backdropDismiss"],["color","danger"],[4,"ngIf"],["slot","start"],[3,"click"],["slot","end"],[3,"click","disabled","strong"],[1,"ion-padding"],["presentation","date-time",3,"formControl"]],template:function(e,o){1&e&&(t.nrm(0,"app-card",0),t.j41(1,"ion-grid")(2,"ion-row")(3,"ion-col")(4,"ion-item")(5,"ion-label",1),t.EFF(6,"Km Retorno"),t.k0s(),t.nrm(7,"ion-input",2),t.DNE(8,Ht,3,2,"ion-text",3),t.k0s(),t.j41(9,"ion-item")(10,"ion-label",1),t.EFF(11,"Data e hora de retorno"),t.k0s(),t.j41(12,"ion-input",4),t.mxI("ngModelChange",function(l){return t.DH7(o.showDataRetorno,l)||(o.showDataRetorno=l),l}),t.bIt("click",function(){return o.onOpenModal()}),t.k0s()(),t.nrm(13,"app-frota-acompanhantes",5),t.j41(14,"ion-modal",6),t.DNE(15,qt,12,3,"ng-template"),t.k0s()()()()),2&e&&(t.Y8G("hideButtonActions",!0)("data",o.dataCard)("isFinished",!0),t.R7$(7),t.Y8G("formControl",o.kmRetornoControl),t.R7$(),t.Y8G("ngIf",(null==o.kmRetornoControl?null:o.kmRetornoControl.invalid)&&(null==o.kmRetornoControl?null:o.kmRetornoControl.touched)),t.R7$(4),t.Y8G("readonly",!0),t.R50("ngModel",o.showDataRetorno),t.R7$(),t.Y8G("tipoAcompanhanteRetorno",o.tipoAcompanhanteRetorno)("saveAcompanhanteFrota",o.saveAcompanhanteFrota)("idFrota",o.dataCard.id),t.R7$(),t.Y8G("isOpen",o.openModal)("backdropDismiss",!1))},dependencies:[s.bv,s.Jm,s.QW,s.hU,s.W9,s.A9,s.lO,s.eU,s.$w,s.uz,s.he,s.ln,s.IO,s.BC,s.ai,s.Sb,s.su,s.Je,s.Gw,F.MD,F.bT,Yt.i,h.X1,h.BC,h.l_,h.YN,h.vS,_t]}),i})();var Jt=C(9457),zt=C(2177);let Qt=(()=>{var n;class i{constructor(e){this.fb=e}createSaidaFrotaForm(){return this.fb.group({dataHoraSaida:[null,h.k0.required],imobilizadoCod:[null,h.k0.required],destinoSeq:[null,h.k0.required],quilometragemNaSaida:[null,[h.k0.required,h.k0.min(1)]],motivoSeq:[null,h.k0.required],funcCod:[null,h.k0.required],obs:[""]})}addRetornoControls(e,o){e.addControl("quilometragemNoRetorno",new h.MJ(o+1,[h.k0.required,h.k0.min(null!=o?o:1)])),e.addControl("dataHoraRetorno",new h.MJ(new Date,h.k0.required))}}return(n=i).\u0275fac=function(e){return new(e||n)(t.KVO(h.ok))},n.\u0275prov=t.jDH({token:n,factory:n.\u0275fac,providedIn:"root"}),i})();function Zt(n,i){if(1&n&&(t.qex(0),t.nrm(1,"app-frota-retorno",11),t.bVm()),2&n){const a=t.XpG();t.R7$(),t.Y8G("dataCard",a.dataSharedCard)("kmRetornoControl",a.form.controls.quilometragemNoRetorno)("dataRetornoControl",a.form.controls.dataHoraRetorno)("tipoAcompanhanteRetorno",a.isClose)("saveAcompanhanteFrota",a.sendSaidaIdForAcompanhante)}}function te(n,i){if(1&n&&(t.qex(0),t.nrm(1,"app-frota-veiculo",19),t.bVm()),2&n){const a=t.XpG(2);t.R7$(),t.Y8G("control",a.form.controls.imobilizadoCod)("withoutRoutesOpen",!1)}}function ee(n,i){if(1&n&&(t.qex(0),t.nrm(1,"app-frota-veiculo",13),t.bVm()),2&n){const a=t.XpG(2);t.R7$(),t.Y8G("control",a.form.controls.imobilizadoCod)}}function oe(n,i){1&n&&(t.j41(0,"span"),t.EFF(1,"Campo obrigat\xf3rio."),t.k0s())}function ne(n,i){1&n&&(t.j41(0,"span"),t.EFF(1,"O Km de sa\xedda deve ser maior que 0."),t.k0s())}function ae(n,i){if(1&n&&(t.j41(0,"ion-text",20),t.DNE(1,oe,2,0,"span",10)(2,ne,2,0,"span",10),t.k0s()),2&n){let a,e;const o=t.XpG(2);t.R7$(),t.Y8G("ngIf",null==(a=o.form.get("quilometragemNaSaida"))||null==a.errors?null:a.errors.required),t.R7$(),t.Y8G("ngIf",null==(e=o.form.get("quilometragemNaSaida"))||null==e.errors?null:e.errors.min)}}function re(n,i){if(1&n&&(t.qex(0),t.j41(1,"ion-grid",12)(2,"ion-row")(3,"ion-col"),t.nrm(4,"app-frota-motorista",13),t.DNE(5,te,2,2,"ng-container",10)(6,ee,2,1,"ng-container",10),t.nrm(7,"app-frota-destino",13),t.j41(8,"ion-item")(9,"ion-label",14),t.EFF(10,"Km Sa\xedda"),t.k0s(),t.nrm(11,"ion-input",15),t.DNE(12,ae,3,2,"ion-text",16),t.k0s(),t.nrm(13,"app-frota-motivo",13),t.j41(14,"ion-item")(15,"ion-label",14),t.EFF(16,"Observa\xe7\xf5es"),t.k0s(),t.nrm(17,"ion-textarea",17),t.k0s(),t.nrm(18,"app-frota-acompanhantes",18),t.k0s()()(),t.bVm()),2&n){let a;const e=t.XpG();t.R7$(),t.Y8G("formGroup",e.form),t.R7$(3),t.Y8G("control",e.form.controls.funcCod),t.R7$(),t.Y8G("ngIf",e.id),t.R7$(),t.Y8G("ngIf",!e.id),t.R7$(),t.Y8G("control",e.form.controls.destinoSeq),t.R7$(5),t.Y8G("ngIf",(null==(a=e.form.get("quilometragemNaSaida"))?null:a.invalid)&&(null==(a=e.form.get("quilometragemNaSaida"))?null:a.touched)),t.R7$(),t.Y8G("control",e.form.controls.motivoSeq),t.R7$(5),t.Y8G("tipoAcompanhanteRetorno",e.isClose)("saveAcompanhanteFrota",e.sendSaidaIdForAcompanhante)("idFrota",e.id)}}let ie=(()=>{var n;class i{constructor(e,o,r,l,f,b,y,B,at){this.fb=e,this.frotaSaidaSrv=o,this.loaddingCtrl=r,this.alertCtrl=l,this.router=f,this.route=b,this.dataSharedCardSrv=y,this.identificacaoFuncSrv=B,this.frotaSaidaForm=at,this.id=null,this.sendSaidaIdForAcompanhante=null,this.isClose=!1,this.routeSubscription=null,this.appRoutes=L.S,this.dataSharedCard=null,this.openModalDataTime=!1,this.changeFuncCodSubscription=null,this.srcFotoMotorista="assets/user.png",this.form=this.frotaSaidaForm.createSaidaFrotaForm()}ngOnInit(){var e=this;return(0,d.A)(function*(){e.updateRouteData(),e.changeFuncCodSubscription=e.form.controls.funcCod.valueChanges.subscribe(function(){var o=(0,d.A)(function*(r){const l=yield e.identificacaoFuncSrv.getImage(r);r&&l&&(e.srcFotoMotorista=yield e.identificacaoFuncSrv.getImage(r)),r||(e.srcFotoMotorista="assets/user.png")});return function(r){return o.apply(this,arguments)}}()),e.routeSubscription=e.router.events.pipe((0,D.p)(o=>o instanceof w.wF)).subscribe((0,d.A)(function*(){return yield e.updateRouteData()}))})()}updateRouteData(){var e=this;return(0,d.A)(function*(){if(e.id=Number(e.route.snapshot.paramMap.get("id"))||null,e.isClose=e.route.snapshot.url.some(r=>"close"===r.path),e.dataSharedCard=yield e.dataSharedCardSrv.getData(),e.isClose){var o;e.dataSharedCard||(e.dataSharedCard=yield e.dataSharedCardSrv.getData());const r=null===(o=e.dataSharedCard)||void 0===o?void 0:o.quilometragemNaSaida;e.frotaSaidaForm.addRetornoControls(e.form,null!=r?r:1)}e.id&&(e.dataSharedCard||(e.dataSharedCard=yield e.dataSharedCardSrv.getData()),e.dataSharedCard?e.form.patchValue(e.dataSharedCard):e.getDataForEditForm(e.id))})()}getDataForEditForm(e){this.frotaSaidaSrv.getById(e).subscribe(o=>{this.dataSharedCard=o,this.form.patchValue(o)})}onSubmit(){var e=this;return(0,d.A)(function*(){var o,r;e.id||e.isClose||null===(o=e.form.get("dataHoraSaida"))||void 0===o||o.setValue(new Date),e.form.valid?yield(0,ht.h)(e.loaddingCtrl,e.alertCtrl,{mainAction:(r=(0,d.A)(function*(){const l=e.form.value;if(e.isClose||e.id){const f=yield(0,O._)(e.frotaSaidaSrv.update(e.id,l));e.sendSaidaIdForAcompanhante=null==f?void 0:f.id}else{const f=yield(0,O._)(e.frotaSaidaSrv.save(l));e.sendSaidaIdForAcompanhante=null==f?void 0:f.id}}),function(){return r.apply(this,arguments)}),onAfterTryDismiss:()=>e.router.navigate([e.appRoutes.list.path]),onError:r=>console.error("Erro ao salvar:",r)}):console.log("Formul\xe1rio inv\xe1lido")})()}msgCloseForm(){var e=this;return(0,d.A)(function*(){const o=yield e.alertCtrl.create({header:"Sair do cadastro de rota",message:"Voc\xea tem certeza que quer sair do cadastro de rota? Ao sair, suas modifica\xe7\xf5es ser\xe3o perdidas!",buttons:[{text:"Continuar nesta Tela",role:"cancel"},{text:"Sair",handler:()=>e.router.navigate(["/home"])}]});e.form.dirty?yield o.present():e.router.navigate(["/home"])})()}ngOnDestroy(){var e;null===(e=this.routeSubscription)||void 0===e||e.unsubscribe()}}return(n=i).\u0275fac=function(e){return new(e||n)(t.rXU(h.ok),t.rXU(Jt.g),t.rXU(s.Xi),t.rXU(s.hG),t.rXU(w.Ix),t.rXU(w.nX),t.rXU(zt.w),t.rXU(Q._),t.rXU(Qt))},n.\u0275cmp=t.VBU({type:n,selectors:[["app-form"]],standalone:!0,features:[t.aNF],decls:19,vars:6,consts:[[3,"translucent"],["color","primary"],["slot","start"],["color","light",3,"click"],["slot","end"],[3,"fullscreen"],[1,"box-content"],[1,"ion-justify-content-center","ion-align-items-center"],["size","auto"],["alt","Foto de perfil",3,"src"],[4,"ngIf"],[3,"dataCard","kmRetornoControl","dataRetornoControl","tipoAcompanhanteRetorno","saveAcompanhanteFrota"],[3,"formGroup"],[3,"control"],["position","floating"],["type","number","formControlName","quilometragemNaSaida"],["color","danger",4,"ngIf"],["formControlName","obs"],[3,"tipoAcompanhanteRetorno","saveAcompanhanteFrota","idFrota"],[3,"control","withoutRoutesOpen"],["color","danger"]],template:function(e,o){1&e&&(t.j41(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-buttons",2)(3,"ion-button",3),t.bIt("click",function(){return o.msgCloseForm()}),t.EFF(4,"Sair"),t.k0s()(),t.j41(5,"ion-title"),t.EFF(6),t.k0s(),t.j41(7,"ion-buttons",4)(8,"ion-button",3),t.bIt("click",function(){return o.onSubmit()}),t.EFF(9,"Salvar"),t.k0s()()()(),t.j41(10,"ion-content",5)(11,"div",6)(12,"ion-grid")(13,"ion-row",7)(14,"ion-col",8)(15,"ion-avatar"),t.nrm(16,"img",9),t.k0s()()()(),t.DNE(17,Zt,2,5,"ng-container",10)(18,re,19,10,"ng-container",10),t.k0s()()),2&e&&(t.Y8G("translucent",!0),t.R7$(6),t.JRh(o.isClose?"Finalizar percurso":o.id?"Editar percurso":"Iniciar percurso"),t.R7$(4),t.Y8G("fullscreen",!0),t.R7$(6),t.Y8G("src",o.srcFotoMotorista,t.B4B),t.R7$(),t.Y8G("ngIf",o.isClose&&!!o.dataSharedCard),t.R7$(),t.Y8G("ngIf",!o.isClose))},dependencies:[F.MD,F.bT,s.bv,s.mC,s.Jm,s.QW,s.hU,s.W9,s.lO,s.eU,s.$w,s.uz,s.he,s.ln,s.IO,s.nc,s.BC,s.ai,s.su,s.Gw,w.iI,h.X1,h.BC,h.cb,h.j4,h.JD,_t,gt,dt,E,Xt,h.YN,Kt],styles:["[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .box-content[_ngcontent-%COMP%]{display:block;max-width:800px;margin:0 auto}[_nghost-%COMP%]   ion-avatar[_ngcontent-%COMP%]{height:200px;width:200px}[_nghost-%COMP%]   ion-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{object-fit:contain}"]}),i})()},3207:(Et,et,C)=>{C.d(et,{s:()=>F});var d=C(9350);function F(h,w){const s="object"==typeof w;return new Promise((t,O)=>{let G,j=!1;h.subscribe({next:I=>{G=I,j=!0},error:O,complete:()=>{j?t(G):s?t(w.defaultValue):O(new d.G)}})})}}}]);