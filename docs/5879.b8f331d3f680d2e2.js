"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5879],{5879:(D,v,m)=>{m.r(v),m.d(v,{FormPage:()=>Rt});var d=m(467),p=m(177),c=m(4341),_=m(7471),i=m(4742),t=m(4438),f=m(4843),h=function(e){return e[e.Saida=0]="Saida",e[e.Retorno=1]="Retorno",e}(h||{}),F=m(5079),g=m(5873);function T(e,s){if(1&e&&t.nrm(0,"ion-icon",3),2&e){const a=t.XpG();t.Y8G("name","primary"===a.color?"add-circle":"trash-outline")}}function V(e,s){if(1&e&&(t.j41(0,"ion-label"),t.EFF(1),t.k0s()),2&e){const a=t.XpG();t.R7$(),t.JRh(a.text)}}let k=(()=>{var e;class s{constructor(){this.color="primary",this.text="",this.disabled=!1,this.slot="end",this.buttonClick=new t.bkB,(0,F.a)({addCircle:g.YH_,trashOutline:g.P1A})}onClick(){this.disabled||this.buttonClick.emit()}}return(e=s).\u0275fac=function(o){return new(o||e)},e.\u0275cmp=t.VBU({type:e,selectors:[["app-button-add-remove"]],inputs:{color:"color",text:"text",disabled:"disabled",slot:"slot"},outputs:{buttonClick:"buttonClick"},standalone:!0,features:[t.aNF],decls:3,vars:5,consts:[[3,"click","color","disabled","slot"],["slot","icon-only",3,"name",4,"ngIf"],[4,"ngIf"],["slot","icon-only",3,"name"]],template:function(o,n){1&o&&(t.j41(0,"ion-button",0),t.bIt("click",function(){return n.onClick()}),t.DNE(1,T,1,1,"ion-icon",1)(2,V,2,1,"ion-label",2),t.k0s()),2&o&&(t.Y8G("color",n.color)("disabled",n.disabled)("slot",n.slot),t.R7$(),t.Y8G("ngIf",!n.text),t.R7$(),t.Y8G("ngIf",n.text))},dependencies:[p.MD,p.bT,i.bv,i.Jm,i.iq,i.he]}),s})();var M=m(2705),y=m(9684);let E=(()=>{var e;class s{constructor(o){this.baseApiService=o,this.endpoint="api/AcompanhanteFrota"}getAll(o,n){return this.baseApiService.get(`${this.endpoint}/GetAll/${o}/${n}`)}save(o){return this.baseApiService.post(`${this.endpoint}/AddMultiple`,o)}update(o,n,r){return this.baseApiService.put(`${this.endpoint}/Update`,{frotaId:o,tipo:n,model:r})}}return(e=s).\u0275fac=function(o){return new(o||e)(t.KVO(y.v))},e.\u0275prov=t.jDH({token:e,factory:e.\u0275fac,providedIn:"root"}),s})();const G=e=>({"ion-hide":e});function X(e,s){1&e&&t.eu8(0)}function $(e,s){1&e&&t.eu8(0)}function Y(e,s){if(1&e){const a=t.RV6();t.j41(0,"ion-item",8),t.bIt("click",function(){const n=t.eBV(a).$implicit,r=t.XpG(3);return t.Njj(r.adicionarAcompanhante(n))}),t.EFF(1),t.k0s()}if(2&e){const a=s.$implicit;t.R7$(),t.SpI(" ",a.name," ")}}function N(e,s){if(1&e&&(t.j41(0,"ion-list"),t.DNE(1,Y,2,1,"ion-item",14),t.k0s()),2&e){const a=t.XpG(2);t.R7$(),t.Y8G("ngForOf",a.acompanhantesFiltrados)}}function x(e,s){1&e&&t.eu8(0)}function w(e,s){1&e&&t.eu8(0)}function U(e,s){if(1&e){const a=t.RV6();t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",7)(3,"ion-button",8),t.bIt("click",function(){t.eBV(a);const n=t.XpG();return t.Njj(n.isOpen=!1)}),t.EFF(4,"Voltar"),t.k0s()(),t.j41(5,"ion-buttons",9)(6,"ion-button",10),t.bIt("click",function(){t.eBV(a);const n=t.XpG();return t.Njj(n.isOpen=!1)}),t.EFF(7," Salvar "),t.k0s()()()(),t.j41(8,"ion-content",11)(9,"ion-item")(10,"ion-searchbar",12),t.mxI("ngModelChange",function(n){t.eBV(a);const r=t.XpG();return t.DH7(r.acompanhanteBusca,n)||(r.acompanhanteBusca=n),t.Njj(n)}),t.bIt("ionInput",function(){t.eBV(a);const n=t.XpG();return t.Njj(n.buscarAcompanhantes())}),t.k0s()(),t.DNE(11,N,2,1,"ion-list",13)(12,x,1,0,"ng-container",5)(13,w,1,0,"ng-container",5),t.k0s()}if(2&e){const a=t.XpG(),o=t.sdS(11),n=t.sdS(13);t.R7$(6),t.Y8G("strong",!0),t.R7$(4),t.R50("ngModel",a.acompanhanteBusca),t.R7$(),t.Y8G("ngIf",a.acompanhantesFiltrados.length>0&&a.acompanhanteBusca),t.R7$(),t.Y8G("ngTemplateOutlet",o),t.R7$(),t.Y8G("ngTemplateOutlet",n)}}function P(e,s){if(1&e){const a=t.RV6();t.j41(0,"ion-item")(1,"ion-label"),t.EFF(2),t.k0s(),t.nrm(3,"ion-input",3),t.j41(4,"app-button-add-remove",16),t.bIt("buttonClick",function(){const n=t.eBV(a).$implicit,r=t.XpG(2);return t.Njj(r.removerAcompanhante(n))}),t.k0s()()}if(2&e){const a=s.$implicit,o=t.XpG(2);t.R7$(2),t.JRh(a.name),t.R7$(),t.Y8G("disabled",!0),t.R7$(),t.Y8G("ngClass",t.eq3(3,G,o.isFinished))}}function J(e,s){if(1&e&&(t.j41(0,"ion-list"),t.DNE(1,P,5,5,"ion-item",15),t.k0s()),2&e){const a=t.XpG();t.R7$(),t.Y8G("ngForOf",a.acompanhantesSelecionados)}}function H(e,s){1&e&&(t.j41(0,"p",18)(1,"strong"),t.EFF(2,"Nenhum acompanhante selecionado."),t.k0s()())}function q(e,s){if(1&e&&t.DNE(0,H,3,0,"p",17),2&e){const a=t.XpG();t.Y8G("ngIf",a.acompanhantesSelecionados.length<1)}}let I=(()=>{var e;class s{constructor(o,n){this.funcionarioService=o,this.acompanhanteFrotaSrv=n,this.isOpen=!1,this.acompanhantes=[],this.acompanhanteBusca="",this.acompanhantesFiltrados=[],this.acompanhantesSelecionados=[],this.tipoAcompanhanteRetorno=!1,this.isFinished=!1,this.statusSaveAcompanhanteFrota=new t.bkB}ngOnInit(){var o=this;return(0,d.A)(function*(){yield o.carregarAcompanhantes()})()}ngOnChanges(o){var n=this;return(0,d.A)(function*(){if(o.saveAcompanhanteFrota){const r=o.saveAcompanhanteFrota.currentValue;r&&(yield n.submitFrotaAcompanhante(r))}o.idFrota&&n.idFrota&&(yield n.carregarAcompanhantesSelecionados(n.idFrota)),o.tipoAcompanhanteRetorno&&n.idFrota&&(yield n.carregarAcompanhantesSelecionados(n.idFrota))})()}carregarAcompanhantesSelecionados(o){var n=this;return(0,d.A)(function*(){try{let l;l=n.isFinished&&n.tipoAcompanhanteRetorno?yield(0,f._)(n.acompanhanteFrotaSrv.getAll(o,h.Retorno)):yield(0,f._)(n.acompanhanteFrotaSrv.getAll(o,h.Saida)),yield n.carregarAcompanhantes();const u=n.acompanhantes;console.log(u),n.acompanhantesSelecionados=l.map(C=>u.find(R=>R.id===C.funcCod)).filter(C=>null!=C),console.log(n.acompanhantesSelecionados)}catch(l){console.error("Erro ao carregar acompanhantes selecionados:",l)}})()}carregarAcompanhantes(){var o=this;return(0,d.A)(function*(){const n=o.funcionarioService.getCachedFuncionarios();if(n&&0!==n.length)o.acompanhantes=n;else{const r=yield(0,f._)(o.funcionarioService.getAll());o.acompanhantes=r}})()}buscarAcompanhantes(){const o=this.acompanhanteBusca.toLowerCase();this.acompanhantesFiltrados=this.acompanhantes.filter(n=>n.name.toLowerCase().includes(o)&&!this.acompanhantesSelecionados.some(r=>r.id===n.id))}adicionarAcompanhante(o){this.acompanhantesSelecionados.push(o),this.acompanhanteBusca="",this.acompanhantesFiltrados=[]}removerAcompanhante(o){this.acompanhantesSelecionados=this.acompanhantesSelecionados.filter(n=>n.id!==o.id)}submitFrotaAcompanhante(o){var n=this;return(0,d.A)(function*(){const r=n.tipoAcompanhanteRetorno?h.Retorno:h.Saida,l=n.acompanhantesSelecionados.map(u=>({frotaSeq:o,tipo:r,funcCod:u.id}));n.idFrota&&!n.tipoAcompanhanteRetorno?n.acompanhanteFrotaSrv.update(n.idFrota,h.Saida,l).subscribe({next:()=>{n.statusSaveAcompanhanteFrota.emit(!0)},error:u=>{n.statusSaveAcompanhanteFrota.emit(!1)}}):n.acompanhanteFrotaSrv.save(l).subscribe({next:()=>{n.statusSaveAcompanhanteFrota.emit(!0)},error:u=>{n.statusSaveAcompanhanteFrota.emit(!1)}})})()}}return(e=s).\u0275fac=function(o){return new(o||e)(t.rXU(M.r),t.rXU(E))},e.\u0275cmp=t.VBU({type:e,selectors:[["app-frota-acompanhantes"]],inputs:{tipoAcompanhanteRetorno:"tipoAcompanhanteRetorno",saveAcompanhanteFrota:"saveAcompanhanteFrota",idFrota:"idFrota",isFinished:"isFinished"},outputs:{statusSaveAcompanhanteFrota:"statusSaveAcompanhanteFrota"},standalone:!0,features:[t.OA$,t.aNF],decls:14,vars:7,consts:[["listaAcompanhantesSelecionados",""],["mensagensAcompanhantes",""],[1,"ion-justify-content-center","ion-align-items-center"],[2,"width","0","height","0",3,"disabled"],["color","primary",3,"buttonClick","ngClass"],[4,"ngTemplateOutlet"],[3,"isOpen"],["slot","start"],[3,"click"],["slot","end"],[3,"click","strong"],[1,"ion-padding"],["placeholder","Buscar Acompanhante",3,"ngModelChange","ionInput","ngModel"],[4,"ngIf"],[3,"click",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["color","danger",3,"buttonClick","ngClass"],["class","ion-text-center",4,"ngIf"],[1,"ion-text-center"]],template:function(o,n){if(1&o){const r=t.RV6();t.j41(0,"ion-list")(1,"ion-item",2)(2,"ion-label"),t.EFF(3,"Acompanhante(s) selecionado(s)"),t.k0s(),t.nrm(4,"ion-input",3),t.j41(5,"app-button-add-remove",4),t.bIt("buttonClick",function(){return t.eBV(r),t.Njj(n.isOpen=!0)}),t.k0s()(),t.DNE(6,X,1,0,"ng-container",5)(7,$,1,0,"ng-container",5),t.k0s(),t.j41(8,"ion-modal",6),t.DNE(9,U,14,5,"ng-template"),t.k0s(),t.DNE(10,J,2,1,"ng-template",null,0,t.C5r)(12,q,1,1,"ng-template",null,1,t.C5r)}if(2&o){const r=t.sdS(11),l=t.sdS(13);t.R7$(4),t.Y8G("disabled",!0),t.R7$(),t.Y8G("ngClass",t.eq3(5,G,n.isFinished)),t.R7$(),t.Y8G("ngTemplateOutlet",r),t.R7$(),t.Y8G("ngTemplateOutlet",l),t.R7$(),t.Y8G("isOpen",n.isOpen)}},dependencies:[p.MD,p.YU,p.Sq,p.bT,p.T3,i.bv,i.Jm,i.QW,i.W9,i.eU,i.$w,i.uz,i.he,i.nf,i.S1,i.ai,i.Sb,i.Gw,_.iI,c.YN,c.BC,c.vS,k]}),s})();function W(e,s){if(1&e&&(t.j41(0,"ion-select-option",5),t.EFF(1),t.k0s()),2&e){const a=s.$implicit,o=t.XpG();t.Y8G("value",a[o.idKey]),t.R7$(),t.SpI(" ",a[o.descricaoKey]||""," ")}}function z(e,s){if(1&e){const a=t.RV6();t.qex(0),t.j41(1,"ion-button",6),t.bIt("click",function(){t.eBV(a);const n=t.XpG();return t.Njj(n.add())}),t.nrm(2,"ion-icon",7),t.k0s(),t.bVm()}}let S=(()=>{var e;class s{constructor(){this.data=[],this.control=new c.MJ,this.placeholder="Selecione um motivo",this.label="Motivo",this.idKey="id",this.descricaoKey="descricao",this.showAddButton=!0,this.itemAdd=new t.bkB,(0,F.a)({addCircle:g.YH_})}add(){this.itemAdd.emit()}}return(e=s).\u0275fac=function(o){return new(o||e)},e.\u0275cmp=t.VBU({type:e,selectors:[["app-frota-select"]],inputs:{data:"data",control:"control",placeholder:"placeholder",label:"label",idKey:"idKey",descricaoKey:"descricaoKey",showAddButton:"showAddButton"},outputs:{itemAdd:"itemAdd"},standalone:!0,features:[t.aNF],decls:6,vars:5,consts:[[1,"ion-justify-content-center","ion-align-items-center"],["position","floating"],[3,"formControl","placeholder"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"value"],["slot","end","color","primary",3,"click"],["name","add-circle"]],template:function(o,n){1&o&&(t.j41(0,"ion-item",0)(1,"ion-label",1),t.EFF(2),t.k0s(),t.j41(3,"ion-select",2),t.DNE(4,W,2,2,"ion-select-option",3),t.k0s(),t.DNE(5,z,3,0,"ng-container",4),t.k0s()),2&o&&(t.R7$(2),t.JRh(n.label),t.R7$(),t.Y8G("formControl",n.control)("placeholder",n.placeholder),t.R7$(),t.Y8G("ngForOf",n.data),t.R7$(),t.Y8G("ngIf",n.showAddButton))},dependencies:[p.MD,p.Sq,p.bT,i.bv,i.Jm,i.iq,i.uz,i.he,i.Nm,i.Ip,i.Je,_.iI,c.X1,c.BC,c.l_]}),s})();function K(e,s){if(1&e){const a=t.RV6();t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",1)(3,"ion-button",2),t.bIt("click",function(){t.eBV(a);const n=t.XpG();return t.Njj(n.botaoCancelarModal())}),t.EFF(4,"Voltar"),t.k0s()(),t.j41(5,"ion-buttons",3)(6,"ion-button",4),t.bIt("click",function(){t.eBV(a);const n=t.XpG();return t.Njj(n.botaoConfirmar())}),t.EFF(7," Confirmar "),t.k0s()()()(),t.j41(8,"ion-content",5)(9,"ion-item")(10,"ion-row")(11,"ion-col",6),t.nrm(12,"ion-textarea",7),t.EFF(13),t.k0s()()()()}if(2&e){const a=t.XpG();t.R7$(6),t.Y8G("disabled",!a.descricaoControl.value)("strong",!0),t.R7$(6),t.Y8G("formControl",a.descricaoControl)("placeholder",a.placeholder),t.R7$(),t.SpI(" ",a.descricaoControl.value," ")}}let j=(()=>{var e;class s{constructor(){this.isOpen=!1,this.placeholder="Descri\xe7\xe3o",this.descricaoControl=new c.MJ(""),this.cancelar=new t.bkB,this.confirmar=new t.bkB}botaoCancelarModal(){this.cancelar.emit()}botaoConfirmar(){this.confirmar.emit()}}return(e=s).\u0275fac=function(o){return new(o||e)},e.\u0275cmp=t.VBU({type:e,selectors:[["app-frota-basic-modal"]],inputs:{isOpen:"isOpen",placeholder:"placeholder",descricaoControl:"descricaoControl"},outputs:{cancelar:"cancelar",confirmar:"confirmar"},standalone:!0,features:[t.aNF],decls:2,vars:1,consts:[[3,"isOpen"],["slot","start"],[3,"click"],["slot","end"],[3,"click","disabled","strong"],[1,"ion-padding"],["size","12"],["rows","3","fill","outline",3,"formControl","placeholder"]],template:function(o,n){1&o&&(t.j41(0,"ion-modal",0),t.DNE(1,K,14,5,"ng-template"),t.k0s()),2&o&&t.Y8G("isOpen",n.isOpen)},dependencies:[p.MD,i.bv,i.Jm,i.QW,i.hU,i.W9,i.eU,i.uz,i.ln,i.nc,i.ai,i.Sb,i.Gw,_.iI,c.X1,c.BC,c.l_]}),s})();var b=m(3207),B=m(8313);let A=(()=>{var e;class s{constructor(o,n,r){this.service=o,this.loadingCtrl=n,this.alertCtrl=r,this.modalOpen=!1,this.control=new c.MJ(""),this.descricao=new c.MJ(""),this.data=[]}loadingData(){var o=this;return(0,d.A)(function*(){try{const n=yield(0,b.s)(o.service.getAll());o.data=n}catch(n){throw console.error("Erro ao carregar:",n.message),n}})()}addItem(){this.modalOpen=!0,console.log("Adicionar motivo clicado!")}onModalCancel(){this.modalOpen=!1}onModalConfirm(){var o=this;return(0,d.A)(function*(){var n;yield(0,B.h)(o.loadingCtrl,o.alertCtrl,{mainAction:(n=(0,d.A)(function*(){yield(0,b.s)(o.service.save({descricao:o.descricao.value})),yield o.loadingData(),o.modalOpen=!1}),function(){return n.apply(this,arguments)}),onError:n=>{console.error("Erro ao executar a\xe7\xe3o no modal:",n.message)}})})()}}return(e=s).\u0275fac=function(o){t.QTQ()},e.\u0275prov=t.jDH({token:e,factory:e.\u0275fac,providedIn:"any"}),s})();var Q=m(3103),O=m(9795);let L=(()=>{var e;class s extends A{constructor(o,n,r){super(o,n,r)}ngOnInit(){var o=this;return(0,d.A)(function*(){yield o.loadingData()})()}}return(e=s).\u0275fac=function(o){return new(o||e)(t.rXU(Q.i),t.rXU(O.Xi),t.rXU(i.hG))},e.\u0275cmp=t.VBU({type:e,selectors:[["app-frota-motivo"]],inputs:{control:"control"},standalone:!0,features:[t.Vt3,t.aNF],decls:2,vars:4,consts:[["placeholder","Escolha um motivo","label","Sele\xe7\xe3o de Motivo",3,"itemAdd","data","control"],["placeholder","Digite aqui o motivo",3,"cancelar","confirmar","isOpen","descricaoControl"]],template:function(o,n){1&o&&(t.j41(0,"app-frota-select",0),t.bIt("itemAdd",function(){return n.addItem()}),t.k0s(),t.j41(1,"app-frota-basic-modal",1),t.bIt("cancelar",function(){return n.onModalCancel()})("confirmar",function(){return n.onModalConfirm()}),t.k0s()),2&o&&(t.Y8G("data",n.data)("control",n.control),t.R7$(),t.Y8G("isOpen",n.modalOpen)("descricaoControl",n.descricao))},dependencies:[p.MD,i.bv,_.iI,c.X1,S,j]}),s})();var Z=m(2553);let tt=(()=>{var e;class s extends A{constructor(o,n,r){super(o,n,r)}ngOnInit(){var o=this;return(0,d.A)(function*(){yield o.loadingData()})()}}return(e=s).\u0275fac=function(o){return new(o||e)(t.rXU(Z.G),t.rXU(i.Xi),t.rXU(i.hG))},e.\u0275cmp=t.VBU({type:e,selectors:[["app-frota-destino"]],inputs:{control:"control"},standalone:!0,features:[t.Vt3,t.aNF],decls:2,vars:4,consts:[["placeholder","Escolha um destino","label","Sele\xe7\xe3o de Destino",3,"itemAdd","data","control"],["placeholder","Digite aqui o destino",3,"cancelar","confirmar","isOpen","descricaoControl"]],template:function(o,n){1&o&&(t.j41(0,"app-frota-select",0),t.bIt("itemAdd",function(){return n.addItem()}),t.k0s(),t.j41(1,"app-frota-basic-modal",1),t.bIt("cancelar",function(){return n.onModalCancel()})("confirmar",function(){return n.onModalConfirm()}),t.k0s()),2&o&&(t.Y8G("data",n.data)("control",n.control),t.R7$(),t.Y8G("isOpen",n.modalOpen)("descricaoControl",n.descricao))},dependencies:[p.MD,i.bv,_.iI,c.X1,S,j]}),s})();var ot=m(7106);let nt=(()=>{var e;class s extends A{constructor(o,n,r){super(o,n,r),this.withoutRoutesOpen=!0}ngOnInit(){var o=this;return(0,d.A)(function*(){o.withoutRoutesOpen?yield o.loadingDataWithoutRoutesOpen():yield o.loadingData()})()}loadingDataWithoutRoutesOpen(){var o=this;return(0,d.A)(function*(){try{const n=yield(0,b.s)(o.service.getAllWithoutRoutesOpen());o.data=n}catch(n){throw console.error("Erro ao carregar veiculos:",n.message),n}})()}}return(e=s).\u0275fac=function(o){return new(o||e)(t.rXU(ot.T),t.rXU(i.Xi),t.rXU(O.hG))},e.\u0275cmp=t.VBU({type:e,selectors:[["app-frota-veiculo"]],inputs:{control:"control",withoutRoutesOpen:"withoutRoutesOpen"},standalone:!0,features:[t.Vt3,t.aNF],decls:1,vars:3,consts:[["placeholder","Escolha um ve\xedculo","label","Sele\xe7\xe3o de ve\xedculo",3,"itemAdd","data","control","showAddButton"]],template:function(o,n){1&o&&(t.j41(0,"app-frota-select",0),t.bIt("itemAdd",function(){return n.addItem()}),t.k0s()),2&o&&t.Y8G("data",n.data)("control",n.control)("showAddButton",!1)},dependencies:[p.MD,i.bv,_.iI,c.X1,S]}),s})();var et=m(5964),at=m(5784);const it=e=>({"ion-hide":e});function rt(e,s){if(1&e){const a=t.RV6();t.j41(0,"ion-item",3)(1,"ion-label"),t.EFF(2,"Selecionar motorista:"),t.k0s(),t.qex(3),t.j41(4,"app-button-add-remove",4),t.bIt("buttonClick",function(){t.eBV(a);const n=t.XpG();return t.Njj(n.isOpen=!0)}),t.k0s(),t.bVm(),t.k0s()}if(2&e){const a=t.XpG();t.R7$(4),t.Y8G("ngClass",t.eq3(1,it,a.isFinished))}}function st(e,s){if(1&e){const a=t.RV6();t.j41(0,"ion-item")(1,"div",5)(2,"ion-label",6),t.EFF(3,"Motorista:"),t.k0s(),t.j41(4,"ion-input",7),t.mxI("ngModelChange",function(n){t.eBV(a);const r=t.XpG();return t.DH7(r.motoristaSelecionado.name,n)||(r.motoristaSelecionado.name=n),t.Njj(n)}),t.k0s()(),t.j41(5,"app-button-add-remove",8),t.bIt("buttonClick",function(){t.eBV(a);const n=t.XpG();return t.Njj(n.removerMotorista())}),t.k0s()()}if(2&e){const a=t.XpG();t.R7$(4),t.Y8G("readonly",!0),t.R50("ngModel",a.motoristaSelecionado.name)}}function ct(e,s){if(1&e){const a=t.RV6();t.j41(0,"ion-item",10),t.bIt("click",function(){const n=t.eBV(a).$implicit,r=t.XpG(3);return t.Njj(r.selecionarMotorista(n))}),t.EFF(1),t.k0s()}if(2&e){const a=s.$implicit;t.R7$(),t.SpI(" ",a.name," ")}}function lt(e,s){if(1&e&&(t.j41(0,"ion-list"),t.DNE(1,ct,2,1,"ion-item",13),t.k0s()),2&e){const a=t.XpG(2);t.R7$(),t.Y8G("ngForOf",a.motoristasFiltrados)}}function mt(e,s){1&e&&(t.j41(0,"ion-text"),t.EFF(1," Nenhum motorista encontrado. "),t.k0s())}function dt(e,s){if(1&e){const a=t.RV6();t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",9)(3,"ion-button",10),t.bIt("click",function(){t.eBV(a);const n=t.XpG();return t.Njj(n.isOpen=!1)}),t.EFF(4,"Voltar"),t.k0s()()()(),t.j41(5,"ion-content",11)(6,"ion-item")(7,"ion-searchbar",12),t.mxI("ngModelChange",function(n){t.eBV(a);const r=t.XpG();return t.DH7(r.funcionarioBusca,n)||(r.funcionarioBusca=n),t.Njj(n)}),t.bIt("ionInput",function(){t.eBV(a);const n=t.XpG();return t.Njj(n.buscarMotoristas())}),t.k0s()(),t.DNE(8,lt,2,1,"ion-list",1)(9,mt,2,0,"ion-text",1),t.k0s()}if(2&e){const a=t.XpG();t.R7$(7),t.R50("ngModel",a.funcionarioBusca),t.R7$(),t.Y8G("ngIf",a.motoristasFiltrados.length>0&&a.funcionarioBusca),t.R7$(),t.Y8G("ngIf",0===a.motoristasFiltrados.length&&a.funcionarioBusca)}}let pt=(()=>{var e;class s{constructor(o){this.funcionarioService=o,this.isOpen=!1,this.funcionarios=[],this.funcionarioBusca="",this.motoristasFiltrados=[],this.motoristaSelecionado=null,this.isFinished=!1,(0,F.a)({trashOutline:g.P1A})}ngOnInit(){var o=this;return(0,d.A)(function*(){yield o.carregarMotoristas(),o.getMotoristaIdSubscription=o.control.valueChanges.subscribe(function(){var n=(0,d.A)(function*(r){r&&(yield o.carregarMotoristaSelecionado(r))});return function(r){return n.apply(this,arguments)}}())})()}carregarMotoristas(){var o=this;return(0,d.A)(function*(){const n=o.funcionarioService.getCachedFuncionarios();if(n&&0!==n.length)o.funcionarios=n;else{const r=yield(0,f._)(o.funcionarioService.getAll());o.funcionarios=r}})()}buscarMotoristas(){const o=this.funcionarioBusca.toLowerCase();this.motoristasFiltrados=this.funcionarios.filter(n=>{var r;return null===(r=n.name)||void 0===r?void 0:r.toLowerCase().includes(o)})}selecionarMotorista(o){this.motoristaSelecionado=o,this.control.setValue(o.id),this.isOpen=!1,this.funcionarioBusca="",this.motoristasFiltrados=[]}removerMotorista(){this.motoristaSelecionado=null,this.control.setValue(null)}ngOnChanges(o){var n=this;return(0,d.A)(function*(){if(o.control){const r=o.control.currentValue;r&&r.value&&(yield n.carregarMotoristaSelecionado(r.value))}})()}carregarMotoristaSelecionado(o){var n=this;return(0,d.A)(function*(){try{yield n.carregarMotoristas(),n.motoristaSelecionado=n.funcionarios.find(l=>l.id===o)}catch(r){console.error("Erro ao carregar motorista selecionado:",r)}})()}ngOnDestroy(){this.getMotoristaIdSubscription.unsubscribe()}}return(e=s).\u0275fac=function(o){return new(o||e)(t.rXU(M.r))},e.\u0275cmp=t.VBU({type:e,selectors:[["app-frota-motorista"]],inputs:{control:"control",isFinished:"isFinished"},standalone:!0,features:[t.OA$,t.aNF],decls:5,vars:3,consts:[["class","ion-justify-content-center ion-align-items-center",4,"ngIf"],[4,"ngIf"],[3,"isOpen"],[1,"ion-justify-content-center","ion-align-items-center"],["color","primary",3,"buttonClick","ngClass"],[1,"item-content"],["position","floating"],[3,"ngModelChange","readonly","ngModel"],["color","danger","slot","end",3,"buttonClick"],["slot","start"],[3,"click"],[1,"ion-padding"],["placeholder","Buscar Motorista",3,"ngModelChange","ionInput","ngModel"],[3,"click",4,"ngFor","ngForOf"]],template:function(o,n){1&o&&(t.j41(0,"ion-list"),t.DNE(1,rt,5,3,"ion-item",0)(2,st,6,2,"ion-item",1),t.k0s(),t.j41(3,"ion-modal",2),t.DNE(4,dt,10,3,"ng-template"),t.k0s()),2&o&&(t.R7$(),t.Y8G("ngIf",!n.motoristaSelecionado),t.R7$(),t.Y8G("ngIf",n.motoristaSelecionado),t.R7$(),t.Y8G("isOpen",n.isOpen))},dependencies:[p.MD,p.YU,p.Sq,p.bT,i.bv,i.Jm,i.QW,i.W9,i.eU,i.$w,i.uz,i.he,i.nf,i.S1,i.IO,i.ai,i.Sb,i.Gw,_.iI,c.YN,c.BC,c.vS,k],styles:["ion-item[_ngcontent-%COMP%]{display:flex;align-items:center}ion-item[_ngcontent-%COMP%]   .item-content[_ngcontent-%COMP%]{flex-grow:1;display:flex;flex-direction:column;width:100%}"]}),s})();var ut=m(8663);function _t(e,s){if(1&e){const a=t.RV6();t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),t.EFF(3,"Selecionar Data e Hora"),t.k0s(),t.j41(4,"ion-buttons",6)(5,"ion-button",7),t.bIt("click",function(){t.eBV(a);const n=t.XpG();return t.Njj(n.onCloseModal())}),t.EFF(6,"Voltar"),t.k0s()(),t.j41(7,"ion-buttons",8)(8,"ion-button",9),t.bIt("click",function(){t.eBV(a);const n=t.XpG();return t.Njj(n.onConfirmSelectDate())}),t.EFF(9,"Confirmar"),t.k0s()()()(),t.j41(10,"ion-content",10),t.nrm(11,"ion-datetime",11),t.k0s()}if(2&e){const a=t.XpG();t.R7$(8),t.Y8G("disabled",!a.dataRetornoControl.value)("strong",!0),t.R7$(3),t.Y8G("formControl",a.dataRetornoControl)}}let ht=(()=>{var e;class s{constructor(o){this.datePipe=o,this.openModal=!1}ngOnInit(){this.dataRetornoControl.valueChanges.subscribe(o=>{var n;console.log(o),o&&(this.showDataRetorno=null!==(n=this.datePipe.transform(o,"dd-MM-yyyy HH:mm","pt-BR"))&&void 0!==n?n:"")}),this.dataRetornoControl.setValue(new Date)}onOpenModal(){this.openModal=!0}onCloseModal(){this.openModal=!1}onConfirmSelectDate(){this.openModal=!0}}return(e=s).\u0275fac=function(o){return new(o||e)(t.rXU(p.vh))},e.\u0275cmp=t.VBU({type:e,selectors:[["app-frota-retorno"]],inputs:{dataCard:"dataCard",kmRetornoControl:"kmRetornoControl",dataRetornoControl:"dataRetornoControl",tipoAcompanhanteRetorno:"tipoAcompanhanteRetorno",saveAcompanhanteFrota:"saveAcompanhanteFrota"},standalone:!0,features:[t.Jv_([p.vh]),t.aNF],decls:15,vars:10,consts:[[3,"hideButtonActions","data"],["position","floating"],["type","number",3,"formControl"],[3,"ngModelChange","click","readonly","ngModel"],[3,"tipoAcompanhanteRetorno","saveAcompanhanteFrota","idFrota"],[1,"modal-data-time",3,"isOpen","backdropDismiss"],["slot","start"],[3,"click"],["slot","end"],[3,"click","disabled","strong"],[1,"ion-padding"],["presentation","date-time",3,"formControl"]],template:function(o,n){1&o&&(t.nrm(0,"app-card",0),t.j41(1,"ion-grid")(2,"ion-row")(3,"ion-col")(4,"ion-item")(5,"ion-label",1),t.EFF(6,"Km Retorno"),t.k0s(),t.nrm(7,"ion-input",2),t.k0s(),t.j41(8,"ion-item")(9,"ion-label",1),t.EFF(10,"Data e hora de retorno"),t.k0s(),t.j41(11,"ion-input",3),t.mxI("ngModelChange",function(l){return t.DH7(n.showDataRetorno,l)||(n.showDataRetorno=l),l}),t.bIt("click",function(){return n.onOpenModal()}),t.k0s()(),t.nrm(12,"app-frota-acompanhantes",4),t.j41(13,"ion-modal",5),t.DNE(14,_t,12,3,"ng-template"),t.k0s()()()()),2&o&&(t.Y8G("hideButtonActions",!0)("data",n.dataCard),t.R7$(7),t.Y8G("formControl",n.kmRetornoControl),t.R7$(4),t.Y8G("readonly",!0),t.R50("ngModel",n.showDataRetorno),t.R7$(),t.Y8G("tipoAcompanhanteRetorno",n.tipoAcompanhanteRetorno)("saveAcompanhanteFrota",n.saveAcompanhanteFrota)("idFrota",n.dataCard.id),t.R7$(),t.Y8G("isOpen",n.openModal)("backdropDismiss",!1))},dependencies:[i.bv,i.Jm,i.QW,i.hU,i.W9,i.A9,i.lO,i.eU,i.$w,i.uz,i.he,i.ln,i.BC,i.ai,i.Sb,i.su,i.Je,i.Gw,p.MD,ut.i,c.X1,c.BC,c.l_,c.YN,c.vS,I]}),s})();var ft=m(9457),Ft=m(2177);let gt=(()=>{var e;class s{constructor(o){this.baseApiService=o,this.endpoint="api/IdentificacaoFuncionario"}getImage(o){var n=this;return(0,d.A)(function*(){const r=yield(0,b.s)(n.baseApiService.get(`${n.endpoint}/GetImageFunc/${o}`,void 0,"blob"));return r?URL.createObjectURL(r):null})()}}return(e=s).\u0275fac=function(o){return new(o||e)(t.KVO(y.v))},e.\u0275prov=t.jDH({token:e,factory:e.\u0275fac,providedIn:"root"}),s})(),Ct=(()=>{var e;class s{constructor(o){this.fb=o}createSaidaFrotaForm(){return this.fb.group({dataHoraSaida:[null,c.k0.required],imobilizadoCod:[null,c.k0.required],destinoSeq:[null,c.k0.required],quilometragemNaSaida:[null,[c.k0.required,c.k0.min(0)]],motivoSeq:[null,c.k0.required],funcCod:[null,c.k0.required],obs:[""]})}addRetornoControls(o,n){o.addControl("quilometragemNoRetorno",new c.MJ(n+1,[c.k0.required,c.k0.min(null!=n?n:1)])),o.addControl("dataHoraRetorno",new c.MJ(new Date,c.k0.required))}}return(e=s).\u0275fac=function(o){return new(o||e)(t.KVO(c.ok))},e.\u0275prov=t.jDH({token:e,factory:e.\u0275fac,providedIn:"root"}),s})();function vt(e,s){if(1&e&&(t.qex(0),t.nrm(1,"app-frota-retorno",11),t.bVm()),2&e){const a=t.XpG();t.R7$(),t.Y8G("dataCard",a.dataSharedCard)("kmRetornoControl",a.form.controls.quilometragemNoRetorno)("dataRetornoControl",a.form.controls.dataHoraRetorno)("tipoAcompanhanteRetorno",a.isClose)("saveAcompanhanteFrota",a.sendSaidaIdForAcompanhante)}}function bt(e,s){if(1&e&&(t.qex(0),t.nrm(1,"app-frota-veiculo",18),t.bVm()),2&e){const a=t.XpG(2);t.R7$(),t.Y8G("control",a.form.controls.imobilizadoCod)("withoutRoutesOpen",!1)}}function St(e,s){if(1&e&&(t.qex(0),t.nrm(1,"app-frota-veiculo",13),t.bVm()),2&e){const a=t.XpG(2);t.R7$(),t.Y8G("control",a.form.controls.imobilizadoCod)}}function At(e,s){if(1&e&&(t.qex(0),t.j41(1,"ion-grid",12)(2,"ion-row")(3,"ion-col"),t.nrm(4,"app-frota-motorista",13),t.DNE(5,bt,2,2,"ng-container",10)(6,St,2,1,"ng-container",10),t.nrm(7,"app-frota-destino",13),t.j41(8,"ion-item")(9,"ion-label",14),t.EFF(10,"Km Sa\xedda"),t.k0s(),t.nrm(11,"ion-input",15),t.k0s(),t.nrm(12,"app-frota-motivo",13),t.j41(13,"ion-item")(14,"ion-label",14),t.EFF(15,"Observa\xe7\xf5es"),t.k0s(),t.nrm(16,"ion-textarea",16),t.k0s(),t.nrm(17,"app-frota-acompanhantes",17),t.k0s()()(),t.bVm()),2&e){const a=t.XpG();t.R7$(),t.Y8G("formGroup",a.form),t.R7$(3),t.Y8G("control",a.form.controls.funcCod),t.R7$(),t.Y8G("ngIf",a.id),t.R7$(),t.Y8G("ngIf",!a.id),t.R7$(),t.Y8G("control",a.form.controls.destinoSeq),t.R7$(5),t.Y8G("control",a.form.controls.motivoSeq),t.R7$(5),t.Y8G("tipoAcompanhanteRetorno",a.isClose)("saveAcompanhanteFrota",a.sendSaidaIdForAcompanhante)("idFrota",a.id)}}let Rt=(()=>{var e;class s{constructor(o,n,r,l,u,C,R,kt,Mt){this.fb=o,this.frotaSaidaSrv=n,this.loaddingCtrl=r,this.alertCtrl=l,this.router=u,this.route=C,this.dataSharedCardSrv=R,this.identificacaoFuncSrv=kt,this.frotaSaidaForm=Mt,this.id=null,this.sendSaidaIdForAcompanhante=null,this.isClose=!1,this.routeSubscription=null,this.appRoutes=at.S,this.dataSharedCard=null,this.openModalDataTime=!1,this.changeFuncCodSubscription=null,this.srcFotoMotorista="assets/user.png",this.form=this.frotaSaidaForm.createSaidaFrotaForm()}ngOnInit(){var o=this;return(0,d.A)(function*(){o.updateRouteData(),o.changeFuncCodSubscription=o.form.controls.funcCod.valueChanges.subscribe(function(){var n=(0,d.A)(function*(r){const l=yield o.identificacaoFuncSrv.getImage(2739);r&&l&&(o.srcFotoMotorista=yield o.identificacaoFuncSrv.getImage(2739)),r||(o.srcFotoMotorista="assets/user.png")});return function(r){return n.apply(this,arguments)}}()),o.routeSubscription=o.router.events.pipe((0,et.p)(n=>n instanceof _.wF)).subscribe((0,d.A)(function*(){return yield o.updateRouteData()}))})()}updateRouteData(){var o=this;return(0,d.A)(function*(){if(o.id=Number(o.route.snapshot.paramMap.get("id"))||null,o.isClose=o.route.snapshot.url.some(r=>"close"===r.path),o.dataSharedCard=yield o.dataSharedCardSrv.getData(),o.isClose){var n;o.dataSharedCard||(o.dataSharedCard=yield o.dataSharedCardSrv.getData());const r=null===(n=o.dataSharedCard)||void 0===n?void 0:n.quilometragemNaSaida;o.frotaSaidaForm.addRetornoControls(o.form,null!=r?r:1)}o.id&&(o.dataSharedCard||(o.dataSharedCard=yield o.dataSharedCardSrv.getData()),o.dataSharedCard?o.form.patchValue(o.dataSharedCard):o.getDataForEditForm(o.id))})()}getDataForEditForm(o){this.frotaSaidaSrv.getById(o).subscribe(n=>{this.dataSharedCard=n,this.form.patchValue(n)})}onSubmit(){var o=this;return(0,d.A)(function*(){var n,r;o.id||o.isClose||null===(n=o.form.get("dataHoraSaida"))||void 0===n||n.setValue(new Date),o.form.valid?yield(0,B.h)(o.loaddingCtrl,o.alertCtrl,{mainAction:(r=(0,d.A)(function*(){const l=o.form.value;if(o.isClose||o.id){const u=yield(0,f._)(o.frotaSaidaSrv.update(o.id,l));o.sendSaidaIdForAcompanhante=null==u?void 0:u.id}else{const u=yield(0,f._)(o.frotaSaidaSrv.save(l));o.sendSaidaIdForAcompanhante=null==u?void 0:u.id}}),function(){return r.apply(this,arguments)}),onAfterTryDismiss:()=>o.router.navigate([o.appRoutes.list.path]),onError:r=>console.error("Erro ao salvar:",r)}):console.log("Formul\xe1rio inv\xe1lido")})()}msgCloseForm(){var o=this;return(0,d.A)(function*(){const n=yield o.alertCtrl.create({header:"Sair do cadastro de rota",message:"Voc\xea tem certeza que quer sair do cadastro de rota? Ao sair, suas modifica\xe7\xf5es ser\xe3o perdidas!",buttons:[{text:"Continuar nesta Tela",role:"cancel"},{text:"Sair",handler:()=>o.router.navigate(["/home"])}]});o.form.dirty?yield n.present():o.router.navigate(["/home"])})()}ngOnDestroy(){var o;null===(o=this.routeSubscription)||void 0===o||o.unsubscribe()}}return(e=s).\u0275fac=function(o){return new(o||e)(t.rXU(c.ok),t.rXU(ft.g),t.rXU(i.Xi),t.rXU(i.hG),t.rXU(_.Ix),t.rXU(_.nX),t.rXU(Ft.w),t.rXU(gt),t.rXU(Ct))},e.\u0275cmp=t.VBU({type:e,selectors:[["app-form"]],standalone:!0,features:[t.aNF],decls:19,vars:6,consts:[[3,"translucent"],["color","primary"],["slot","start"],["color","light",3,"click"],["slot","end"],[3,"fullscreen"],[1,"box-content"],[1,"ion-justify-content-center","ion-align-items-center"],["size","auto"],["alt","Foto de perfil",3,"src"],[4,"ngIf"],[3,"dataCard","kmRetornoControl","dataRetornoControl","tipoAcompanhanteRetorno","saveAcompanhanteFrota"],[3,"formGroup"],[3,"control"],["position","floating"],["type","number","formControlName","quilometragemNaSaida"],["formControlName","obs"],[3,"tipoAcompanhanteRetorno","saveAcompanhanteFrota","idFrota"],[3,"control","withoutRoutesOpen"]],template:function(o,n){1&o&&(t.j41(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-buttons",2)(3,"ion-button",3),t.bIt("click",function(){return n.msgCloseForm()}),t.EFF(4,"Sair"),t.k0s()(),t.j41(5,"ion-title"),t.EFF(6),t.k0s(),t.j41(7,"ion-buttons",4)(8,"ion-button",3),t.bIt("click",function(){return n.onSubmit()}),t.EFF(9,"Salvar"),t.k0s()()()(),t.j41(10,"ion-content",5)(11,"div",6)(12,"ion-grid")(13,"ion-row",7)(14,"ion-col",8)(15,"ion-avatar"),t.nrm(16,"img",9),t.k0s()()()(),t.DNE(17,vt,2,5,"ng-container",10)(18,At,18,9,"ng-container",10),t.k0s()()),2&o&&(t.Y8G("translucent",!0),t.R7$(6),t.JRh(n.isClose?"Finalizar percurso":n.id?"Editar percurso":"Iniciar percurso"),t.R7$(4),t.Y8G("fullscreen",!0),t.R7$(6),t.Y8G("src",n.srcFotoMotorista,t.B4B),t.R7$(),t.Y8G("ngIf",n.isClose&&!!n.dataSharedCard),t.R7$(),t.Y8G("ngIf",!n.isClose))},dependencies:[p.MD,p.bT,i.bv,i.mC,i.Jm,i.QW,i.hU,i.W9,i.lO,i.eU,i.$w,i.uz,i.he,i.ln,i.nc,i.BC,i.ai,i.su,i.Gw,_.iI,c.X1,c.BC,c.cb,c.j4,c.JD,I,L,tt,nt,pt,c.YN,ht],styles:["[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .box-content[_ngcontent-%COMP%]{display:block;max-width:800px;margin:0 auto}[_nghost-%COMP%]   ion-avatar[_ngcontent-%COMP%]{height:200px;width:200px}[_nghost-%COMP%]   ion-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{object-fit:contain}"]}),s})()},3207:(D,v,m)=>{m.d(v,{s:()=>p});var d=m(9350);function p(c,_){const i="object"==typeof _;return new Promise((t,f)=>{let F,h=!1;c.subscribe({next:g=>{F=g,h=!0},error:f,complete:()=>{h?t(F):i?t(_.defaultValue):f(new d.G)}})})}}}]);