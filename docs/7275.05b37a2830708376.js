"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7275],{7275:(B,C,l)=>{l.r(C),l.d(C,{FormPage:()=>St});var m=l(467),p=l(177),c=l(4341),_=l(7471),i=l(4742),t=l(4438),f=l(4843),h=function(e){return e[e.Saida=0]="Saida",e[e.Retorno=1]="Retorno",e}(h||{}),F=l(5079),g=l(5873);function T(e,s){if(1&e&&t.nrm(0,"ion-icon",3),2&e){const a=t.XpG();t.Y8G("name","primary"===a.color?"add-circle":"trash-outline")}}function O(e,s){if(1&e&&(t.j41(0,"ion-label"),t.EFF(1),t.k0s()),2&e){const a=t.XpG();t.R7$(),t.JRh(a.text)}}let D=(()=>{var e;class s{constructor(){this.color="primary",this.text="",this.disabled=!1,this.slot="end",this.buttonClick=new t.bkB,(0,F.a)({addCircle:g.YH_,trashOutline:g.P1A})}onClick(){this.disabled||this.buttonClick.emit()}}return(e=s).\u0275fac=function(o){return new(o||e)},e.\u0275cmp=t.VBU({type:e,selectors:[["app-button-add-remove"]],inputs:{color:"color",text:"text",disabled:"disabled",slot:"slot"},outputs:{buttonClick:"buttonClick"},standalone:!0,features:[t.aNF],decls:3,vars:5,consts:[[3,"click","color","disabled","slot"],["slot","icon-only",3,"name",4,"ngIf"],[4,"ngIf"],["slot","icon-only",3,"name"]],template:function(o,n){1&o&&(t.j41(0,"ion-button",0),t.bIt("click",function(){return n.onClick()}),t.DNE(1,T,1,1,"ion-icon",1)(2,O,2,1,"ion-label",2),t.k0s()),2&o&&(t.Y8G("color",n.color)("disabled",n.disabled)("slot",n.slot),t.R7$(),t.Y8G("ngIf",!n.text),t.R7$(),t.Y8G("ngIf",n.text))},dependencies:[p.MD,p.bT,i.bv,i.Jm,i.iq,i.he]}),s})();var k=l(2705),G=l(9684);let V=(()=>{var e;class s{constructor(o){this.baseApiService=o,this.endpoint="api/AcompanhanteFrota"}getAll(o,n){return this.baseApiService.get(`${this.endpoint}/GetAll/${o}/${n}`)}save(o){return this.baseApiService.post(`${this.endpoint}/AddMultiple`,o)}}return(e=s).\u0275fac=function(o){return new(o||e)(t.KVO(G.v))},e.\u0275prov=t.jDH({token:e,factory:e.\u0275fac,providedIn:"root"}),s})();const M=e=>({"ion-hide":e});function E(e,s){1&e&&t.eu8(0)}function $(e,s){1&e&&t.eu8(0)}function X(e,s){if(1&e){const a=t.RV6();t.j41(0,"ion-item",8),t.bIt("click",function(){const n=t.eBV(a).$implicit,r=t.XpG(3);return t.Njj(r.adicionarAcompanhante(n))}),t.EFF(1),t.k0s()}if(2&e){const a=s.$implicit;t.R7$(),t.SpI(" ",a.name," ")}}function Y(e,s){if(1&e&&(t.j41(0,"ion-list"),t.DNE(1,X,2,1,"ion-item",14),t.k0s()),2&e){const a=t.XpG(2);t.R7$(),t.Y8G("ngForOf",a.acompanhantesFiltrados)}}function x(e,s){1&e&&t.eu8(0)}function N(e,s){1&e&&t.eu8(0)}function U(e,s){if(1&e){const a=t.RV6();t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",7)(3,"ion-button",8),t.bIt("click",function(){t.eBV(a);const n=t.XpG();return t.Njj(n.isOpen=!1)}),t.EFF(4,"Voltar"),t.k0s()(),t.j41(5,"ion-buttons",9)(6,"ion-button",10),t.bIt("click",function(){t.eBV(a);const n=t.XpG();return t.Njj(n.isOpen=!1)}),t.EFF(7," Salvar "),t.k0s()()()(),t.j41(8,"ion-content",11)(9,"ion-item")(10,"ion-searchbar",12),t.mxI("ngModelChange",function(n){t.eBV(a);const r=t.XpG();return t.DH7(r.acompanhanteBusca,n)||(r.acompanhanteBusca=n),t.Njj(n)}),t.bIt("ionInput",function(){t.eBV(a);const n=t.XpG();return t.Njj(n.buscarAcompanhantes())}),t.k0s()(),t.DNE(11,Y,2,1,"ion-list",13)(12,x,1,0,"ng-container",5)(13,N,1,0,"ng-container",5),t.k0s()}if(2&e){const a=t.XpG(),o=t.sdS(11),n=t.sdS(13);t.R7$(6),t.Y8G("strong",!0),t.R7$(4),t.R50("ngModel",a.acompanhanteBusca),t.R7$(),t.Y8G("ngIf",a.acompanhantesFiltrados.length>0&&a.acompanhantesSelecionados.length<4&&a.acompanhanteBusca),t.R7$(),t.Y8G("ngTemplateOutlet",o),t.R7$(),t.Y8G("ngTemplateOutlet",n)}}function w(e,s){if(1&e){const a=t.RV6();t.j41(0,"ion-item")(1,"ion-label"),t.EFF(2),t.k0s(),t.nrm(3,"ion-input",3),t.j41(4,"app-button-add-remove",16),t.bIt("buttonClick",function(){const n=t.eBV(a).$implicit,r=t.XpG(2);return t.Njj(r.removerAcompanhante(n))}),t.k0s()()}if(2&e){const a=s.$implicit,o=t.XpG(2);t.R7$(2),t.JRh(a.name),t.R7$(),t.Y8G("disabled",!0),t.R7$(),t.Y8G("ngClass",t.eq3(3,M,o.isFinished))}}function P(e,s){if(1&e&&(t.j41(0,"ion-list"),t.DNE(1,w,5,5,"ion-item",15),t.k0s()),2&e){const a=t.XpG();t.R7$(),t.Y8G("ngForOf",a.acompanhantesSelecionados)}}function J(e,s){1&e&&(t.j41(0,"p",18)(1,"strong"),t.EFF(2,"M\xe1ximo de 4 acompanhantes selecionados."),t.k0s()())}function q(e,s){1&e&&(t.j41(0,"p",18)(1,"strong"),t.EFF(2,"Nenhum acompanhante selecionado."),t.k0s()())}function H(e,s){if(1&e&&t.DNE(0,J,3,0,"p",17)(1,q,3,0,"p",17),2&e){const a=t.XpG();t.Y8G("ngIf",a.acompanhantesSelecionados.length>=4),t.R7$(),t.Y8G("ngIf",a.acompanhantesSelecionados.length<1)}}let K=(()=>{var e;class s{constructor(o,n){this.funcionarioService=o,this.acompanhanteFrotaSrv=n,this.isOpen=!1,this.acompanhantes=[],this.acompanhanteBusca="",this.acompanhantesFiltrados=[],this.acompanhantesSelecionados=[],this.tipoAcompanhanteRetorno=!1,this.isFinished=!1,this.statusSaveAcompanhanteFrota=new t.bkB}ngOnInit(){var o=this;return(0,m.A)(function*(){yield o.carregarAcompanhantes()})()}ngOnChanges(o){var n=this;return(0,m.A)(function*(){if(o.saveAcompanhanteFrota){const r=o.saveAcompanhanteFrota.currentValue;r&&(yield n.submitFrotaAcompanhante(r))}o.idFrota&&n.idFrota&&(yield n.carregarAcompanhantesSelecionados(n.idFrota)),o.tipoAcompanhanteRetorno&&n.idFrota&&(yield n.carregarAcompanhantesSelecionados(n.idFrota))})()}carregarAcompanhantesSelecionados(o){var n=this;return(0,m.A)(function*(){try{let d;d=n.isFinished&&n.tipoAcompanhanteRetorno?yield(0,f._)(n.acompanhanteFrotaSrv.getAll(o,h.Retorno)):yield(0,f._)(n.acompanhanteFrotaSrv.getAll(o,h.Saida)),yield n.carregarAcompanhantes();const u=n.acompanhantes;console.log(u),n.acompanhantesSelecionados=d.map(v=>u.find(R=>R.id===v.funcCod)).filter(v=>null!=v),console.log(n.acompanhantesSelecionados)}catch(d){console.error("Erro ao carregar acompanhantes selecionados:",d)}})()}carregarAcompanhantes(){var o=this;return(0,m.A)(function*(){const n=o.funcionarioService.getCachedFuncionarios();if(n&&0!==n.length)o.acompanhantes=n;else{const r=yield yield(0,f._)(o.funcionarioService.getAll());o.acompanhantes=r}})()}buscarAcompanhantes(){const o=this.acompanhanteBusca.toLowerCase();this.acompanhantesFiltrados=this.acompanhantes.filter(n=>n.name.toLowerCase().includes(o)&&!this.acompanhantesSelecionados.some(r=>r.id===n.id))}adicionarAcompanhante(o){this.acompanhantesSelecionados.length<4&&(this.acompanhantesSelecionados.push(o),this.acompanhanteBusca="",this.acompanhantesFiltrados=[])}removerAcompanhante(o){this.acompanhantesSelecionados=this.acompanhantesSelecionados.filter(n=>n.id!==o.id)}submitFrotaAcompanhante(o){var n=this;return(0,m.A)(function*(){const r=n.tipoAcompanhanteRetorno?h.Retorno:h.Saida,d=n.acompanhantesSelecionados.map(u=>({frotaSeq:o,tipo:r,funcCod:u.id}));n.acompanhanteFrotaSrv.save(d).subscribe({next:()=>{console.log("Acompanhantes Frota salvos com sucesso:",d),n.statusSaveAcompanhanteFrota.emit(!0)},error:u=>{console.error("Erro ao salvar acompanhantes frota:",u),n.statusSaveAcompanhanteFrota.emit(!1)}})})()}}return(e=s).\u0275fac=function(o){return new(o||e)(t.rXU(k.r),t.rXU(V))},e.\u0275cmp=t.VBU({type:e,selectors:[["app-frota-acompanhantes"]],inputs:{tipoAcompanhanteRetorno:"tipoAcompanhanteRetorno",saveAcompanhanteFrota:"saveAcompanhanteFrota",idFrota:"idFrota",isFinished:"isFinished"},outputs:{statusSaveAcompanhanteFrota:"statusSaveAcompanhanteFrota"},standalone:!0,features:[t.OA$,t.aNF],decls:14,vars:7,consts:[["listaAcompanhantesSelecionados",""],["mensagensAcompanhantes",""],[1,"ion-justify-content-center","ion-align-items-center"],[2,"width","0","height","0",3,"disabled"],["color","primary",3,"buttonClick","ngClass"],[4,"ngTemplateOutlet"],[3,"isOpen"],["slot","start"],[3,"click"],["slot","end"],[3,"click","strong"],[1,"ion-padding"],["placeholder","Buscar Acompanhante",3,"ngModelChange","ionInput","ngModel"],[4,"ngIf"],[3,"click",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["color","danger",3,"buttonClick","ngClass"],["class","ion-text-center",4,"ngIf"],[1,"ion-text-center"]],template:function(o,n){if(1&o){const r=t.RV6();t.j41(0,"ion-list")(1,"ion-item",2)(2,"ion-label"),t.EFF(3,"Acompanhante(s) selecionado(s)"),t.k0s(),t.nrm(4,"ion-input",3),t.j41(5,"app-button-add-remove",4),t.bIt("buttonClick",function(){return t.eBV(r),t.Njj(n.isOpen=!0)}),t.k0s()(),t.DNE(6,E,1,0,"ng-container",5)(7,$,1,0,"ng-container",5),t.k0s(),t.j41(8,"ion-modal",6),t.DNE(9,U,14,5,"ng-template"),t.k0s(),t.DNE(10,P,2,1,"ng-template",null,0,t.C5r)(12,H,2,2,"ng-template",null,1,t.C5r)}if(2&o){const r=t.sdS(11),d=t.sdS(13);t.R7$(4),t.Y8G("disabled",!0),t.R7$(),t.Y8G("ngClass",t.eq3(5,M,n.isFinished)),t.R7$(),t.Y8G("ngTemplateOutlet",r),t.R7$(),t.Y8G("ngTemplateOutlet",d),t.R7$(),t.Y8G("isOpen",n.isOpen)}},dependencies:[p.MD,p.YU,p.Sq,p.bT,p.T3,i.bv,i.Jm,i.QW,i.W9,i.eU,i.$w,i.uz,i.he,i.nf,i.S1,i.ai,i.Sb,i.Gw,_.iI,c.YN,c.BC,c.vS,D]}),s})();function z(e,s){if(1&e&&(t.j41(0,"ion-select-option",5),t.EFF(1),t.k0s()),2&e){const a=s.$implicit,o=t.XpG();t.Y8G("value",a[o.idKey]),t.R7$(),t.SpI(" ",a[o.descricaoKey]||""," ")}}function W(e,s){if(1&e){const a=t.RV6();t.qex(0),t.j41(1,"ion-button",6),t.bIt("click",function(){t.eBV(a);const n=t.XpG();return t.Njj(n.add())}),t.nrm(2,"ion-icon",7),t.k0s(),t.bVm()}}let A=(()=>{var e;class s{constructor(){this.data=[],this.control=new c.MJ,this.placeholder="Selecione um motivo",this.label="Motivo",this.idKey="id",this.descricaoKey="descricao",this.showAddButton=!0,this.itemAdd=new t.bkB,(0,F.a)({addCircle:g.YH_})}add(){this.itemAdd.emit()}}return(e=s).\u0275fac=function(o){return new(o||e)},e.\u0275cmp=t.VBU({type:e,selectors:[["app-frota-select"]],inputs:{data:"data",control:"control",placeholder:"placeholder",label:"label",idKey:"idKey",descricaoKey:"descricaoKey",showAddButton:"showAddButton"},outputs:{itemAdd:"itemAdd"},standalone:!0,features:[t.aNF],decls:6,vars:5,consts:[[1,"ion-justify-content-center","ion-align-items-center"],["position","floating"],[3,"formControl","placeholder"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"value"],["slot","end","color","primary",3,"click"],["name","add-circle"]],template:function(o,n){1&o&&(t.j41(0,"ion-item",0)(1,"ion-label",1),t.EFF(2),t.k0s(),t.j41(3,"ion-select",2),t.DNE(4,z,2,2,"ion-select-option",3),t.k0s(),t.DNE(5,W,3,0,"ng-container",4),t.k0s()),2&o&&(t.R7$(2),t.JRh(n.label),t.R7$(),t.Y8G("formControl",n.control)("placeholder",n.placeholder),t.R7$(),t.Y8G("ngForOf",n.data),t.R7$(),t.Y8G("ngIf",n.showAddButton))},dependencies:[p.MD,p.Sq,p.bT,i.bv,i.Jm,i.iq,i.uz,i.he,i.Nm,i.Ip,i.Je,_.iI,c.X1,c.BC,c.l_]}),s})();function L(e,s){if(1&e){const a=t.RV6();t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",1)(3,"ion-button",2),t.bIt("click",function(){t.eBV(a);const n=t.XpG();return t.Njj(n.botaoCancelarModal())}),t.EFF(4,"Voltar"),t.k0s()(),t.j41(5,"ion-buttons",3)(6,"ion-button",4),t.bIt("click",function(){t.eBV(a);const n=t.XpG();return t.Njj(n.botaoConfirmar())}),t.EFF(7," Confirmar "),t.k0s()()()(),t.j41(8,"ion-content",5)(9,"ion-item")(10,"ion-row")(11,"ion-col",6),t.nrm(12,"ion-textarea",7),t.EFF(13),t.k0s()()()()}if(2&e){const a=t.XpG();t.R7$(6),t.Y8G("disabled",!a.descricaoControl.value)("strong",!0),t.R7$(6),t.Y8G("formControl",a.descricaoControl)("placeholder",a.placeholder),t.R7$(),t.SpI(" ",a.descricaoControl.value," ")}}let j=(()=>{var e;class s{constructor(){this.isOpen=!1,this.placeholder="Descri\xe7\xe3o",this.descricaoControl=new c.MJ(""),this.cancelar=new t.bkB,this.confirmar=new t.bkB}botaoCancelarModal(){this.cancelar.emit()}botaoConfirmar(){this.confirmar.emit()}}return(e=s).\u0275fac=function(o){return new(o||e)},e.\u0275cmp=t.VBU({type:e,selectors:[["app-frota-basic-modal"]],inputs:{isOpen:"isOpen",placeholder:"placeholder",descricaoControl:"descricaoControl"},outputs:{cancelar:"cancelar",confirmar:"confirmar"},standalone:!0,features:[t.aNF],decls:2,vars:1,consts:[[3,"isOpen"],["slot","start"],[3,"click"],["slot","end"],[3,"click","disabled","strong"],[1,"ion-padding"],["size","12"],["rows","3","fill","outline",3,"formControl","placeholder"]],template:function(o,n){1&o&&(t.j41(0,"ion-modal",0),t.DNE(1,L,14,5,"ng-template"),t.k0s()),2&o&&t.Y8G("isOpen",n.isOpen)},dependencies:[p.MD,i.bv,i.Jm,i.QW,i.hU,i.W9,i.eU,i.uz,i.ln,i.nc,i.ai,i.Sb,i.Gw,_.iI,c.X1,c.BC,c.l_]}),s})();var b=l(3207),y=l(8313);let S=(()=>{var e;class s{constructor(o,n,r){this.service=o,this.loadingCtrl=n,this.alertCtrl=r,this.modalOpen=!1,this.control=new c.MJ(""),this.descricao=new c.MJ(""),this.data=[]}loadingData(){var o=this;return(0,m.A)(function*(){try{const n=yield(0,b.s)(o.service.getAll());o.data=n}catch(n){throw console.error("Erro ao carregar:",n.message),n}})()}addItem(){this.modalOpen=!0,console.log("Adicionar motivo clicado!")}onModalCancel(){this.modalOpen=!1}onModalConfirm(){var o=this;return(0,m.A)(function*(){var n;yield(0,y.h)(o.loadingCtrl,o.alertCtrl,{mainAction:(n=(0,m.A)(function*(){yield(0,b.s)(o.service.save({descricao:o.descricao.value})),yield o.loadingData(),o.modalOpen=!1}),function(){return n.apply(this,arguments)}),onError:n=>{console.error("Erro ao executar a\xe7\xe3o no modal:",n.message)}})})()}}return(e=s).\u0275fac=function(o){t.QTQ()},e.\u0275prov=t.jDH({token:e,factory:e.\u0275fac,providedIn:"any"}),s})();var Q=l(3103),I=l(9795);let Z=(()=>{var e;class s extends S{constructor(o,n,r){super(o,n,r)}ngOnInit(){var o=this;return(0,m.A)(function*(){yield o.loadingData()})()}}return(e=s).\u0275fac=function(o){return new(o||e)(t.rXU(Q.i),t.rXU(I.Xi),t.rXU(i.hG))},e.\u0275cmp=t.VBU({type:e,selectors:[["app-frota-motivo"]],inputs:{control:"control"},standalone:!0,features:[t.Vt3,t.aNF],decls:2,vars:4,consts:[["placeholder","Escolha um motivo","label","Sele\xe7\xe3o de Motivo",3,"itemAdd","data","control"],["placeholder","Digite aqui o motivo",3,"cancelar","confirmar","isOpen","descricaoControl"]],template:function(o,n){1&o&&(t.j41(0,"app-frota-select",0),t.bIt("itemAdd",function(){return n.addItem()}),t.k0s(),t.j41(1,"app-frota-basic-modal",1),t.bIt("cancelar",function(){return n.onModalCancel()})("confirmar",function(){return n.onModalConfirm()}),t.k0s()),2&o&&(t.Y8G("data",n.data)("control",n.control),t.R7$(),t.Y8G("isOpen",n.modalOpen)("descricaoControl",n.descricao))},dependencies:[p.MD,i.bv,_.iI,c.X1,A,j]}),s})();var tt=l(2553);let ot=(()=>{var e;class s extends S{constructor(o,n,r){super(o,n,r)}ngOnInit(){var o=this;return(0,m.A)(function*(){yield o.loadingData()})()}}return(e=s).\u0275fac=function(o){return new(o||e)(t.rXU(tt.G),t.rXU(i.Xi),t.rXU(i.hG))},e.\u0275cmp=t.VBU({type:e,selectors:[["app-frota-destino"]],inputs:{control:"control"},standalone:!0,features:[t.Vt3,t.aNF],decls:2,vars:4,consts:[["placeholder","Escolha um destino","label","Sele\xe7\xe3o de Destino",3,"itemAdd","data","control"],["placeholder","Digite aqui o destino",3,"cancelar","confirmar","isOpen","descricaoControl"]],template:function(o,n){1&o&&(t.j41(0,"app-frota-select",0),t.bIt("itemAdd",function(){return n.addItem()}),t.k0s(),t.j41(1,"app-frota-basic-modal",1),t.bIt("cancelar",function(){return n.onModalCancel()})("confirmar",function(){return n.onModalConfirm()}),t.k0s()),2&o&&(t.Y8G("data",n.data)("control",n.control),t.R7$(),t.Y8G("isOpen",n.modalOpen)("descricaoControl",n.descricao))},dependencies:[p.MD,i.bv,_.iI,c.X1,A,j]}),s})();var nt=l(7106);let et=(()=>{var e;class s extends S{constructor(o,n,r){super(o,n,r),this.withoutRoutesOpen=!0}ngOnInit(){var o=this;return(0,m.A)(function*(){o.withoutRoutesOpen?yield o.loadingDataWithoutRoutesOpen():yield o.loadingData()})()}loadingDataWithoutRoutesOpen(){var o=this;return(0,m.A)(function*(){try{const n=yield(0,b.s)(o.service.getAllWithoutRoutesOpen());o.data=n}catch(n){throw console.error("Erro ao carregar veiculos:",n.message),n}})()}}return(e=s).\u0275fac=function(o){return new(o||e)(t.rXU(nt.T),t.rXU(i.Xi),t.rXU(I.hG))},e.\u0275cmp=t.VBU({type:e,selectors:[["app-frota-veiculo"]],inputs:{control:"control",withoutRoutesOpen:"withoutRoutesOpen"},standalone:!0,features:[t.Vt3,t.aNF],decls:1,vars:3,consts:[["placeholder","Escolha um ve\xedculo","label","Sele\xe7\xe3o de ve\xedculo",3,"itemAdd","data","control","showAddButton"]],template:function(o,n){1&o&&(t.j41(0,"app-frota-select",0),t.bIt("itemAdd",function(){return n.addItem()}),t.k0s()),2&o&&t.Y8G("data",n.data)("control",n.control)("showAddButton",!1)},dependencies:[p.MD,i.bv,_.iI,c.X1,A]}),s})();var at=l(5964),it=l(5784),rt=l(8663);const st=e=>({"ion-hide":e});function ct(e,s){if(1&e){const a=t.RV6();t.j41(0,"ion-item",3)(1,"ion-label"),t.EFF(2,"Selecionar motorista:"),t.k0s(),t.qex(3),t.j41(4,"ion-button",4),t.bIt("click",function(){t.eBV(a);const n=t.XpG();return t.Njj(n.isOpen=!0)}),t.nrm(5,"ion-icon",5),t.k0s(),t.bVm(),t.k0s()}if(2&e){const a=t.XpG();t.R7$(4),t.Y8G("ngClass",t.eq3(1,st,a.isFinished))}}function lt(e,s){if(1&e){const a=t.RV6();t.j41(0,"ion-item")(1,"ion-label",6),t.EFF(2,"Motorista:"),t.k0s(),t.j41(3,"ion-input",7),t.mxI("ngModelChange",function(n){t.eBV(a);const r=t.XpG();return t.DH7(r.motoristaSelecionado.name,n)||(r.motoristaSelecionado.name=n),t.Njj(n)}),t.k0s(),t.j41(4,"ion-button",8),t.bIt("click",function(){t.eBV(a);const n=t.XpG();return t.Njj(n.removerMotorista())}),t.nrm(5,"ion-icon",9),t.k0s()()}if(2&e){const a=t.XpG();t.R7$(3),t.Y8G("readonly",!0),t.R50("ngModel",a.motoristaSelecionado.name)}}function mt(e,s){if(1&e){const a=t.RV6();t.j41(0,"ion-item",11),t.bIt("click",function(){const n=t.eBV(a).$implicit,r=t.XpG(3);return t.Njj(r.selecionarMotorista(n))}),t.EFF(1),t.k0s()}if(2&e){const a=s.$implicit;t.R7$(),t.SpI(" ",a.name," ")}}function pt(e,s){if(1&e&&(t.j41(0,"ion-list"),t.DNE(1,mt,2,1,"ion-item",14),t.k0s()),2&e){const a=t.XpG(2);t.R7$(),t.Y8G("ngForOf",a.motoristasFiltrados)}}function dt(e,s){1&e&&(t.j41(0,"ion-text"),t.EFF(1," Nenhum motorista encontrado. "),t.k0s())}function ut(e,s){if(1&e){const a=t.RV6();t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",10)(3,"ion-button",11),t.bIt("click",function(){t.eBV(a);const n=t.XpG();return t.Njj(n.isOpen=!1)}),t.EFF(4,"Voltar"),t.k0s()()()(),t.j41(5,"ion-content",12)(6,"ion-item")(7,"ion-searchbar",13),t.mxI("ngModelChange",function(n){t.eBV(a);const r=t.XpG();return t.DH7(r.funcionarioBusca,n)||(r.funcionarioBusca=n),t.Njj(n)}),t.bIt("ionInput",function(){t.eBV(a);const n=t.XpG();return t.Njj(n.buscarMotoristas())}),t.k0s()(),t.DNE(8,pt,2,1,"ion-list",1)(9,dt,2,0,"ion-text",1),t.k0s()}if(2&e){const a=t.XpG();t.R7$(7),t.R50("ngModel",a.funcionarioBusca),t.R7$(),t.Y8G("ngIf",a.motoristasFiltrados.length>0&&a.funcionarioBusca),t.R7$(),t.Y8G("ngIf",0===a.motoristasFiltrados.length&&a.funcionarioBusca)}}let _t=(()=>{var e;class s{constructor(o){this.funcionarioService=o,this.isOpen=!1,this.funcionarios=[],this.funcionarioBusca="",this.motoristasFiltrados=[],this.motoristaSelecionado=null,this.isFinished=!1,(0,F.a)({trashOutline:g.P1A})}ngOnInit(){var o=this;return(0,m.A)(function*(){yield o.carregarMotoristas()})()}carregarMotoristas(){var o=this;return(0,m.A)(function*(){const n=o.funcionarioService.getCachedFuncionarios();if(n&&0!==n.length)o.funcionarios=n;else{const r=yield(0,f._)(o.funcionarioService.getAll());o.funcionarios=r}})()}buscarMotoristas(){const o=this.funcionarioBusca.toLowerCase();this.motoristasFiltrados=this.funcionarios.filter(n=>{var r;return null===(r=n.name)||void 0===r?void 0:r.toLowerCase().includes(o)})}selecionarMotorista(o){this.motoristaSelecionado=o,this.control.setValue(o.id),this.isOpen=!1,this.funcionarioBusca="",this.motoristasFiltrados=[]}removerMotorista(){this.motoristaSelecionado=null,this.control.setValue(null)}ngOnChanges(o){var n=this;return(0,m.A)(function*(){if(o.control){const r=o.control.currentValue;r&&r.value&&(yield n.carregarMotoristaSelecionado(r.value))}})()}carregarMotoristaSelecionado(o){var n=this;return(0,m.A)(function*(){try{yield n.carregarMotoristas(),n.motoristaSelecionado=n.funcionarios.find(d=>d.id===o)}catch(r){console.error("Erro ao carregar motorista selecionado:",r)}})()}}return(e=s).\u0275fac=function(o){return new(o||e)(t.rXU(k.r))},e.\u0275cmp=t.VBU({type:e,selectors:[["app-frota-motorista"]],inputs:{control:"control",isFinished:"isFinished"},standalone:!0,features:[t.OA$,t.aNF],decls:5,vars:3,consts:[["class","ion-justify-content-center ion-align-items-center",4,"ngIf"],[4,"ngIf"],[3,"isOpen"],[1,"ion-justify-content-center","ion-align-items-center"],["slot","end","color","primary",3,"click","ngClass"],["name","add-circle"],["position","floating"],[3,"ngModelChange","readonly","ngModel"],["slot","end","color","danger",3,"click"],["name","trash-outline"],["slot","start"],[3,"click"],[1,"ion-padding"],["placeholder","Buscar Motorista",3,"ngModelChange","ionInput","ngModel"],[3,"click",4,"ngFor","ngForOf"]],template:function(o,n){1&o&&(t.j41(0,"ion-list"),t.DNE(1,ct,6,3,"ion-item",0)(2,lt,6,2,"ion-item",1),t.k0s(),t.j41(3,"ion-modal",2),t.DNE(4,ut,10,3,"ng-template"),t.k0s()),2&o&&(t.R7$(),t.Y8G("ngIf",!n.motoristaSelecionado),t.R7$(),t.Y8G("ngIf",n.motoristaSelecionado),t.R7$(),t.Y8G("isOpen",n.isOpen))},dependencies:[p.MD,p.YU,p.Sq,p.bT,i.bv,i.Jm,i.QW,i.W9,i.eU,i.iq,i.$w,i.uz,i.he,i.nf,i.S1,i.IO,i.ai,i.Sb,i.Gw,_.iI,c.YN,c.BC,c.vS]}),s})();var ht=l(9457),ft=l(2177);let Ft=(()=>{var e;class s{constructor(o){this.baseApiService=o,this.endpoint="api/IdentificacaoFuncionario"}getImage(o){var n=this;return(0,m.A)(function*(){const r=yield(0,b.s)(n.baseApiService.get(`${n.endpoint}/GetImageFunc/${o}`,void 0,"blob"));return r?URL.createObjectURL(r):null})()}}return(e=s).\u0275fac=function(o){return new(o||e)(t.KVO(G.v))},e.\u0275prov=t.jDH({token:e,factory:e.\u0275fac,providedIn:"root"}),s})();function gt(e,s){if(1&e){const a=t.RV6();t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),t.EFF(3,"Selecionar Data e Hora"),t.k0s(),t.j41(4,"ion-buttons",2)(5,"ion-button",18),t.bIt("click",function(){t.eBV(a);const n=t.XpG(2);return t.Njj(n.openModalDataTime=!1)}),t.EFF(6,"Voltar"),t.k0s()(),t.j41(7,"ion-buttons",4)(8,"ion-button",19),t.bIt("click",function(){t.eBV(a);const n=t.XpG(2);return t.Njj(n.openModalDataTime=!1)}),t.EFF(9,"Confirmar"),t.k0s()()()(),t.j41(10,"ion-content",20),t.nrm(11,"ion-datetime",21),t.k0s()}if(2&e){const a=t.XpG(2);t.R7$(8),t.Y8G("disabled",!a.saidaFrotaForm.controls.dataHoraRetorno.value)("strong",!0)}}function vt(e,s){if(1&e){const a=t.RV6();t.qex(0),t.nrm(1,"app-card",11),t.j41(2,"ion-grid",12)(3,"ion-row")(4,"ion-col")(5,"ion-item")(6,"ion-label",13),t.EFF(7,"Km Retorno"),t.k0s(),t.nrm(8,"ion-input",14),t.k0s(),t.j41(9,"ion-item")(10,"ion-label",13),t.EFF(11,"Data e hora de retorno"),t.k0s(),t.j41(12,"ion-input",15),t.bIt("click",function(){t.eBV(a);const n=t.XpG();return t.Njj(n.openModalDataTime=!0)}),t.k0s()(),t.nrm(13,"app-frota-acompanhantes",16),t.j41(14,"ion-modal",17),t.DNE(15,gt,12,2,"ng-template"),t.k0s()()()(),t.bVm()}if(2&e){const a=t.XpG();t.R7$(),t.Y8G("hideButtonActions",!0)("data",a.dataSharedCard),t.R7$(),t.Y8G("formGroup",a.saidaFrotaForm),t.R7$(10),t.Y8G("readonly",!0),t.R7$(),t.Y8G("tipoAcompanhanteRetorno",a.isClose)("saveAcompanhanteFrota",a.sendSaidaIdForAcompanhante)("idFrota",a.id),t.R7$(),t.Y8G("isOpen",a.openModalDataTime)("backdropDismiss",!1)}}function Ct(e,s){if(1&e&&(t.qex(0),t.nrm(1,"app-frota-veiculo",25),t.bVm()),2&e){const a=t.XpG(2);t.R7$(),t.Y8G("control",a.saidaFrotaForm.controls.imobilizadoCod)("withoutRoutesOpen",!1)}}function bt(e,s){if(1&e&&(t.qex(0),t.nrm(1,"app-frota-veiculo",22),t.bVm()),2&e){const a=t.XpG(2);t.R7$(),t.Y8G("control",a.saidaFrotaForm.controls.imobilizadoCod)}}function At(e,s){if(1&e&&(t.qex(0),t.j41(1,"ion-grid",12)(2,"ion-row")(3,"ion-col"),t.nrm(4,"app-frota-motorista",22),t.DNE(5,Ct,2,2,"ng-container",10)(6,bt,2,1,"ng-container",10),t.nrm(7,"app-frota-destino",22),t.j41(8,"ion-item")(9,"ion-label",13),t.EFF(10,"Km Sa\xedda"),t.k0s(),t.nrm(11,"ion-input",23),t.k0s(),t.nrm(12,"app-frota-motivo",22),t.j41(13,"ion-item")(14,"ion-label",13),t.EFF(15,"Observa\xe7\xf5es"),t.k0s(),t.nrm(16,"ion-textarea",24),t.k0s(),t.nrm(17,"app-frota-acompanhantes",16),t.k0s()()(),t.bVm()),2&e){const a=t.XpG();t.R7$(),t.Y8G("formGroup",a.saidaFrotaForm),t.R7$(3),t.Y8G("control",a.saidaFrotaForm.controls.funcCod),t.R7$(),t.Y8G("ngIf",a.id),t.R7$(),t.Y8G("ngIf",!a.id),t.R7$(),t.Y8G("control",a.saidaFrotaForm.controls.destinoSeq),t.R7$(5),t.Y8G("control",a.saidaFrotaForm.controls.motivoSeq),t.R7$(5),t.Y8G("tipoAcompanhanteRetorno",a.isClose)("saveAcompanhanteFrota",a.sendSaidaIdForAcompanhante)("idFrota",a.id)}}let St=(()=>{var e;class s{constructor(o,n,r,d,u,v,R,Rt){this.fb=o,this.frotaSaidaSrv=n,this.loaddingCtrl=r,this.alertCtrl=d,this.router=u,this.route=v,this.dataSharedCardSrv=R,this.identificacaoFuncSrv=Rt,this.id=null,this.sendSaidaIdForAcompanhante=null,this.isClose=!1,this.routeSubscription=null,this.appRoutes=it.S,this.dataSharedCard=null,this.openModalDataTime=!1,this.changeFuncCodSubscription=null,this.srcFotoMotorista="assets/user.png",this.saidaFrotaForm=this.fb.group({dataHoraSaida:[null,c.k0.required],imobilizadoCod:[null,c.k0.required],destinoSeq:[null,c.k0.required],quilometragemNaSaida:[null,[c.k0.required,c.k0.min(0)]],motivoSeq:[null,c.k0.required],funcCod:[null,c.k0.required],obs:[""]})}ngOnInit(){var o=this;this.updateRouteData(),this.changeFuncCodSubscription=this.saidaFrotaForm.controls.funcCod.valueChanges.subscribe(function(){var n=(0,m.A)(function*(r){const d=yield o.identificacaoFuncSrv.getImage(2739);r&&d&&(o.srcFotoMotorista=yield o.identificacaoFuncSrv.getImage(2739)),r||(o.srcFotoMotorista="assets/user.png")});return function(r){return n.apply(this,arguments)}}()),this.routeSubscription=this.router.events.pipe((0,at.p)(n=>n instanceof _.wF)).subscribe(()=>this.updateRouteData())}updateRouteData(){if(this.id=Number(this.route.snapshot.paramMap.get("id"))||null,this.isClose=this.route.snapshot.url.some(n=>"close"===n.path),this.dataSharedCard=this.dataSharedCardSrv.getData(),this.isClose){var o;const n=null===(o=this.dataSharedCard)||void 0===o?void 0:o.quilometragemNaSaida;this.saidaFrotaForm.addControl("quilometragemNoRetorno",new c.MJ(n,[c.k0.required,c.k0.min(null!=n?n:1)])),this.saidaFrotaForm.addControl("dataHoraRetorno",new c.MJ(new Date,c.k0.required))}this.id&&(this.dataSharedCard?this.saidaFrotaForm.patchValue(this.dataSharedCard):this.getDataForEditForm(this.id))}getDataForEditForm(o){this.frotaSaidaSrv.getById(o).subscribe(n=>{this.dataSharedCard=n,this.saidaFrotaForm.patchValue(n)})}onSubmit(){var o=this;return(0,m.A)(function*(){var n,r;o.id||o.isClose||null===(n=o.saidaFrotaForm.get("dataHoraSaida"))||void 0===n||n.setValue(new Date),o.saidaFrotaForm.valid?yield(0,y.h)(o.loaddingCtrl,o.alertCtrl,{mainAction:(r=(0,m.A)(function*(){const d=o.saidaFrotaForm.value;if(o.isClose||o.id){const u=yield(0,f._)(o.frotaSaidaSrv.update(o.id,d));o.sendSaidaIdForAcompanhante=null==u?void 0:u.id}else{const u=yield(0,f._)(o.frotaSaidaSrv.save(d));o.sendSaidaIdForAcompanhante=null==u?void 0:u.id}}),function(){return r.apply(this,arguments)}),onAfterTryDismiss:()=>o.router.navigate([o.appRoutes.list.path]),onError:r=>console.error("Erro ao salvar:",r)}):console.log("Formul\xe1rio inv\xe1lido")})()}msgCloseForm(){var o=this;return(0,m.A)(function*(){const n=yield o.alertCtrl.create({header:"Sair do cadastro de rota",message:"Voc\xea tem certeza que quer sair do cadastro de rota? Ao sair, suas modifica\xe7\xf5es ser\xe3o perdidas!",buttons:[{text:"Continuar nesta Tela",role:"cancel"},{text:"Sair",handler:()=>o.router.navigate(["/home"])}]});o.saidaFrotaForm.dirty?yield n.present():o.router.navigate(["/home"])})()}ngOnDestroy(){var o;null===(o=this.routeSubscription)||void 0===o||o.unsubscribe()}}return(e=s).\u0275fac=function(o){return new(o||e)(t.rXU(c.ok),t.rXU(ht.g),t.rXU(i.Xi),t.rXU(i.hG),t.rXU(_.Ix),t.rXU(_.nX),t.rXU(ft.w),t.rXU(Ft))},e.\u0275cmp=t.VBU({type:e,selectors:[["app-form"]],standalone:!0,features:[t.aNF],decls:19,vars:6,consts:[[3,"translucent"],["color","primary"],["slot","start"],["color","light",3,"click"],["slot","end"],[3,"fullscreen"],[1,"box-content"],[1,"ion-justify-content-center","ion-align-items-center"],["size","auto"],["alt","Foto de perfil",3,"src"],[4,"ngIf"],[3,"hideButtonActions","data"],[3,"formGroup"],["position","floating"],["type","number","formControlName","quilometragemNoRetorno"],["formControlName","dataHoraRetorno",3,"click","readonly"],[3,"tipoAcompanhanteRetorno","saveAcompanhanteFrota","idFrota"],[1,"modal-data-time",3,"isOpen","backdropDismiss"],[3,"click"],[3,"click","disabled","strong"],[1,"ion-padding"],["presentation","date-time","formControlName","dataHoraRetorno"],[3,"control"],["type","number","formControlName","quilometragemNaSaida"],["formControlName","obs"],[3,"control","withoutRoutesOpen"]],template:function(o,n){1&o&&(t.j41(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-buttons",2)(3,"ion-button",3),t.bIt("click",function(){return n.msgCloseForm()}),t.EFF(4,"Sair"),t.k0s()(),t.j41(5,"ion-title"),t.EFF(6),t.k0s(),t.j41(7,"ion-buttons",4)(8,"ion-button",3),t.bIt("click",function(){return n.onSubmit()}),t.EFF(9,"Salvar"),t.k0s()()()(),t.j41(10,"ion-content",5)(11,"div",6)(12,"ion-grid")(13,"ion-row",7)(14,"ion-col",8)(15,"ion-avatar"),t.nrm(16,"img",9),t.k0s()()()(),t.DNE(17,vt,16,9,"ng-container",10)(18,At,18,9,"ng-container",10),t.k0s()()),2&o&&(t.Y8G("translucent",!0),t.R7$(6),t.JRh(n.isClose?"Finalizar percurso":n.id?"Editar percurso":"Iniciar percurso"),t.R7$(4),t.Y8G("fullscreen",!0),t.R7$(6),t.Y8G("src",n.srcFotoMotorista,t.B4B),t.R7$(),t.Y8G("ngIf",n.isClose&&!!n.dataSharedCard),t.R7$(),t.Y8G("ngIf",!n.isClose))},dependencies:[p.MD,p.bT,i.bv,i.mC,i.Jm,i.QW,i.hU,i.W9,i.A9,i.lO,i.eU,i.$w,i.uz,i.he,i.ln,i.nc,i.BC,i.ai,i.Sb,i.su,i.Je,i.Gw,_.iI,c.X1,c.BC,c.cb,c.j4,c.JD,K,Z,ot,et,rt.i,_t,c.YN],styles:["[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .box-content[_ngcontent-%COMP%]{display:block;max-width:800px;margin:0 auto}[_nghost-%COMP%]   ion-avatar[_ngcontent-%COMP%]{height:200px;width:200px}[_nghost-%COMP%]   ion-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{object-fit:contain}"]}),s})()},3207:(B,C,l)=>{l.d(C,{s:()=>p});var m=l(9350);function p(c,_){const i="object"==typeof _;return new Promise((t,f)=>{let F,h=!1;c.subscribe({next:g=>{F=g,h=!0},error:f,complete:()=>{h?t(F):i?t(_.defaultValue):f(new m.G)}})})}}}]);